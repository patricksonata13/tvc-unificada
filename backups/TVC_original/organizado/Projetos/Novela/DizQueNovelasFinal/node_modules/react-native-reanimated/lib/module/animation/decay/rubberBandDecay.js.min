"use strict";import{SLOPE_FACTOR,VELOCITY_EPS}from"./utils";const DERIVATIVE_EPS=.1;export function rubberBandDecay(t,a,e){const{lastTimestamp:r,startTimestamp:c,current:i,velocity:s}=t,n=Math.min(a-r,64),l=Math.abs(i-e.clamp[0])<Math.abs(i-e.clamp[1])?0:1;let m=0;(i<e.clamp[0]||i>e.clamp[1])&&(m=i-e.clamp[l]);const p=s*Math.exp(-(1-e.deceleration)*(a-c)*SLOPE_FACTOR)-m*e.rubberBandFactor;if(Math.abs(m)>.1)t.springActive=!0;else{if(t.springActive)return t.current=e.clamp[l],!0;if(Math.abs(p)<VELOCITY_EPS)return!0}return t.current=i+p*e.velocityFactor*n/1e3,t.velocity=p,t.lastTimestamp=a,!1}