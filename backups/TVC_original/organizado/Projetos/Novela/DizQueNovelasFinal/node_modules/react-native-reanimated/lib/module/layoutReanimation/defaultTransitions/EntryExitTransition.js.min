"use strict";import{withSequence,withTiming}from"../../animation";import{logger}from"../../common";import{BaseAnimationBuilder}from"../animationBuilder";import{FadeIn,FadeOut}from"../defaultAnimations/Fade";export class EntryExitTransition extends BaseAnimationBuilder{static presetName="EntryExitTransition";enteringV=FadeIn;exitingV=FadeOut;static createInstance(){return new EntryExitTransition}static entering(i){return this.createInstance().entering(i)}entering(i){return this.enteringV=i,this}static exiting(i){return this.createInstance().exiting(i)}exiting(i){return this.exitingV=i,this}build=()=>{const i=this.getDelayFunction(),t=this.callbackV,n=this.getDelay(),r=this.enteringV.build(),a=this.exitingV.build(),e=this.exitingV.getDuration();return s=>{const o=r(s),m=a(s),u={transform:[]};for(const t of Object.keys(m.animations))if("transform"===t){if(!Array.isArray(m.animations.transform))continue;m.animations.transform.forEach((t,r)=>{for(const a of Object.keys(t))u.transform.push({[a]:i(n,withSequence(t[a],withTiming(m.initialValues.transform?m.initialValues.transform[r][a]:0,{duration:0})))})})}else{const r=void 0!==o.animations[t]?[m.animations[t],withTiming(o.initialValues[t],{duration:0}),o.animations[t]]:[m.animations[t],withTiming(Object.keys(s).includes(t)?s[t]:m.initialValues[t],{duration:0})];u[t]=i(n,withSequence(...r))}for(const t of Object.keys(o.animations))if("transform"===t){if(!Array.isArray(o.animations.transform))continue;o.animations.transform.forEach((t,r)=>{for(const a of Object.keys(t))u.transform.push({[a]:i(n+e,withSequence(withTiming(o.initialValues.transform?o.initialValues.transform[r][a]:0,{duration:e}),t[a]))})})}else{if(void 0!==u[t])continue;u[t]=i(n,withSequence(withTiming(o.initialValues[t],{duration:0}),o.animations[t]))}const c=(Array.isArray(m.initialValues.transform)?m.initialValues.transform:[]).concat((Array.isArray(o.animations.transform)?o.animations.transform:[]).map(i=>{const t=Object.keys(i);if(t?.length<1)return logger.error("${value} is not a valid Transform object"),i;const n=t[0],r=i[n].current;return"string"==typeof r?r.includes("deg")?{[n]:"0deg"}:{[n]:"0"}:n.includes("translate")?{[n]:0}:{[n]:1}}));return{initialValues:{...m.initialValues,originX:s.currentOriginX,originY:s.currentOriginY,width:s.currentWidth,height:s.currentHeight,transform:c},animations:{originX:i(n+e,withTiming(s.targetOriginX,{duration:e})),originY:i(n+e,withTiming(s.targetOriginY,{duration:e})),width:i(n+e,withTiming(s.targetWidth,{duration:e})),height:i(n+e,withTiming(s.targetHeight,{duration:e})),...u},callback:t}}}}