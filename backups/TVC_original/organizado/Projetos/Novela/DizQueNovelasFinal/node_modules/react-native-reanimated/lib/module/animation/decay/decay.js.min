"use strict";import{ReanimatedError}from"../../common";import{defineAnimation,getReduceMotionForAnimation}from"../util";import{rigidDecay}from"./rigidDecay";import{rubberBandDecay}from"./rubberBandDecay";import{isValidRubberBandConfig}from"./utils";function validateConfig(t){if(t.clamp){if(!Array.isArray(t.clamp))throw new ReanimatedError(`\`config.clamp\` must be an array but is ${typeof t.clamp}.`);if(2!==t.clamp.length)throw new ReanimatedError(`\`clamp array\` must contain 2 items but is given ${t.clamp.length}.`)}if(t.velocityFactor<=0)throw new ReanimatedError(`\`config.velocityFactor\` must be greater then 0 but is ${t.velocityFactor}.`);if(t.rubberBandEffect&&!t.clamp)throw new ReanimatedError("You need to set `clamp` property when using `rubberBandEffect`.")}export const withDecay=function(t,e){return defineAnimation(0,()=>{const r={deceleration:.998,velocityFactor:1,velocity:0,rubberBandFactor:.6};t&&Object.keys(t).forEach(e=>r[e]=t[e]);return{onFrame:isValidRubberBandConfig(r)?(t,e)=>rubberBandDecay(t,e,r):(t,e)=>rigidDecay(t,e,r),onStart:function(t,e,i){const a=r.velocity;t.current=e,t.lastTimestamp=i,t.startTimestamp=i,t.initialVelocity=a,t.velocity=a,validateConfig(r),t.reduceMotion&&r.clamp&&(e<r.clamp[0]?t.current=r.clamp[0]:e>r.clamp[1]&&(t.current=r.clamp[1]))},callback:e,velocity:r.velocity??0,initialVelocity:0,current:void 0,lastTimestamp:0,startTimestamp:0,reduceMotion:getReduceMotionForAnimation(r.reduceMotion)}})};