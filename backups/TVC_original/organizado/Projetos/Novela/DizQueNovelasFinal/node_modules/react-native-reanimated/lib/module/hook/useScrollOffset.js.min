"use strict";import{useCallback,useEffect,useRef}from"react";import{IS_WEB,logger}from"../common";import{useEvent}from"./useEvent";import{useSharedValue}from"./useSharedValue";const NOT_INITIALIZED_WARNING="animatedRef is not initialized in useScrollOffset. Make sure to pass the animated ref to the scrollable component to get scroll offset updates.",NATIVE_SCROLL_EVENT_NAMES=["onScroll","onScrollBeginDrag","onScrollEndDrag","onMomentumScrollBegin","onMomentumScrollEnd"];export const useScrollOffset=IS_WEB?useScrollOffsetWeb:useScrollOffsetNative;function useScrollOffsetWeb(e,t){const r=useSharedValue(0),o=useRef(t??r).current,l=useCallback(()=>{if(e?.current){const t=getWebScrollableElement(e.current);o.value=0===t.scrollLeft?t.scrollTop:t.scrollLeft}},[e,o]);return useEffect(()=>{if(e)return e.observe(t=>{if(!e.current||!t)return void logger.warn(NOT_INITIALIZED_WARNING);const r=getWebScrollableElement(e.current);return r.addEventListener("scroll",l),()=>{r.removeEventListener("scroll",l)}})},[e,l]),o}function useScrollOffsetNative(e,t){const r=useSharedValue(0),o=useRef(t??r).current,l=useEvent(e=>{o.value=0===e.contentOffset.x?e.contentOffset.y:e.contentOffset.x},NATIVE_SCROLL_EVENT_NAMES);return useEffect(()=>{if(e)return e.observe(e=>{if(e)return l.workletEventHandler.registerForEvents(e),()=>{l.workletEventHandler.unregisterFromEvents(e)};logger.warn(NOT_INITIALIZED_WARNING)})},[e,l]),o}function getWebScrollableElement(e){return e?.getScrollableNode?.()??e}