"use strict";import{SHOULD_BE_USE_WEB}from"./common";import{registerEventHandler,unregisterEventHandler}from"./core";function jsListener(e,t){return s=>{t({...s.nativeEvent,eventName:e})}}class WorkletEventHandlerNative{#e;#t;constructor(e,t){this.worklet=e,this.eventNames=t,this.#e=new Set,this.#t=new Map}updateEventHandler(e,t){this.worklet=e,this.eventNames=t,this.#t.forEach(e=>{e.forEach(e=>unregisterEventHandler(e))}),Array.from(this.#e).forEach(e=>{const t=this.eventNames.map(t=>registerEventHandler(this.worklet,t,e));this.#t.set(e,t)})}registerForEvents(e,t){this.#e.add(e);const s=this.eventNames.map(t=>registerEventHandler(this.worklet,t,e));if(this.#t.set(e,s),0===this.eventNames.length&&t){const s=registerEventHandler(this.worklet,t,e);this.#t.set(e,[s])}}unregisterFromEvents(e){this.#e.delete(e),this.#t.get(e)?.forEach(e=>{unregisterEventHandler(e)}),this.#t.delete(e)}}class WorkletEventHandlerWeb{constructor(e,t=[]){this.worklet=e,this.eventNames=t,this.listeners={},this.setupWebListeners()}setupWebListeners(){this.listeners={},this.eventNames.forEach(e=>{this.listeners[e]=jsListener(e,this.worklet)})}updateEventHandler(e,t){this.worklet=e,this.eventNames=t,this.setupWebListeners()}registerForEvents(e,t){}unregisterFromEvents(e){}}export const WorkletEventHandler=SHOULD_BE_USE_WEB?WorkletEventHandlerWeb:WorkletEventHandlerNative;