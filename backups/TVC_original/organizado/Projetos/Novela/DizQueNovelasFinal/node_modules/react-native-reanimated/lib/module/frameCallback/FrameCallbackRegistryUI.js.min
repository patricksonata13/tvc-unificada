"use strict";import{runOnUI}from"react-native-worklets";export const prepareUIRegistry=runOnUI(()=>{const a={frameCallbackRegistry:new Map,activeFrameCallbacks:new Set,previousFrameTimestamp:null,nextCallId:0,runCallbacks(a){const e=t=>{if(a!==this.nextCallId)return;null===this.previousFrameTimestamp&&(this.previousFrameTimestamp=t);const i=t-this.previousFrameTimestamp;this.activeFrameCallbacks.forEach(a=>{const e=this.frameCallbackRegistry.get(a),{startTime:s}=e;null===s?(e.startTime=t,e.callback({timestamp:t,timeSincePreviousFrame:null,timeSinceFirstFrame:0})):e.callback({timestamp:t,timeSincePreviousFrame:i,timeSinceFirstFrame:t-s})}),this.activeFrameCallbacks.size>0?(this.previousFrameTimestamp=t,requestAnimationFrame(e)):this.previousFrameTimestamp=null};1===this.activeFrameCallbacks.size&&a===this.nextCallId&&requestAnimationFrame(e)},registerFrameCallback(a,e){this.frameCallbackRegistry.set(e,{callback:a,startTime:null})},unregisterFrameCallback(a){this.manageStateFrameCallback(a,!1),this.frameCallbackRegistry.delete(a)},manageStateFrameCallback(a,e){if(-1!==a)if(e)this.activeFrameCallbacks.has(a)||(this.activeFrameCallbacks.add(a),this.runCallbacks(this.nextCallId));else{this.frameCallbackRegistry.get(a).startTime=null,this.activeFrameCallbacks.delete(a),0===this.activeFrameCallbacks.size&&(this.nextCallId+=1)}}};global._frameCallbackRegistry=a});