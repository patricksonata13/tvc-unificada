"use strict";import{initialUpdaterRun}from"../animation";import{isSharedValue}from"../isSharedValue";import{WorkletEventHandler}from"../WorkletEventHandler";import{getInlineStyle,hasInlineStyles}from"./InlinePropManager";import{flattenArray,has}from"./utils";function dummyListener(){}export class PropsFilter{_initialPropsMap=new Map;filterNonAnimatedProps(e){const t=e.props,r={};for(const n in t){const i=t[n];if("style"===n){const i=t.style,a=flattenArray(i??[]).map(t=>{if(t?.viewDescriptors){const r=t;return e._isFirstRender&&this._initialPropsMap.set(r,{...r.initial.value,...initialUpdaterRun(r.initial.updater)}),this._initialPropsMap.get(r)??{}}return hasInlineStyles(t)?getInlineStyle(t,e._isFirstRender):t});r[n]=a}else if("animatedProps"===n){const e=t.animatedProps;flattenArray(e??[]).forEach(e=>{e?.viewDescriptors&&e.initial&&Object.keys(e.initial.value).forEach(t=>{r[t]=e.initial?.value[t]})})}else has("workletEventHandler",i)&&i.workletEventHandler instanceof WorkletEventHandler?i.workletEventHandler.eventNames.length>0?i.workletEventHandler.eventNames.forEach(e=>{r[e]=has("listeners",i.workletEventHandler)?i.workletEventHandler.listeners[e]:dummyListener}):r[n]=dummyListener:isSharedValue(i)?e._isFirstRender&&(r[n]=i.value):r[n]=i}return r}}