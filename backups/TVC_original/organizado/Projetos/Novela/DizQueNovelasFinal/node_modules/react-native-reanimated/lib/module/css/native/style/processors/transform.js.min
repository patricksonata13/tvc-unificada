"use strict";import{ReanimatedError}from"../../../../common";import{isAngle,isNumber,isNumberArray,isPercentage}from"../../../utils";export const ERROR_MESSAGES={invalidTransform:e=>`Invalid transform property: ${e}`};const parseTransformProperty=e=>{const[r,t]=e.split(/\(\s*/),a=parseValues(t.replace(/\)$/g,""));switch(r){case"translate":return parseTranslate(a);case"translateX":return parseTranslateX(a);case"translateY":return parseTranslateY(a);case"scale":return parseScale(a);case"scaleX":return parseScaleX(a);case"scaleY":return parseScaleY(a);case"rotate":case"rotateX":case"rotateY":case"rotateZ":return parseRotate(r,a);case"skew":return parseSkew(a);case"skewX":return parseSkewX(a);case"skewY":return parseSkewY(a);case"matrix":return parseMatrix(a);default:return[]}};function parseValues(e){return e.split(",").map(e=>{const r=e.trim();if(["deg","rad","%"].some(e=>r.endsWith(e)))return r;const t=parseFloat(r);return isNaN(t)?r:t})}function parseTranslate(e){if(e.length>2)return[];const r=parseTranslateX([e[0]]).concat(parseTranslateY([e[1]??e[0]]));return 2===r.length?r:[]}function parseTranslateX(e){return 1===e.length&&(isNumber(e[0])||isPercentage(e[0]))?[{translateX:e[0]}]:[]}function parseTranslateY(e){return 1===e.length&&(isNumber(e[0])||isPercentage(e[0]))?[{translateY:e[0]}]:[]}function parseScale(e){if(e.length>2)return[];if(1===e.length)return isNumber(e[0])?[{scale:e[0]}]:[];const r=parseScaleX([e[0]]).concat(parseScaleY([e[1]??e[0]]));return 2===r.length?r:[]}function parseScaleX(e){return 1===e.length&&isNumber(e[0])?[{scaleX:e[0]}]:[]}function parseScaleY(e){return 1===e.length&&isNumber(e[0])?[{scaleY:e[0]}]:[]}function parseRotate(e,r){return 1!==r.length||!isAngle(r[0])&&0!==r[0]?[]:[{[e]:0===r[0]?"0deg":r[0]}]}function parseSkew(e){if(e.length>2)return[];const r=parseSkewX([e[0]]).concat(parseSkewY([e[1]??e[0]]));return 2===r.length?r:[]}function parseSkewX(e){return 1!==e.length||!isAngle(e[0])&&0!==e[0]?[]:[{skewX:0===e[0]?"0deg":e[0]}]}function parseSkewY(e){return 1!==e.length||!isAngle(e[0])&&0!==e[0]?[]:[{skewY:0===e[0]?"0deg":e[0]}]}function parseMatrix(e){let r=[];return isNumberArray(e)&&(6===e.length?r=[e[0],e[1],0,0,e[2],e[3],0,0,0,0,1,0,e[4],e[5],0,1]:16===e.length&&(r=e)),r.length>0?[{matrix:r}]:[]}export const processTransform=e=>"string"!=typeof e?e:e.split(/\)\s*/).filter(Boolean).flatMap(e=>{const r=parseTransformProperty(e);if(0===r.length)throw new ReanimatedError(ERROR_MESSAGES.invalidTransform(`${e})`));return r});