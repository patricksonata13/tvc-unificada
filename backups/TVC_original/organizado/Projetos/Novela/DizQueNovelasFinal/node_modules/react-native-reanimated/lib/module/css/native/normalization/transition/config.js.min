"use strict";import{ReanimatedError}from"../../../../common";import{areArraysEqual,convertPropertyToArray,deepEqual}from"../../../utils";import{normalizeDelay,normalizeDuration,normalizeTimingFunction}from"../common";import{normalizeTransitionBehavior}from"./settings";import{createEmptyTransitionConfig,parseTransitionShorthand}from"./shorthand";export const ERROR_MESSAGES={invalidTransitionProperty:t=>`Invalid transition property "${JSON.stringify(t)}"`};function getExpandedConfigProperties(t){const r=t.transition?parseTransitionShorthand(t.transition):createEmptyTransitionConfig();for(const[n,e]of Object.entries(t))r[n]=convertPropertyToArray(e);return r}const hasTransition=({transitionProperty:t,...r})=>{if(t.length){const r="none"===t[0];if(t.some(t=>"none"===t!==r))throw new ReanimatedError(ERROR_MESSAGES.invalidTransitionProperty(t));return!r}return Object.values(r).some(t=>t.length)};export function normalizeCSSTransitionProperties(t){const r=getExpandedConfigProperties(t);if(!hasTransition(r))return null;const{transitionProperty:n,transitionDuration:e,transitionTimingFunction:i,transitionDelay:o,transitionBehavior:s}=r,a=[];let p=!1;const l={};n.length||n.push("all");for(let t=n.length-1;t>=0;t--){const r=n[t];if(!l?.[r]&&("all"===r?p=!0:a.push(r),l[r]={duration:normalizeDuration(e[t%e.length]),timingFunction:normalizeTimingFunction(i[t%i.length]),delay:normalizeDelay(o[t%o.length]),allowDiscrete:normalizeTransitionBehavior(s[t%s.length])},p))break}return{properties:p?"all":a.reverse(),settings:l}}export function getNormalizedCSSTransitionConfigUpdates(t,r){const n={};t.properties===r.properties||Array.isArray(t.properties)&&Array.isArray(r.properties)&&areArraysEqual(t.properties,r.properties)||(n.properties=r.properties);const e=Object.keys(r.settings),i=Object.keys(t.settings);if(e.length!==i.length)n.settings=r.settings;else for(const i of e)if(!t.settings[i]||!deepEqual(t.settings[i],r.settings[i])){n.settings=r.settings;break}return n}