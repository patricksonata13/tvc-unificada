"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.loadConfigAsync=void 0;const promises_1=__importDefault(require("fs/promises")),path_1=__importDefault(require("path")),require_from_string_1=__importDefault(require("require-from-string")),resolve_from_1=__importDefault(require("resolve-from")),utils_1=require("../utils");let tsMain;const mockedNativeModules=path_1.default.join(__dirname,"..","..","node_modules_mock");function requireConfig(e,t){try{const i=(0,require_from_string_1.default)(t,e,{prependPaths:[mockedNativeModules]});return i.default??i??null}catch{return null}}exports.loadConfigAsync=(0,utils_1.memoize)(async function(e){const[t,i]=await Promise.all(["react-native.config.js","react-native.config.ts"].map(async t=>{const i=path_1.default.join(e,t);return await(0,utils_1.fileExistsAsync)(i)?i:null}));if(t)return requireConfig(t,await promises_1.default.readFile(t,"utf8"));if(i){if(void 0===tsMain){const t=resolve_from_1.default.silent(e,"typescript");t&&(tsMain=require(t))}else if(null==tsMain)return null;const t=await promises_1.default.readFile(i,"utf8"),r=tsMain?.transpileModule(t,{compilerOptions:{module:tsMain.ModuleKind.NodeNext,moduleResolution:tsMain.ModuleResolutionKind.NodeNext,target:tsMain.ScriptTarget.ESNext}}),o=r?.outputText;if(o)return requireConfig(i,o)}return null});