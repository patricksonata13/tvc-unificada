"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.resolveCommand=resolveCommand;const autolinkingOptions_1=require("./autolinkingOptions"),findModules_1=require("../autolinking/findModules"),getConfiguration_1=require("../autolinking/getConfiguration"),resolveModules_1=require("../autolinking/resolveModules");function hasCoreFeatures(e){return void 0!==e.coreFeatures}function resolveCommand(e){return(0,autolinkingOptions_1.registerAutolinkingArguments)(e.command("resolve [searchPaths...]")).option("-j, --json","Output results in the plain JSON format.",()=>!0,!1).action(async(e,o)=>{const n=o.platform??"apple",t=(0,autolinkingOptions_1.createAutolinkingOptionsLoader)({...o,searchPaths:e}),i=await t.getPlatformOptions(n),r=await t.getAppRoot(),s=await(0,findModules_1.findModulesAsync)({autolinkingOptions:i,appRoot:r}),a=await(0,resolveModules_1.resolveModulesAsync)(s,i),u=await(0,resolveModules_1.resolveExtraBuildDependenciesAsync)({commandRoot:t.getCommandRoot(),platform:n}),l=(0,getConfiguration_1.getConfiguration)({autolinkingOptions:i}),d=[...a.reduce((e,o)=>{if(hasCoreFeatures(o)){const n=o.coreFeatures??[];for(const o of n)e.add(o);return e}return e},new Set)];o.json?console.log(JSON.stringify({extraDependencies:u,coreFeatures:d,modules:a,...l?{configuration:l}:{}})):console.log(require("util").inspect({extraDependencies:u,coreFeatures:d,modules:a,...l?{configuration:l}:{}},!1,null,!0))})}