"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.generateModulesProviderCommand=generateModulesProviderCommand;const autolinkingOptions_1=require("./autolinkingOptions"),findModules_1=require("../autolinking/findModules"),generatePackageList_1=require("../autolinking/generatePackageList"),resolveModules_1=require("../autolinking/resolveModules");function generateModulesProviderCommand(e){return(0,autolinkingOptions_1.registerAutolinkingArguments)(e.command("generate-modules-provider [searchPaths...]")).option("-t, --target <path>","Path to the target file, where the package list should be written to.").option("--entitlement <path>","Path to the Apple code signing entitlements file.").option("-p, --packages <packages...>","Names of the packages to include in the generated modules provider.").option("--app-root <path>","Path to the app root directory.").action(async(e,t)=>{const o=t.platform??"apple",a=(0,autolinkingOptions_1.createAutolinkingOptionsLoader)({...t,searchPaths:e}),n=await a.getPlatformOptions(o),i=await(0,findModules_1.findModulesAsync)({autolinkingOptions:await a.getPlatformOptions(o),appRoot:t.appRoot??await a.getAppRoot()}),r=await(0,resolveModules_1.resolveModulesAsync)(i,n),s=new Set(t.packages??[]),l=r.filter(e=>s.has(e.packageName));await(0,generatePackageList_1.generateModulesProviderAsync)(l,{platform:o,targetPath:t.target,entitlementPath:t.entitlement??null})})}