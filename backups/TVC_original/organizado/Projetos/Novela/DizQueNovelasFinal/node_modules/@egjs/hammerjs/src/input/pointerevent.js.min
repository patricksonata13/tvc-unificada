import{INPUT_START,INPUT_END,INPUT_CANCEL,INPUT_MOVE,INPUT_TYPE_TOUCH,INPUT_TYPE_MOUSE,INPUT_TYPE_PEN,INPUT_TYPE_KINECT}from"../inputjs/input-consts";import{window}from"../browser";import Input from"../inputjs/input-constructor";import inArray from"../utils/in-array";const POINTER_INPUT_MAP={pointerdown:INPUT_START,pointermove:INPUT_MOVE,pointerup:INPUT_END,pointercancel:INPUT_CANCEL,pointerout:INPUT_CANCEL},IE10_POINTER_TYPE_ENUM={2:INPUT_TYPE_TOUCH,3:INPUT_TYPE_PEN,4:INPUT_TYPE_MOUSE,5:INPUT_TYPE_KINECT};let POINTER_ELEMENT_EVENTS="pointerdown",POINTER_WINDOW_EVENTS="pointermove pointerup pointercancel";window.MSPointerEvent&&!window.PointerEvent&&(POINTER_ELEMENT_EVENTS="MSPointerDown",POINTER_WINDOW_EVENTS="MSPointerMove MSPointerUp MSPointerCancel");export default class PointerEventInput extends Input{constructor(){var t=PointerEventInput.prototype;t.evEl=POINTER_ELEMENT_EVENTS,t.evWin=POINTER_WINDOW_EVENTS,super(...arguments),this.store=this.manager.session.pointerEvents=[]}handler(t){let{store:E}=this,T=!1,e=t.type.toLowerCase().replace("ms",""),n=POINTER_INPUT_MAP[e],o=IE10_POINTER_TYPE_ENUM[t.pointerType]||t.pointerType,N=o===INPUT_TYPE_TOUCH,r=inArray(E,t.pointerId,"pointerId");n&INPUT_START&&(0===t.button||N)?r<0&&(E.push(t),r=E.length-1):n&(INPUT_END|INPUT_CANCEL)&&(T=!0),r<0||(E[r]=t,this.callback(this.manager,n,{pointers:E,changedPointers:[t],pointerType:o,srcEvent:t}),T&&E.splice(r,1))}}