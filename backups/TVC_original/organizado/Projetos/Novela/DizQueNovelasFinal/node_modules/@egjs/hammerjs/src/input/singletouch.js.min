import{INPUT_START,INPUT_MOVE,INPUT_END,INPUT_CANCEL,INPUT_TYPE_TOUCH}from"../inputjs/input-consts";import Input from"../inputjs/input-constructor";import toArray from"../utils/to-array";import uniqueArray from"../utils/unique-array";const SINGLE_TOUCH_INPUT_MAP={touchstart:INPUT_START,touchmove:INPUT_MOVE,touchend:INPUT_END,touchcancel:INPUT_CANCEL},SINGLE_TOUCH_TARGET_EVENTS="touchstart",SINGLE_TOUCH_WINDOW_EVENTS="touchstart touchmove touchend touchcancel";export default class SingleTouchInput extends Input{constructor(){var t=SingleTouchInput.prototype;t.evTarget="touchstart",t.evWin=SINGLE_TOUCH_WINDOW_EVENTS,super(...arguments),this.started=!1}handler(t){let r=SINGLE_TOUCH_INPUT_MAP[t.type];if(r===INPUT_START&&(this.started=!0),!this.started)return;let e=normalizeSingleTouches.call(this,t,r);r&(INPUT_END|INPUT_CANCEL)&&e[0].length-e[1].length===0&&(this.started=!1),this.callback(this.manager,r,{pointers:e[0],changedPointers:e[1],pointerType:INPUT_TYPE_TOUCH,srcEvent:t})}}function normalizeSingleTouches(t,r){let e=toArray(t.touches),o=toArray(t.changedTouches);return r&(INPUT_END|INPUT_CANCEL)&&(e=uniqueArray(e.concat(o),"identifier",!0)),[e,o]}