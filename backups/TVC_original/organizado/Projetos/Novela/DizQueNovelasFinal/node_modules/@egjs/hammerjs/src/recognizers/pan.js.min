import AttrRecognizer from"./attribute";import{DIRECTION_ALL,DIRECTION_HORIZONTAL,DIRECTION_VERTICAL,DIRECTION_NONE,DIRECTION_UP,DIRECTION_DOWN,DIRECTION_LEFT,DIRECTION_RIGHT}from"../inputjs/input-consts";import{STATE_BEGAN}from"../recognizerjs/recognizer-consts";import{TOUCH_ACTION_PAN_X,TOUCH_ACTION_PAN_Y}from"../touchactionjs/touchaction-Consts";import directionStr from"../recognizerjs/direction-str";export default class PanRecognizer extends AttrRecognizer{constructor(t={}){super({event:"pan",threshold:10,pointers:1,direction:DIRECTION_ALL,...t}),this.pX=null,this.pY=null}getTouchAction(){let{options:{direction:t}}=this,i=[];return t&DIRECTION_HORIZONTAL&&i.push(TOUCH_ACTION_PAN_Y),t&DIRECTION_VERTICAL&&i.push(TOUCH_ACTION_PAN_X),i}directionTest(t){let{options:i}=this,e=!0,{distance:r}=t,{direction:o}=t,s=t.deltaX,I=t.deltaY;return o&i.direction||(i.direction&DIRECTION_HORIZONTAL?(o=0===s?DIRECTION_NONE:s<0?DIRECTION_LEFT:DIRECTION_RIGHT,e=s!==this.pX,r=Math.abs(t.deltaX)):(o=0===I?DIRECTION_NONE:I<0?DIRECTION_UP:DIRECTION_DOWN,e=I!==this.pY,r=Math.abs(t.deltaY))),t.direction=o,e&&r>i.threshold&&o&i.direction}attrTest(t){return AttrRecognizer.prototype.attrTest.call(this,t)&&(this.state&STATE_BEGAN||!(this.state&STATE_BEGAN)&&this.directionTest(t))}emit(t){this.pX=t.deltaX,this.pY=t.deltaY;let i=directionStr(t.direction);i&&(t.additionalEvent=this.options.event+i),super.emit(t)}}