var el,hammer,events,allGestureEvents=["tap doubletap press","pinch pinchin pinchout pinchstart pinchmove pinchend pinchcancel","rotate rotatestart rotatemove rotateend rotatecancel","pan panstart panmove panup pandown panleft panright panend pancancel","swipe swipeleft swiperight swipeup swipedown"].join(" ");QUnit.module("Gesture recognition",{beforeEach:function(){el=utils.createHitArea(),(hammer=new Hammer(el)).get("pinch").set({enable:!0,threshold:.1}),hammer.get("rotate").set({enable:!0}),hammer.on(allGestureEvents,function(e){events[e.type]=!0}),events={}},afterEach:function(){hammer&&hammer.destroy(),events=null}}),QUnit.test("recognize pan",function(e){var t=e.async();e.expect(1),Simulator.gestures.pan(el,{duration:500,deltaX:100,deltaY:0},function(){e.deepEqual(events,{pan:!0,panstart:!0,panmove:!0,panright:!0,panend:!0},"Pan events recognized"),t()})}),QUnit.test("recognize press",function(e){var t=e.async();e.expect(1),Simulator.gestures.press(el,null,function(){e.deepEqual(events,{press:!0}),t()},"only press was recognized")}),QUnit.test("recognize swipe",function(e){var t=e.async();e.expect(1),Simulator.gestures.swipe(el,{duration:300,deltaX:400,deltaY:0},function(){e.deepEqual(events,{pan:!0,panstart:!0,panmove:!0,panright:!0,panend:!0,swipe:!0,swiperight:!0},"pan and swipe events were recognized"),t()})}),QUnit.test("recognize pinch",function(e){var t=e.async();e.expect(1),Simulator.gestures.pinch(el,{duration:500,scale:.5},function(){e.deepEqual(events,{pinch:!0,pinchstart:!0,pinchmove:!0,pinchend:!0,pinchin:!0},"pinch events were recognized"),t()})}),QUnit.test("recognize children multitouch pinch",function(e){var t=e.async();e.expect(1);var n=utils.createHitArea(el),a=utils.createHitArea(el);Simulator.gestures.pinch([n,a],{duration:500,scale:.5},function(){e.deepEqual(events,{pinch:!0,pinchstart:!0,pinchmove:!0,pinchend:!0,pinchin:!0},"pinch events on child were recognized"),t()})}),QUnit.test("recognize parent-child multitouch pinch",function(e){var t=e.async();e.expect(1);var n=utils.createHitArea(el);Simulator.gestures.pinch([el,n],{duration:100,scale:.5},function(){e.deepEqual(events,{pinch:!0,pinchstart:!0,pinchmove:!0,pinchend:!0,pinchin:!0},"Pinch events on parent were recognized"),t()})}),QUnit.test("recognize rotate",function(e){var t=e.async();e.expect(1),Simulator.gestures.rotate(el,{duration:500,scale:1},function(){e.deepEqual(events,{rotate:!0,rotatestart:!0,rotatemove:!0,rotateend:!0},"Rotate events recognized"),t()})}),QUnit.test("recognize multitouch rotate",function(e){var t=e.async();e.expect(1);var n=utils.createHitArea(el);Simulator.gestures.rotate([el,n],{duration:500,scale:1},function(){e.deepEqual(events,{rotate:!0,rotatestart:!0,rotatemove:!0,rotateend:!0},"Rotate events were recognized"),t()})}),QUnit.test("recognize rotate and pinch simultaneous",function(e){var t=e.async();e.expect(1),Simulator.gestures.pinchRotate(el,{duration:500,scale:2},function(){e.deepEqual(events,{rotate:!0,rotatestart:!0,rotatemove:!0,rotateend:!0,pinch:!0,pinchstart:!0,pinchmove:!0,pinchend:!0,pinchout:!0},"Rotate and pinch were recognized together"),t()})}),QUnit.test("don't recognize pan and swipe when moving down, when only horizontal is allowed",function(e){var t=e.async();e.expect(1),Simulator.gestures.swipe(el,{duration:250,deltaX:0,deltaZ:200},function(){e.deepEqual(events,{},"No events were recognized"),t()})}),QUnit.test("don't recognize press if duration is too short.",function(e){var t=e.async();e.expect(1),Simulator.gestures.press(el,{duration:240}),setTimeout(function(){e.deepEqual(events,{tap:!0},"Tap gesture has been recognized."),t()},275)}),QUnit.test("don't recognize tap if duration is too long.",function(e){var t=e.async();e.expect(1),Simulator.gestures.tap(el,{duration:255}),setTimeout(function(){e.deepEqual(events,{press:!0},"Press gesture has been recognized."),t()},275)});