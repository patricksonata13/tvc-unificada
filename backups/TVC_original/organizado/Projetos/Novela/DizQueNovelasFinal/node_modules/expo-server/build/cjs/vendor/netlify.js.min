"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ExpoError=void 0,exports.createRequestHandler=createRequestHandler;const abstract_1=require("./abstract"),runtime_1=require("../runtime"),node_1=require("./environment/node");var abstract_2=require("./abstract");Object.defineProperty(exports,"ExpoError",{enumerable:!0,get:function(){return abstract_2.ExpoError}});const scopeSymbol=Symbol.for("expoServerScope");function getContext(){const e=globalThis;if(!e.Netlify)throw new Error('"globalThis.Netlify" is missing but expected.\n- Are you using Netlify Server Functions 1.0 instead of 2.0?\n- Make sure your Netlify function has a default export instead of exporting "handler".');return e.Netlify?.context??{}}const STORE={getStore:()=>getContext()[scopeSymbol],run:(e,t,...r)=>(getContext()[scopeSymbol]=e,t(...r))};function createRequestHandler(e){const t=(0,runtime_1.createRequestScope)(STORE,(e,t)=>({origin:(t??getContext()).site?.url||e.headers.get("Origin")||"null",environment:(t??getContext()).deploy?.context||null,waitUntil:(t??getContext()).waitUntil})),r=(0,abstract_1.createRequestHandler)((0,node_1.createNodeEnv)(e));return async(e,n)=>{if("multiValueHeaders"in e)throw new Error('Unexpected Request object. API was called by Netlify Server Functions 1.0\n- Make sure your Netlify function has a default export instead of exporting "handler".');return await t(r,e,n)}}