function makeArray(e){return Array.isArray(e)?e:[e]}const EMPTY="",SPACE=" ",ESCAPE="\\",REGEX_TEST_BLANK_LINE=/^\s+$/,REGEX_INVALID_TRAILING_BACKSLASH=/(?:[^\\]|^)\\$/,REGEX_REPLACE_LEADING_EXCAPED_EXCLAMATION=/^\\!/,REGEX_REPLACE_LEADING_EXCAPED_HASH=/^\\#/,REGEX_SPLITALL_CRLF=/\r?\n/g,REGEX_TEST_INVALID_PATH=/^\.*\/|^\.+$/,SLASH="/";let TMP_KEY_IGNORE="node-ignore";"undefined"!=typeof Symbol&&(TMP_KEY_IGNORE=Symbol.for("node-ignore"));const KEY_IGNORE=TMP_KEY_IGNORE,define=(e,t,r)=>Object.defineProperty(e,t,{value:r}),REGEX_REGEXP_RANGE=/([0-z])-([0-z])/g,RETURN_FALSE=()=>!1,sanitizeRange=e=>e.replace(REGEX_REGEXP_RANGE,(e,t,r)=>t.charCodeAt(0)<=r.charCodeAt(0)?e:""),cleanRangeBackSlash=e=>{const{length:t}=e;return e.slice(0,t-t%2)},REPLACERS=[[/^\uFEFF/,()=>""],[/((?:\\\\)*?)(\\?\s+)$/,(e,t,r)=>t+(0===r.indexOf("\\")?" ":"")],[/(\\+?)\s/g,(e,t)=>{const{length:r}=t;return t.slice(0,r-r%2)+" "}],[/[\\$.|*+(){^]/g,e=>`\\${e}`],[/(?!\\)\?/g,()=>"[^/]"],[/^\//,()=>"^"],[/\//g,()=>"\\/"],[/^\^*\\\*\\\*\\\//,()=>"^(?:.*\\/)?"],[/^(?=[^^])/,function(){return/\/(?!$)/.test(this)?"^":"(?:^|\\/)"}],[/\\\/\\\*\\\*(?=\\\/|$)/g,(e,t,r)=>t+6<r.length?"(?:\\/[^\\/]+)*":"\\/.+"],[/(^|[^\\]+)(\\\*)+(?=.+)/g,(e,t,r)=>t+r.replace(/\\\*/g,"[^\\/]*")],[/\\\\\\(?=[$.|*+(){^])/g,()=>"\\"],[/\\\\/g,()=>"\\"],[/(\\)?\[([^\]/]*?)(\\*)($|\])/g,(e,t,r,i,s)=>"\\"===t?`\\[${r}${cleanRangeBackSlash(i)}${s}`:"]"===s&&i.length%2==0?`[${sanitizeRange(r)}${i}]`:"[]"],[/(?:[^*])$/,e=>/\/$/.test(e)?`${e}$`:`${e}(?=$|\\/$)`],[/(\^|\\\/)?\\\*$/,(e,t)=>`${t?`${t}[^/]+`:"[^/]*"}(?=$|\\/$)`]],regexCache=Object.create(null),makeRegex=(e,t)=>{let r=regexCache[e];return r||(r=REPLACERS.reduce((t,[r,i])=>t.replace(r,i.bind(e)),e),regexCache[e]=r),t?new RegExp(r,"i"):new RegExp(r)},isString=e=>"string"==typeof e,checkPattern=e=>e&&isString(e)&&!REGEX_TEST_BLANK_LINE.test(e)&&!REGEX_INVALID_TRAILING_BACKSLASH.test(e)&&0!==e.indexOf("#"),splitPattern=e=>e.split(REGEX_SPLITALL_CRLF);class IgnoreRule{constructor(e,t,r,i){this.origin=e,this.pattern=t,this.negative=r,this.regex=i}}const createRule=(e,t)=>{const r=e;let i=!1;0===e.indexOf("!")&&(i=!0,e=e.substr(1)),e=e.replace(REGEX_REPLACE_LEADING_EXCAPED_EXCLAMATION,"!").replace(REGEX_REPLACE_LEADING_EXCAPED_HASH,"#");const s=makeRegex(e,t);return new IgnoreRule(r,e,i,s)},throwError=(e,t)=>{throw new t(e)},checkPath=(e,t,r)=>{if(!isString(e))return r(`path must be a string, but got \`${t}\``,TypeError);if(!e)return r("path must not be empty",TypeError);if(checkPath.isNotRelative(e)){return r(`path should be a ${"`path.relative()`d"} string, but got "${t}"`,RangeError)}return!0},isNotRelative=e=>REGEX_TEST_INVALID_PATH.test(e);checkPath.isNotRelative=isNotRelative,checkPath.convert=e=>e;class Ignore{constructor({ignorecase:e=!0,ignoreCase:t=e,allowRelativePaths:r=!1}={}){define(this,KEY_IGNORE,!0),this._rules=[],this._ignoreCase=t,this._allowRelativePaths=r,this._initCache()}_initCache(){this._ignoreCache=Object.create(null),this._testCache=Object.create(null)}_addPattern(e){if(e&&e[KEY_IGNORE])return this._rules=this._rules.concat(e._rules),void(this._added=!0);if(checkPattern(e)){const t=createRule(e,this._ignoreCase);this._added=!0,this._rules.push(t)}}add(e){return this._added=!1,makeArray(isString(e)?splitPattern(e):e).forEach(this._addPattern,this),this._added&&this._initCache(),this}addPattern(e){return this.add(e)}_testOne(e,t){let r=!1,i=!1;return this._rules.forEach(s=>{const{negative:n}=s;if(i===n&&r!==i||n&&!r&&!i&&!t)return;s.regex.test(e)&&(r=!n,i=n)}),{ignored:r,unignored:i}}_test(e,t,r,i){const s=e&&checkPath.convert(e);return checkPath(s,e,this._allowRelativePaths?RETURN_FALSE:throwError),this._t(s,t,r,i)}_t(e,t,r,i){if(e in t)return t[e];if(i||(i=e.split("/")),i.pop(),!i.length)return t[e]=this._testOne(e,r);const s=this._t(i.join("/")+"/",t,r,i);return t[e]=s.ignored?s:this._testOne(e,r)}ignores(e){return this._test(e,this._ignoreCache,!1).ignored}createFilter(){return e=>!this.ignores(e)}filter(e){return makeArray(e).filter(this.createFilter())}test(e){return this._test(e,this._testCache,!0)}}const factory=e=>new Ignore(e),isPathValid=e=>checkPath(e&&checkPath.convert(e),e,RETURN_FALSE);if(factory.isPathValid=isPathValid,factory.default=factory,module.exports=factory,"undefined"!=typeof process&&(process.env&&process.env.IGNORE_TEST_WIN32||"win32"===process.platform)){const e=e=>/^\\\\\?\\/.test(e)||/["<>|\u0000-\u001F]+/u.test(e)?e:e.replace(/\\/g,"/");checkPath.convert=e;const t=/^[a-z]:\//i;checkPath.isNotRelative=e=>t.test(e)||isNotRelative(e)}