"use strict";const{EMPTY_BUFFER:EMPTY_BUFFER}=require("./constants");function concat(f,e){if(0===f.length)return EMPTY_BUFFER;if(1===f.length)return f[0];const r=Buffer.allocUnsafe(e);for(var t=0,n=0;n<f.length;n++){const e=f[n];e.copy(r,t),t+=e.length}return r}function _mask(f,e,r,t,n){for(var u=0;u<n;u++)r[t+u]=f[u]^e[3&u]}function _unmask(f,e){const r=f.length;for(var t=0;t<r;t++)f[t]^=e[3&t]}function toArrayBuffer(f){return f.byteLength===f.buffer.byteLength?f.buffer:f.buffer.slice(f.byteOffset,f.byteOffset+f.byteLength)}function toBuffer(f){return toBuffer.readOnly=!0,Buffer.isBuffer(f)?f:(f instanceof ArrayBuffer?e=Buffer.from(f):ArrayBuffer.isView(f)?e=viewToBuffer(f):(e=Buffer.from(f),toBuffer.readOnly=!1),e);var e}function viewToBuffer(f){const e=Buffer.from(f.buffer);return f.byteLength!==f.buffer.byteLength?e.slice(f.byteOffset,f.byteOffset+f.byteLength):e}try{const f=require("bufferutil"),e=f.BufferUtil||f;module.exports={concat:concat,mask(f,r,t,n,u){u<48?_mask(f,r,t,n,u):e.mask(f,r,t,n,u)},toArrayBuffer:toArrayBuffer,toBuffer:toBuffer,unmask(f,r){f.length<32?_unmask(f,r):e.unmask(f,r)}}}catch(f){module.exports={concat:concat,mask:_mask,toArrayBuffer:toArrayBuffer,toBuffer:toBuffer,unmask:_unmask}}