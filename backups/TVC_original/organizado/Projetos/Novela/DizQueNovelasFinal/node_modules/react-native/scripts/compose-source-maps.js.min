#!/usr/bin/env node
"use strict";const fs=require("fs"),{composeSourceMaps:composeSourceMaps}=require("metro-source-map"),argv=process.argv.slice(2);let outputPath;for(let e=0;e<argv.length;)"-o"!==argv[e]?++e:(outputPath=argv[e+1],argv.splice(e,2));if(argv.length){const[e,o]=argv.splice(0,2),s=JSON.parse(fs.readFileSync(e,"utf8")),t=JSON.parse(fs.readFileSync(o,"utf8"));if(null!=s.x_facebook_offsets||null!=t.x_facebook_offsets)throw new Error("Random Access Bundle (RAM) format is not supported by this tool; it cannot process the `x_facebook_offsets` field provided in the base and/or target source map(s)");if(null!=t.x_facebook_segments)throw new Error("This tool cannot process the `x_facebook_segments` field provided in the target source map.");const r=JSON.stringify(composeSourceMaps([s,t]));null!=outputPath?fs.writeFileSync(outputPath,r,"utf8"):process.stdout.write(r)}else process.stderr.write("Usage: node compose-source-maps.js <packager_sourcemap> <compiler_sourcemap> [-o output_file]\n"),process.exitCode=-1;