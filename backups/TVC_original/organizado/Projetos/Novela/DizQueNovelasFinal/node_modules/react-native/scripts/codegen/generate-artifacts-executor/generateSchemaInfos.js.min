"use strict";const CodegenUtils=require("../codegen-utils"),{codegenLog:codegenLog}=require("./utils"),fs=require("fs"),glob=require("glob"),path=require("path");function generateSchemaInfos(e){return e.map(generateSchemaInfo)}function generateSchemaInfo(e,o){const t=path.join(e.libraryPath,e.config.jsSrcsDir);codegenLog(`Processing ${e.config.name}`);return{library:e,supportedApplePlatforms:extractSupportedApplePlatforms(e.config.name,e.libraryPath),schema:CodegenUtils.getCombineJSToSchema().combineSchemasInFileList([t],o,/NativeSampleTurboModule/)}}const APPLE_PLATFORMS=["ios","macos","tvos","visionos"];function extractSupportedApplePlatforms(e,o){codegenLog("Searching for podspec in the project dependencies.",!0);const t=glob.sync("*.podspec",{cwd:o});if(0===t.length)return;const n=fs.readFileSync(path.join(o,t[0]),"utf8").split("\n").filter(e=>e.includes("platform")||e.includes("deployment_target")).join(""),r=APPLE_PLATFORMS.reduce((e,o)=>({...e,[o]:n.includes(getCocoaPodsPlatformKey(o))}),{}),c=Object.keys(r).filter(e=>r[e]);return c.length>0&&codegenLog(`Supported Apple platforms: ${c.join(", ")} for ${e}`),r}function getCocoaPodsPlatformKey(e){return"macos"===e?"osx":e}module.exports={generateSchemaInfos:generateSchemaInfos,generateSchemaInfo:generateSchemaInfo,extractSupportedApplePlatforms:extractSupportedApplePlatforms};