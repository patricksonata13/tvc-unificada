"use strict";const{isBlobLike:isBlobLike,iteratorMixin:iteratorMixin}=require("./util"),{kState:kState}=require("./symbols"),{kEnumerableProperty:kEnumerableProperty}=require("../../core/util"),{FileLike:FileLike,isFileLike:isFileLike}=require("./file"),{webidl:webidl}=require("./webidl"),{File:NativeFile}=require("node:buffer"),nodeUtil=require("node:util"),File=globalThis.File??NativeFile;class FormData{constructor(e){if(webidl.util.markAsUncloneable(this),void 0!==e)throw webidl.errors.conversionFailed({prefix:"FormData constructor",argument:"Argument 1",types:["undefined"]});this[kState]=[]}append(e,t,r=void 0){webidl.brandCheck(this,FormData);const i="FormData.append";if(webidl.argumentLengthCheck(arguments,2,i),3===arguments.length&&!isBlobLike(t))throw new TypeError("Failed to execute 'append' on 'FormData': parameter 2 is not of type 'Blob'");const a=makeEntry(e=webidl.converters.USVString(e,i,"name"),t=isBlobLike(t)?webidl.converters.Blob(t,i,"value",{strict:!1}):webidl.converters.USVString(t,i,"value"),r=3===arguments.length?webidl.converters.USVString(r,i,"filename"):void 0);this[kState].push(a)}delete(e){webidl.brandCheck(this,FormData);const t="FormData.delete";webidl.argumentLengthCheck(arguments,1,t),e=webidl.converters.USVString(e,t,"name"),this[kState]=this[kState].filter(t=>t.name!==e)}get(e){webidl.brandCheck(this,FormData);const t="FormData.get";webidl.argumentLengthCheck(arguments,1,t),e=webidl.converters.USVString(e,t,"name");const r=this[kState].findIndex(t=>t.name===e);return-1===r?null:this[kState][r].value}getAll(e){webidl.brandCheck(this,FormData);const t="FormData.getAll";return webidl.argumentLengthCheck(arguments,1,t),e=webidl.converters.USVString(e,t,"name"),this[kState].filter(t=>t.name===e).map(e=>e.value)}has(e){webidl.brandCheck(this,FormData);const t="FormData.has";return webidl.argumentLengthCheck(arguments,1,t),e=webidl.converters.USVString(e,t,"name"),-1!==this[kState].findIndex(t=>t.name===e)}set(e,t,r=void 0){webidl.brandCheck(this,FormData);const i="FormData.set";if(webidl.argumentLengthCheck(arguments,2,i),3===arguments.length&&!isBlobLike(t))throw new TypeError("Failed to execute 'set' on 'FormData': parameter 2 is not of type 'Blob'");e=webidl.converters.USVString(e,i,"name"),t=isBlobLike(t)?webidl.converters.Blob(t,i,"name",{strict:!1}):webidl.converters.USVString(t,i,"name"),r=3===arguments.length?webidl.converters.USVString(r,i,"name"):void 0;const a=makeEntry(e,t,r),n=this[kState].findIndex(t=>t.name===e);-1!==n?this[kState]=[...this[kState].slice(0,n),a,...this[kState].slice(n+1).filter(t=>t.name!==e)]:this[kState].push(a)}[nodeUtil.inspect.custom](e,t){const r=this[kState].reduce((e,t)=>(e[t.name]?Array.isArray(e[t.name])?e[t.name].push(t.value):e[t.name]=[e[t.name],t.value]:e[t.name]=t.value,e),{__proto__:null});t.depth??=e,t.colors??=!0;const i=nodeUtil.formatWithOptions(t,r);return`FormData ${i.slice(i.indexOf("]")+2)}`}}function makeEntry(e,t,r){if("string"==typeof t);else if(isFileLike(t)||(t=t instanceof Blob?new File([t],"blob",{type:t.type}):new FileLike(t,"blob",{type:t.type})),void 0!==r){const e={type:t.type,lastModified:t.lastModified};t=t instanceof NativeFile?new File([t],r,e):new FileLike(t,r,e)}return{name:e,value:t}}iteratorMixin("FormData",FormData,kState,"name","value"),Object.defineProperties(FormData.prototype,{append:kEnumerableProperty,delete:kEnumerableProperty,get:kEnumerableProperty,getAll:kEnumerableProperty,has:kEnumerableProperty,set:kEnumerableProperty,[Symbol.toStringTag]:{value:"FormData",configurable:!0}}),module.exports={FormData:FormData,makeEntry:makeEntry};