"use strict";const{kConnected:kConnected,kSize:kSize}=require("../../core/symbols");class CompatWeakRef{constructor(e){this.value=e}deref(){return 0===this.value[kConnected]&&0===this.value[kSize]?void 0:this.value}}class CompatFinalizer{constructor(e){this.finalizer=e}register(e,i){e.on&&e.on("disconnect",()=>{0===e[kConnected]&&0===e[kSize]&&this.finalizer(i)})}unregister(e){}}module.exports=function(){return process.env.NODE_V8_COVERAGE&&process.version.startsWith("v18")?(process._rawDebug("Using compatibility WeakRef and FinalizationRegistry"),{WeakRef:CompatWeakRef,FinalizationRegistry:CompatFinalizer}):{WeakRef:WeakRef,FinalizationRegistry:FinalizationRegistry}};