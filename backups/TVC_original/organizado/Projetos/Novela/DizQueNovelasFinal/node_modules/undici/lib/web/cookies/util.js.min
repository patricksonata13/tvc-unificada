"use strict";function isCTLExcludingHtab(e){for(let t=0;t<e.length;++t){const a=e.charCodeAt(t);if(a>=0&&a<=8||a>=10&&a<=31||127===a)return!0}return!1}function validateCookieName(e){for(let t=0;t<e.length;++t){const a=e.charCodeAt(t);if(a<33||a>126||34===a||40===a||41===a||60===a||62===a||64===a||44===a||59===a||58===a||92===a||47===a||91===a||93===a||63===a||61===a||123===a||125===a)throw new Error("Invalid cookie name")}}function validateCookieValue(e){let t=e.length,a=0;if('"'===e[0]){if(1===t||'"'!==e[t-1])throw new Error("Invalid cookie value");--t,++a}for(;a<t;){const t=e.charCodeAt(a++);if(t<33||t>126||34===t||44===t||59===t||92===t)throw new Error("Invalid cookie value")}}function validateCookiePath(e){for(let t=0;t<e.length;++t){const a=e.charCodeAt(t);if(a<32||127===a||59===a)throw new Error("Invalid cookie path")}}function validateCookieDomain(e){if(e.startsWith("-")||e.endsWith(".")||e.endsWith("-"))throw new Error("Invalid cookie domain")}const IMFDays=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],IMFMonths=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],IMFPaddedNumbers=Array(61).fill(0).map((e,t)=>t.toString().padStart(2,"0"));function toIMFDate(e){return"number"==typeof e&&(e=new Date(e)),`${IMFDays[e.getUTCDay()]}, ${IMFPaddedNumbers[e.getUTCDate()]} ${IMFMonths[e.getUTCMonth()]} ${e.getUTCFullYear()} ${IMFPaddedNumbers[e.getUTCHours()]}:${IMFPaddedNumbers[e.getUTCMinutes()]}:${IMFPaddedNumbers[e.getUTCSeconds()]} GMT`}function validateCookieMaxAge(e){if(e<0)throw new Error("Invalid cookie max-age")}function stringify(e){if(0===e.name.length)return null;validateCookieName(e.name),validateCookieValue(e.value);const t=[`${e.name}=${e.value}`];e.name.startsWith("__Secure-")&&(e.secure=!0),e.name.startsWith("__Host-")&&(e.secure=!0,e.domain=null,e.path="/"),e.secure&&t.push("Secure"),e.httpOnly&&t.push("HttpOnly"),"number"==typeof e.maxAge&&(validateCookieMaxAge(e.maxAge),t.push(`Max-Age=${e.maxAge}`)),e.domain&&(validateCookieDomain(e.domain),t.push(`Domain=${e.domain}`)),e.path&&(validateCookiePath(e.path),t.push(`Path=${e.path}`)),e.expires&&"Invalid Date"!==e.expires.toString()&&t.push(`Expires=${toIMFDate(e.expires)}`),e.sameSite&&t.push(`SameSite=${e.sameSite}`);for(const a of e.unparsed){if(!a.includes("="))throw new Error("Invalid unparsed");const[e,...o]=a.split("=");t.push(`${e.trim()}=${o.join("=")}`)}return t.join("; ")}module.exports={isCTLExcludingHtab:isCTLExcludingHtab,validateCookieName:validateCookieName,validateCookiePath:validateCookiePath,validateCookieValue:validateCookieValue,toIMFDate:toIMFDate,stringify:stringify};