"use strict";const Client=require("./lib/dispatcher/client"),Dispatcher=require("./lib/dispatcher/dispatcher"),Pool=require("./lib/dispatcher/pool"),BalancedPool=require("./lib/dispatcher/balanced-pool"),Agent=require("./lib/dispatcher/agent"),ProxyAgent=require("./lib/dispatcher/proxy-agent"),EnvHttpProxyAgent=require("./lib/dispatcher/env-http-proxy-agent"),RetryAgent=require("./lib/dispatcher/retry-agent"),errors=require("./lib/core/errors"),util=require("./lib/core/util"),{InvalidArgumentError:InvalidArgumentError}=errors,api=require("./lib/api"),buildConnector=require("./lib/core/connect"),MockClient=require("./lib/mock/mock-client"),MockAgent=require("./lib/mock/mock-agent"),MockPool=require("./lib/mock/mock-pool"),mockErrors=require("./lib/mock/mock-errors"),RetryHandler=require("./lib/handler/retry-handler"),{getGlobalDispatcher:getGlobalDispatcher,setGlobalDispatcher:setGlobalDispatcher}=require("./lib/global"),DecoratorHandler=require("./lib/handler/decorator-handler"),RedirectHandler=require("./lib/handler/redirect-handler"),createRedirectInterceptor=require("./lib/interceptor/redirect-interceptor");function makeDispatcher(e){return(r,t,o)=>{if("function"==typeof t&&(o=t,t=null),!r||"string"!=typeof r&&"object"!=typeof r&&!(r instanceof URL))throw new InvalidArgumentError("invalid url");if(null!=t&&"object"!=typeof t)throw new InvalidArgumentError("invalid opts");if(t&&null!=t.path){if("string"!=typeof t.path)throw new InvalidArgumentError("invalid opts.path");let e=t.path;t.path.startsWith("/")||(e=`/${e}`),r=new URL(util.parseOrigin(r).origin+e)}else t||(t="object"==typeof r?r:{}),r=util.parseURL(r);const{agent:i,dispatcher:l=getGlobalDispatcher()}=t;if(i)throw new InvalidArgumentError("unsupported opts.agent. Did you mean opts.client?");return e.call(l,{...t,origin:r.origin,path:r.search?`${r.pathname}${r.search}`:r.pathname,method:t.method||(t.body?"PUT":"GET")},o)}}Object.assign(Dispatcher.prototype,api),module.exports.Dispatcher=Dispatcher,module.exports.Client=Client,module.exports.Pool=Pool,module.exports.BalancedPool=BalancedPool,module.exports.Agent=Agent,module.exports.ProxyAgent=ProxyAgent,module.exports.EnvHttpProxyAgent=EnvHttpProxyAgent,module.exports.RetryAgent=RetryAgent,module.exports.RetryHandler=RetryHandler,module.exports.DecoratorHandler=DecoratorHandler,module.exports.RedirectHandler=RedirectHandler,module.exports.createRedirectInterceptor=createRedirectInterceptor,module.exports.interceptors={redirect:require("./lib/interceptor/redirect"),retry:require("./lib/interceptor/retry"),dump:require("./lib/interceptor/dump"),dns:require("./lib/interceptor/dns")},module.exports.buildConnector=buildConnector,module.exports.errors=errors,module.exports.util={parseHeaders:util.parseHeaders,headerNameToString:util.headerNameToString},module.exports.setGlobalDispatcher=setGlobalDispatcher,module.exports.getGlobalDispatcher=getGlobalDispatcher;const fetchImpl=require("./lib/web/fetch").fetch;module.exports.fetch=async function(e,r=void 0){try{return await fetchImpl(e,r)}catch(e){throw e&&"object"==typeof e&&Error.captureStackTrace(e),e}},module.exports.Headers=require("./lib/web/fetch/headers").Headers,module.exports.Response=require("./lib/web/fetch/response").Response,module.exports.Request=require("./lib/web/fetch/request").Request,module.exports.FormData=require("./lib/web/fetch/formdata").FormData,module.exports.File=globalThis.File??require("node:buffer").File,module.exports.FileReader=require("./lib/web/fileapi/filereader").FileReader;const{setGlobalOrigin:setGlobalOrigin,getGlobalOrigin:getGlobalOrigin}=require("./lib/web/fetch/global");module.exports.setGlobalOrigin=setGlobalOrigin,module.exports.getGlobalOrigin=getGlobalOrigin;const{CacheStorage:CacheStorage}=require("./lib/web/cache/cachestorage"),{kConstruct:kConstruct}=require("./lib/web/cache/symbols");module.exports.caches=new CacheStorage(kConstruct);const{deleteCookie:deleteCookie,getCookies:getCookies,getSetCookies:getSetCookies,setCookie:setCookie}=require("./lib/web/cookies");module.exports.deleteCookie=deleteCookie,module.exports.getCookies=getCookies,module.exports.getSetCookies=getSetCookies,module.exports.setCookie=setCookie;const{parseMIMEType:parseMIMEType,serializeAMimeType:serializeAMimeType}=require("./lib/web/fetch/data-url");module.exports.parseMIMEType=parseMIMEType,module.exports.serializeAMimeType=serializeAMimeType;const{CloseEvent:CloseEvent,ErrorEvent:ErrorEvent,MessageEvent:MessageEvent}=require("./lib/web/websocket/events");module.exports.WebSocket=require("./lib/web/websocket/websocket").WebSocket,module.exports.CloseEvent=CloseEvent,module.exports.ErrorEvent=ErrorEvent,module.exports.MessageEvent=MessageEvent,module.exports.request=makeDispatcher(api.request),module.exports.stream=makeDispatcher(api.stream),module.exports.pipeline=makeDispatcher(api.pipeline),module.exports.connect=makeDispatcher(api.connect),module.exports.upgrade=makeDispatcher(api.upgrade),module.exports.MockClient=MockClient,module.exports.MockPool=MockPool,module.exports.MockAgent=MockAgent,module.exports.mockErrors=mockErrors;const{EventSource:EventSource}=require("./lib/web/eventsource/eventsource");module.exports.EventSource=EventSource;