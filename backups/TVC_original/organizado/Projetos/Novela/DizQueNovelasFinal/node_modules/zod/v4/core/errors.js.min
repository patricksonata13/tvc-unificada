import{$constructor}from"./core.js";import*as util from"./util.js";const initializer=(e,r)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:r,enumerable:!1}),Object.defineProperty(e,"message",{get:()=>JSON.stringify(r,util.jsonStringifyReplacer,2),enumerable:!0}),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})};export const $ZodError=$constructor("$ZodError",initializer);export const $ZodRealError=$constructor("$ZodError",initializer,{Parent:Error});export function flattenError(e,r=e=>e.message){const s={},t=[];for(const o of e.issues)o.path.length>0?(s[o.path[0]]=s[o.path[0]]||[],s[o.path[0]].push(r(o))):t.push(r(o));return{formErrors:t,fieldErrors:s}}export function formatError(e,r){const s=r||function(e){return e.message},t={_errors:[]},o=e=>{for(const r of e.issues)if("invalid_union"===r.code&&r.errors.length)r.errors.map(e=>o({issues:e}));else if("invalid_key"===r.code)o({issues:r.issues});else if("invalid_element"===r.code)o({issues:r.issues});else if(0===r.path.length)t._errors.push(s(r));else{let e=t,o=0;for(;o<r.path.length;){const t=r.path[o];o===r.path.length-1?(e[t]=e[t]||{_errors:[]},e[t]._errors.push(s(r))):e[t]=e[t]||{_errors:[]},e=e[t],o++}}};return o(e),t}export function treeifyError(e,r){const s=r||function(e){return e.message},t={errors:[]},o=(e,r=[])=>{var n,i;for(const u of e.issues)if("invalid_union"===u.code&&u.errors.length)u.errors.map(e=>o({issues:e},u.path));else if("invalid_key"===u.code)o({issues:u.issues},u.path);else if("invalid_element"===u.code)o({issues:u.issues},u.path);else{const e=[...r,...u.path];if(0===e.length){t.errors.push(s(u));continue}let o=t,p=0;for(;p<e.length;){const r=e[p],t=p===e.length-1;"string"==typeof r?(o.properties??(o.properties={}),(n=o.properties)[r]??(n[r]={errors:[]}),o=o.properties[r]):(o.items??(o.items=[]),(i=o.items)[r]??(i[r]={errors:[]}),o=o.items[r]),t&&o.errors.push(s(u)),p++}}};return o(e),t}export function toDotPath(e){const r=[];for(const s of e)"number"==typeof s?r.push(`[${s}]`):"symbol"==typeof s?r.push(`[${JSON.stringify(String(s))}]`):/[^\w$]/.test(s)?r.push(`[${JSON.stringify(s)}]`):(r.length&&r.push("."),r.push(s));return r.join("")}export function prettifyError(e){const r=[],s=[...e.issues].sort((e,r)=>e.path.length-r.path.length);for(const e of s)r.push(`✖ ${e.message}`),e.path?.length&&r.push(`  → at ${toDotPath(e.path)}`);return r.join("\n")}