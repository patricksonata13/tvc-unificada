"use strict";const browserslist=require("browserslist"),{compare:compare,has:has}=require("./helpers"),external=require("./external"),aliases=new Map([["and_chr","chrome-android"],["and_ff","firefox-android"],["ie_mob","ie"],["ios_saf","ios"],["oculus","quest"],["op_mob","opera-android"],["opera_mobile","opera-android"],["react","react-native"],["reactnative","react-native"]]),validTargets=new Set(["android","bun","chrome","chrome-android","deno","edge","electron","firefox","firefox-android","hermes","ie","ios","node","opera","opera-android","phantom","quest","react-native","rhino","safari","samsung"]),toLowerKeys=function(e){return Object.entries(e).reduce((e,[r,s])=>(e[r.toLowerCase()]=s,e),{})};module.exports=function(e){const{browsers:r,esmodules:s,node:o,...a}="object"!=typeof e||Array.isArray(e)?{browsers:e}:toLowerKeys(e),t=Object.entries(a),i="intersect"===s?"intersect":!!s;r&&!0!==i&&("string"==typeof r||Array.isArray(r)?t.push(...browserslist(r).map(e=>e.split(" "))):t.push(...Object.entries(r))),!0===i&&t.push(...Object.entries(external.modules)),o&&t.push(["node","current"===o?process.versions.node:o]);const n=t.map(([e,r])=>(has(browserslist.aliases,e)&&(e=browserslist.aliases[e]),aliases.has(e)&&(e=aliases.get(e)),[e,String(r)])).filter(([e])=>validTargets.has(e)).sort(([e],[r])=>e<r?-1:e>r?1:0),c=new Map,d="intersect"===i?">":"<=";for(const[e,r]of n)c.has(e)&&!compare(r,d,c.get(e))||c.set(e,r);return c};