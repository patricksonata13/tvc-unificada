"use strict";const schemaValidator=require("../SchemaValidator.js"),generateComponentDescriptorCpp=require("./components/GenerateComponentDescriptorCpp.js"),generateComponentDescriptorH=require("./components/GenerateComponentDescriptorH.js"),generateComponentHObjCpp=require("./components/GenerateComponentHObjCpp.js"),generateEventEmitterCpp=require("./components/GenerateEventEmitterCpp.js"),generateEventEmitterH=require("./components/GenerateEventEmitterH.js"),generatePropsCpp=require("./components/GeneratePropsCpp.js"),generatePropsH=require("./components/GeneratePropsH.js"),generatePropsJavaDelegate=require("./components/GeneratePropsJavaDelegate.js"),generatePropsJavaInterface=require("./components/GeneratePropsJavaInterface.js"),generateShadowNodeCpp=require("./components/GenerateShadowNodeCpp.js"),generateShadowNodeH=require("./components/GenerateShadowNodeH.js"),generateStateCpp=require("./components/GenerateStateCpp.js"),generateStateH=require("./components/GenerateStateH.js"),generateTests=require("./components/GenerateTests.js"),generateThirdPartyFabricComponentsProviderH=require("./components/GenerateThirdPartyFabricComponentsProviderH.js"),generateThirdPartyFabricComponentsProviderObjCpp=require("./components/GenerateThirdPartyFabricComponentsProviderObjCpp.js"),generateViewConfigJs=require("./components/GenerateViewConfigJs.js"),generateModuleCpp=require("./modules/GenerateModuleCpp.js"),generateModuleH=require("./modules/GenerateModuleH.js"),generateModuleJavaSpec=require("./modules/GenerateModuleJavaSpec.js"),generateModuleJniCpp=require("./modules/GenerateModuleJniCpp.js"),generateModuleJniH=require("./modules/GenerateModuleJniH.js"),generateModuleObjCpp=require("./modules/GenerateModuleObjCpp"),fs=require("fs"),path=require("path"),ALL_GENERATORS={generateComponentDescriptorH:generateComponentDescriptorH.generate,generateComponentDescriptorCpp:generateComponentDescriptorCpp.generate,generateComponentHObjCpp:generateComponentHObjCpp.generate,generateEventEmitterCpp:generateEventEmitterCpp.generate,generateEventEmitterH:generateEventEmitterH.generate,generatePropsCpp:generatePropsCpp.generate,generatePropsH:generatePropsH.generate,generateStateCpp:generateStateCpp.generate,generateStateH:generateStateH.generate,generateModuleH:generateModuleH.generate,generateModuleCpp:generateModuleCpp.generate,generateModuleObjCpp:generateModuleObjCpp.generate,generateModuleJavaSpec:generateModuleJavaSpec.generate,generateModuleJniCpp:generateModuleJniCpp.generate,generateModuleJniH:generateModuleJniH.generate,generatePropsJavaInterface:generatePropsJavaInterface.generate,generatePropsJavaDelegate:generatePropsJavaDelegate.generate,generateTests:generateTests.generate,generateShadowNodeCpp:generateShadowNodeCpp.generate,generateShadowNodeH:generateShadowNodeH.generate,generateThirdPartyFabricComponentsProviderObjCpp:generateThirdPartyFabricComponentsProviderObjCpp.generate,generateThirdPartyFabricComponentsProviderH:generateThirdPartyFabricComponentsProviderH.generate,generateViewConfigJs:generateViewConfigJs.generate},LIBRARY_GENERATORS={descriptors:[generateComponentDescriptorCpp.generate,generateComponentDescriptorH.generate],events:[generateEventEmitterCpp.generate,generateEventEmitterH.generate],states:[generateStateCpp.generate,generateStateH.generate],props:[generateComponentHObjCpp.generate,generatePropsCpp.generate,generatePropsH.generate,generatePropsJavaInterface.generate,generatePropsJavaDelegate.generate],componentsAndroid:[generateComponentDescriptorH.generate,generateComponentDescriptorCpp.generate,generateEventEmitterCpp.generate,generateEventEmitterH.generate,generatePropsCpp.generate,generatePropsH.generate,generateStateCpp.generate,generateStateH.generate,generateShadowNodeCpp.generate,generateShadowNodeH.generate,generatePropsJavaInterface.generate,generatePropsJavaDelegate.generate],componentsIOS:[generateComponentDescriptorH.generate,generateComponentDescriptorCpp.generate,generateEventEmitterCpp.generate,generateEventEmitterH.generate,generateComponentHObjCpp.generate,generatePropsCpp.generate,generatePropsH.generate,generateStateCpp.generate,generateStateH.generate,generateShadowNodeCpp.generate,generateShadowNodeH.generate],modulesAndroid:[generateModuleJniCpp.generate,generateModuleJniH.generate,generateModuleJavaSpec.generate],modulesCxx:[generateModuleCpp.generate,generateModuleH.generate],modulesIOS:[generateModuleObjCpp.generate],tests:[generateTests.generate],"shadow-nodes":[generateShadowNodeCpp.generate,generateShadowNodeH.generate]},SCHEMAS_GENERATORS={providerIOS:[generateThirdPartyFabricComponentsProviderObjCpp.generate,generateThirdPartyFabricComponentsProviderH.generate]};function writeMapToFiles(e){let r=!0;return e.forEach(e=>{try{const r=path.join(e.outputDir,e.name),t=path.dirname(r);fs.existsSync(t)||fs.mkdirSync(t,{recursive:!0}),fs.writeFileSync(r,e.content)}catch(t){r=!1,console.error(`Failed to write ${e.name} to ${e.outputDir}`,t)}}),r}function checkFilesForChanges(e){let r=!1;return e.forEach(e=>{const t=path.join(e.outputDir,e.name);fs.readFileSync(t,"utf8")!==e.content&&(console.error(`- ${e.name} has changed`),r=!0)}),!r}function checkOrWriteFiles(e,r){return!0===r?checkFilesForChanges(e):writeMapToFiles(e)}module.exports={allGenerators:ALL_GENERATORS,generate({libraryName:e,schema:r,outputDirectory:t,packageName:n,assumeNonnull:a,useLocalIncludePaths:o,libraryGenerators:p=LIBRARY_GENERATORS},{generators:g,test:s}){schemaValidator.validate(r);const i="react/renderer/components",d=!0===o?"":`${i}/${e}/`;function c(r){return path.join(t,r,e)}const u={componentsIOS:c(!0===o?"":i),modulesIOS:c("./"),descriptors:t,events:t,props:t,states:t,componentsAndroid:t,modulesAndroid:t,modulesCxx:t,tests:t,"shadow-nodes":t},C=[];for(const t of g)for(const o of p[t])o(e,r,n,a,d).forEach((e,r)=>{C.push({name:r,content:e,outputDir:u[t]})});return checkOrWriteFiles(C,s)},generateFromSchemas({schemas:e,outputDirectory:r,supportedApplePlatforms:t},{generators:n,test:a}){Object.keys(e).forEach(r=>schemaValidator.validate(e[r]));const o=[];for(const a of n)for(const n of SCHEMAS_GENERATORS[a])n(e,t).forEach((e,t)=>{o.push({name:t,content:e,outputDir:r})});return checkOrWriteFiles(o,a)},generateViewConfig({libraryName:e,schema:r}){schemaValidator.validate(r);const t=generateViewConfigJs.generate(e,r).values().next();if("string"!=typeof t.value)throw new Error(`Failed to generate view config for ${e}`);return t.value}};