import*as e from"../../../ui/components/helpers/helpers.js";import*as t from"../../../ui/lit/lit.js";import{render as r,html as s,nothing as o}from"../../../ui/lit/lit.js";import*as i from"../../../ui/visual_logging/visual_logging.js";import*as a from"../../../ui/legacy/legacy.js";import*as n from"../../../core/host/host.js";import*as d from"../../../core/i18n/i18n.js";import*as l from"../../../core/platform/platform.js";import*as h from"../../../core/sdk/sdk.js";import*as c from"../../../third_party/chromium/client-variations/client-variations.js";import"../../../ui/components/buttons/buttons.js";import"../forward/forward.js";import*as u from"../../../core/common/common.js";import*as p from"../../../models/persistence/persistence.js";import*as v from"../../../models/workspace/workspace.js";import*as m from"../../../ui/components/input/input.js";import*as g from"../../../ui/components/legacy_wrapper/legacy_wrapper.js";import*as f from"../../../ui/components/render_coordinator/render_coordinator.js";import*as w from"../../sources/sources.js";import*as y from"../../../models/issues_manager/issues_manager.js";import"../../../ui/components/report_view/report_view.js";import"../../../ui/components/icon_button/icon_button.js";import"../../../ui/legacy/components/data_grid/data_grid.js";import{PanelUtils as b}from"../../utils/utils.js";var k={cssText:`:host{display:inline}.editable{cursor:text;overflow-wrap:anywhere;min-height:18px;line-height:18px;min-width:0.5em;background:transparent;border:none;border-radius:4px;outline:none;display:inline-block;font-family:var(--monospace-font-family);font-size:var(--monospace-font-size);&:hover{border:1px solid var(--sys-color-neutral-outline)}&:focus{border:1px solid var(--sys-color-state-focus-ring)}}.editable::selection{color:var(--sys-color-on-tonal-container);background-color:var(--sys-color-tonal-container)}\n/*# sourceURL=${import.meta.resolve("./EditableSpan.css")} */\n`};const x=new CSSStyleSheet;x.replaceSync(k.cssText);class S extends HTMLElement{#e=this.attachShadow({mode:"open"});#t=this.#s.bind(this);#i="";connectedCallback(){this.#e.adoptedStyleSheets=[x],this.#e.addEventListener("focusin",this.#r.bind(this)),this.#e.addEventListener("keydown",this.#o.bind(this)),this.#e.addEventListener("input",this.#n.bind(this))}set data(t){this.#i=t.value,e.ScheduledRender.scheduleRender(this,this.#t)}get value(){return this.#e.querySelector("span")?.innerText||""}set value(e){this.#i=e;const t=this.#e.querySelector("span");t&&(t.innerText=e)}#o(e){"Enter"===e.key&&(e.preventDefault(),e.target?.blur())}#n(e){this.#i=e.target.innerText}#r(e){const t=e.target,s=window.getSelection(),i=document.createRange();i.selectNodeContents(t),s?.removeAllRanges(),s?.addRange(i)}#s(){if(!e.ScheduledRender.isScheduledRender(this))throw new Error("HeaderSectionRow render was not scheduled");r(s`<span
        contenteditable="plaintext-only"
        class="editable"
        tabindex="0"
        .innerText=${this.#i}
        jslog=${i.value("header-editor").track({change:!0,keydown:"Enter|Escape"})}
    </span>`,this.#e,{host:this})}focus(){requestAnimationFrame(()=>{const e=this.#e.querySelector(".editable");e?.focus()})}}customElements.define("devtools-editable-span",S);var R=Object.freeze({__proto__:null,EditableSpan:S}),E={cssText:`:host{display:block}.row{display:flex;line-height:18px;padding-left:8px;gap:var(--sys-size-6);user-select:text;margin:var(--sys-size-3) 0}.row.header-editable{font-family:var(--monospace-font-family);font-size:var(--monospace-font-size)}.header-name{font:var(--sys-typescale-body5-medium);color:var(--sys-color-on-surface-subtle);width:30%;min-width:160px;max-width:240px;flex-shrink:0;text-transform:capitalize;overflow-wrap:break-word}.header-name,\n.header-value{&::selection{color:var(--sys-color-on-tonal-container);background-color:var(--sys-color-tonal-container)}}.header-name.pseudo-header{text-transform:none}.header-editable .header-name{color:var(--sys-color-token-property-special)}.row.header-deleted .header-name{color:var(--sys-color-token-subtle)}.header-value{display:flex;overflow-wrap:anywhere;margin-inline-end:14px;font:var(--sys-typescale-body4-regular)}.header-badge-text{font-variant:small-caps;font-weight:500;white-space:pre-wrap;word-break:break-all;text-transform:none}.header-badge{display:inline;background-color:var(--sys-color-error);color:var(--sys-color-on-error);border-radius:100vh;padding-left:6px;padding-right:6px}.call-to-action{background-color:var(--sys-color-neutral-container);padding:8px;border-radius:5px;margin:4px}.call-to-action-body{padding:6px 0;margin-left:9.5px;border-left:2px solid var(--issue-color-yellow);padding-left:18px;line-height:20px}.call-to-action .explanation{font-weight:bold}.call-to-action code{font-size:90%}.call-to-action .example .comment::before{content:" — "}.link,\n.devtools-link{color:var(--sys-color-primary);text-decoration:underline;cursor:pointer;outline-offset:2px}.explanation .link{font-weight:normal}.inline-icon{vertical-align:middle}.row-flex-icon{margin:2px 5px 0}.header-value code{display:block;white-space:pre-wrap;font-size:90%;color:var(--sys-color-token-subtle)}x-link .inline-icon{padding-right:3px}.header-highlight{background-color:var(--sys-color-yellow-container)}.header-warning{color:var(--sys-color-error)}.header-overridden{background-color:var(--sys-color-tertiary-container);border-left:3px solid var(--sys-color-tertiary);padding-left:5px}.header-deleted{background-color:var(--sys-color-surface-error);border-left:3px solid var(--sys-color-error-bright);color:var(--sys-color-token-subtle);text-decoration:line-through}.header-highlight.header-overridden{background-color:var(--sys-color-yellow-container);border-left:3px solid var(--sys-color-tertiary);padding-left:5px}.inline-button{vertical-align:middle}.row .inline-button{opacity:0%;visibility:hidden;transition:opacity 200ms;padding-left:2px}.row.header-overridden:focus-within .inline-button,\n.row.header-overridden:hover .inline-button{opacity:100%;visibility:visible}.row:hover .inline-button.enable-editing{opacity:100%;visibility:visible}.flex-right{margin-left:auto}.flex-columns{flex-direction:column}\n/*# sourceURL=${import.meta.resolve("./HeaderSectionRow.css")} */\n`};const H=new CSSStyleSheet;H.replaceSync(E.cssText);const{render:q,html:$}=t,C={activeClientExperimentVariation:"Active `client experiment variation IDs`.",activeClientExperimentVariationIds:"Active `client experiment variation IDs` that trigger server-side behavior.",decoded:"Decoded:",editHeader:"Override header",headerNamesOnlyLetters:"Header names should contain only letters, digits, hyphens or underscores",learnMore:"Learn more",learnMoreInTheIssuesTab:"Learn more in the issues tab",reloadPrompt:"Refresh the page/request for these changes to take effect",removeOverride:"Remove this header override"},T=d.i18n.registerUIStrings("panels/network/components/HeaderSectionRow.ts",C),O=d.i18n.getLocalizedString.bind(void 0,T),N=e=>/^[a-z0-9_\-]+$/i.test(e),A=(e,t)=>e?.replaceAll(/\s/g," ")===t?.replaceAll(/\s/g," ");class D extends Event{static eventName="headeredited";headerName;headerValue;constructor(e,t){super(D.eventName,{}),this.headerName=e,this.headerValue=t}}class L extends Event{static eventName="headerremoved";headerName;headerValue;constructor(e,t){super(L.eventName,{}),this.headerName=e,this.headerValue=t}}class I extends Event{static eventName="enableheaderediting";constructor(){super(I.eventName,{})}}class U extends HTMLElement{#e=this.attachShadow({mode:"open"});#a=null;#t=this.#s.bind(this);#l=!1;#d=!0;connectedCallback(){this.#e.adoptedStyleSheets=[H]}set data(t){this.#a=t.header,this.#l=void 0!==this.#a.originalValue&&this.#a.value!==this.#a.originalValue,this.#d=N(this.#a.name),e.ScheduledRender.scheduleRender(this,this.#t)}#s(){if(!e.ScheduledRender.isScheduledRender(this))throw new Error("HeaderSectionRow render was not scheduled");if(!this.#a)return;const s=t.Directives.classMap({row:!0,"header-highlight":Boolean(this.#a.highlight),"header-overridden":Boolean(this.#a.isOverride)||this.#l,"header-editable":1===this.#a.valueEditable,"header-deleted":Boolean(this.#a.isDeleted)}),i=t.Directives.classMap({"header-name":!0,"pseudo-header":this.#a.name.startsWith(":")}),r=t.Directives.classMap({"header-value":!0,"header-warning":Boolean(this.#a.headerValueIncorrect),"flex-columns":"x-client-data"===this.#a.name&&!this.#a.isResponseHeader}),o=this.#a.nameEditable&&1===this.#a.valueEditable,a=this.#a.nameEditable||this.#a.isDeleted||this.#l;q($`
      <div class=${s}>
        <div class=${i}>
          ${this.#a.headerNotSet?$`<div class="header-badge header-badge-text">${d.i18n.lockedString("not-set")}</div> `:t.nothing}
          ${o&&!this.#d?$`<devtools-icon class="inline-icon disallowed-characters" title=${C.headerNamesOnlyLetters} .data=${{iconName:"cross-circle-filled",width:"16px",height:"16px",color:"var(--icon-error)"}}>
            </devtools-icon>`:t.nothing}
          ${o&&!this.#a.isDeleted?$`<devtools-editable-span
              @focusout=${this.#c}
              @keydown=${this.#o}
              @input=${this.#h}
              @paste=${this.#u}
              .data=${{value:this.#a.name}}
            ></devtools-editable-span>`:this.#a.name}
        </div>
        <div
          class=${r}
          @copy=${()=>n.userMetrics.actionTaken(n.UserMetrics.Action.NetworkPanelCopyValue)}
        >
          ${this.#p()}
        </div>
        ${a?$`<devtools-icon class="row-flex-icon flex-right" title=${C.reloadPrompt} .data=${{iconName:"info",width:"16px",height:"16px",color:"var(--icon-default)"}}>
          </devtools-icon>`:t.nothing}
      </div>
      ${this.#v(this.#a.blockedDetails)}
    `,this.#e,{host:this}),this.#a.highlight&&this.scrollIntoView({behavior:"auto"})}#p(){if(!this.#a)return t.nothing;if("x-client-data"===this.#a.name&&!this.#a.isResponseHeader)return this.#m(this.#a);if(this.#a.isDeleted||1!==this.#a.valueEditable){const e=this.#a.isResponseHeader&&!this.#a.isDeleted&&2!==this.#a.valueEditable;return $`
      ${this.#a.value||""}
      ${this.#g(this.#a)}
      ${e?$`
        <devtools-button
          title=${O(C.editHeader)}
          .size=${"SMALL"}
          .iconName=${"edit"}
          .variant=${"icon"}
          @click=${()=>{this.dispatchEvent(new I)}}
          jslog=${i.action("enable-header-overrides").track({click:!0})}
          class="enable-editing inline-button"
        ></devtools-button>
      `:t.nothing}
    `}return $`
      <devtools-editable-span
        @focusout=${this.#f}
        @input=${this.#k}
        @paste=${this.#k}
        @keydown=${this.#o}
        .data=${{value:this.#a.value||""}}
      ></devtools-editable-span>
      ${this.#g(this.#a)}
      <devtools-button
        title=${O(C.removeOverride)}
        .size=${"SMALL"}
        .iconName=${"bin"}
        .variant=${"icon"}
        class="remove-header inline-button"
        @click=${this.#y}
        jslog=${i.action("remove-header-override").track({click:!0})}
      ></devtools-button>
    `}#m(e){const t=c.parseClientVariations(e.value||""),s=c.formatClientVariations(t,O(C.activeClientExperimentVariation),O(C.activeClientExperimentVariationIds));return $`
      <div>${e.value||""}</div>
      <div>${O(C.decoded)}</div>
      <code>${s}</code>
    `}focus(){requestAnimationFrame(()=>{const e=this.#e.querySelector(".header-name devtools-editable-span");e?.focus()})}#g(e){if("set-cookie"===e.name&&e.setCookieBlockedReasons){const t=e.setCookieBlockedReasons.map(h.NetworkRequest.setCookieBlockedReasonToUiString).join("\n");return $`
        <devtools-icon class="row-flex-icon" title=${t} .data=${{iconName:"warning-filled",color:"var(--icon-warning)",width:"16px",height:"16px"}}>
        </devtools-icon>
      `}return t.nothing}#v(e){return e?$`
      <div class="call-to-action">
        <div class="call-to-action-body">
          <div class="explanation">${e.explanation()}</div>
          ${e.examples.map(e=>$`
            <div class="example">
              <code>${e.codeSnippet}</code>
              ${e.comment?$`
                <span class="comment">${e.comment()}</span>
              `:""}
            </div>
          `)}
          ${this.#w(e)}
        </div>
      </div>
    `:t.nothing}#w(e){return e?.reveal?$`
        <div class="devtools-link" @click=${e.reveal}>
          <devtools-icon class="inline-icon" .data=${{iconName:"issue-exclamation-filled",color:"var(--icon-warning)",width:"16px",height:"16px"}}>
          </devtools-icon
          >${O(C.learnMoreInTheIssuesTab)}
        </div>
      `:e?.link?$`
        <x-link href=${e.link.url} class="link">
          <devtools-icon class="inline-icon" .data=${{iconName:"open-externally",color:"var(--icon-link)",width:"20px",height:"20px"}}>
          </devtools-icon
          >${O(C.learnMore)}
        </x-link>
      `:t.nothing}#f(t){const s=t.target;if(!this.#a)return;const i=s.value.trim();A(i,this.#a.value?.trim())||(this.#a.value=i,this.dispatchEvent(new D(this.#a.name,i)),e.ScheduledRender.scheduleRender(this,this.#t));const r=window.getSelection();r?.removeAllRanges(),this.#a.originalName=""}#c(t){const s=t.target;if(!this.#a)return;const i=l.StringUtilities.toLowerCaseString(s.value.trim());""===i?s.value=this.#a.name:A(i,this.#a.name.trim())||(this.#a.name=i,this.dispatchEvent(new D(i,this.#a.value||"")),e.ScheduledRender.scheduleRender(this,this.#t));const r=window.getSelection();r?.removeAllRanges()}#y(){if(!this.#a)return;const e=this.#e.querySelector(".header-value devtools-editable-span");this.#a.originalValue&&(e.value=this.#a?.originalValue),this.dispatchEvent(new L(this.#a.name,this.#a.value||""))}#o(e){const t=e,s=e.target;if("Escape"===t.key){if(e.consume(),s.matches(".header-name devtools-editable-span"))s.value=this.#a?.name||"",this.#h(e);else if(s.matches(".header-value devtools-editable-span")&&(s.value=this.#a?.value||"",this.#k(e),this.#a?.originalName)){const e=this.#e.querySelector(".header-name devtools-editable-span");return e.value=this.#a.originalName,this.#a.originalName="",e.dispatchEvent(new Event("input")),void e.focus()}s.blur()}}#h(t){const s=t.target,i=N(s.value);this.#d!==i&&(this.#d=i,e.ScheduledRender.scheduleRender(this,this.#t))}#k(t){const s=t.target,i=void 0!==this.#a?.originalValue&&!A(this.#a?.originalValue||"",s.value);this.#l!==i&&(this.#l=i,this.#a&&(this.#a.highlight=!1),e.ScheduledRender.scheduleRender(this,this.#t))}#u(e){if(!e.clipboardData)return;const t=e.target,s=e.clipboardData.getData("text/plain")||"",i=s.indexOf(":");if(i<1)return t.value=s,e.preventDefault(),void t.dispatchEvent(new Event("input",{bubbles:!0}));this.#a&&(this.#a.originalName=this.#a.name);const r=s.substring(i+1,s.length).trim(),o=s.substring(0,i);t.value=o,t.dispatchEvent(new Event("input"));const n=this.#e.querySelector(".header-value devtools-editable-span");n&&(n.focus(),n.value=r,n.dispatchEvent(new Event("input"))),e.preventDefault()}}customElements.define("devtools-header-section-row",U);var V=Object.freeze({__proto__:null,EnableHeaderEditingEvent:I,HeaderEditedEvent:D,HeaderRemovedEvent:L,HeaderSectionRow:U,compareHeaders:A,isValidHeaderName:N}),F={cssText:`:host{display:block}devtools-header-section-row:last-of-type{margin-bottom:10px}devtools-header-section-row:first-of-type{margin-top:2px}.call-to-action{background-color:var(--sys-color-neutral-container);padding:8px;border-radius:5px;margin:4px}.call-to-action-body{padding:6px 0;margin-left:9.5px;border-left:2px solid var(--issue-color-yellow);padding-left:18px;line-height:20px}.call-to-action .explanation{font-weight:bold}.call-to-action code{font-size:90%}.call-to-action .example .comment::before{content:" — "}.link,\n.devtools-link{color:var(--sys-color-primary);text-decoration:underline;cursor:pointer;outline-offset:2px}.explanation .link{font-weight:normal}.inline-icon{vertical-align:middle}@media (forced-colors: active){.link,\n  .devtools-link{color:linktext;text-decoration-color:linktext}}\n/*# sourceURL=${import.meta.resolve("./RequestHeaderSection.css")} */\n`};const P=new CSSStyleSheet;P.replaceSync(F.cssText);const{render:_,html:M}=t,j={learnMore:"Learn more",provisionalHeadersAreShownDisableCache:"Provisional headers are shown. Disable cache to see full headers.",onlyProvisionalHeadersAre:"Only provisional headers are available because this request was not sent over the network and instead was served from a local cache, which doesn’t store the original request headers. Disable cache to see full request headers.",provisionalHeadersAreShown:"Provisional headers are shown."},z=d.i18n.registerUIStrings("panels/network/components/RequestHeaderSection.ts",j),W=d.i18n.getLocalizedString.bind(void 0,z);class B extends HTMLElement{#e=this.attachShadow({mode:"open"});#b;#x=[];connectedCallback(){this.#e.adoptedStyleSheets=[P]}set data(e){this.#b=e.request,this.#x=this.#b.requestHeaders().map(e=>({name:l.StringUtilities.toLowerCaseString(e.name),value:e.value,valueEditable:2})),this.#x.sort((e,t)=>l.StringUtilities.compare(e.name,t.name)),"Request"===e.toReveal?.section&&this.#x.filter(t=>t.name===e.toReveal?.header?.toLowerCase()).forEach(e=>{e.highlight=!0}),this.#s()}#s(){this.#b&&_(M`
      ${this.#S()}
      ${this.#x.map(e=>M`
        <devtools-header-section-row
          .data=${{header:e}}
          jslog=${i.item("request-header")}
        ></devtools-header-section-row>
      `)}
    `,this.#e,{host:this})}#S(){if(!this.#b||void 0!==this.#b.requestHeadersText())return t.nothing;let e,s="";return this.#b.cachedInMemory()||this.#b.cached()?(e=W(j.provisionalHeadersAreShownDisableCache),s=W(j.onlyProvisionalHeadersAre)):e=W(j.provisionalHeadersAreShown),M`
      <div class="call-to-action">
        <div class="call-to-action-body">
          <div class="explanation" title=${s}>
            <devtools-icon class="inline-icon" .data=${{iconName:"warning-filled",color:"var(--icon-warning)",width:"16px",height:"16px"}}>
            </devtools-icon>
            ${e} <x-link href="https://developer.chrome.com/docs/devtools/network/reference/#provisional-headers" class="link">${W(j.learnMore)}</x-link>
          </div>
        </div>
      </div>
    `}}customElements.define("devtools-request-header-section",B);var G=Object.freeze({__proto__:null,RequestHeaderSection:B}),K={cssText:`.header{background-color:var(--sys-color-surface1);border-bottom:1px solid var(--sys-color-divider);border-top:1px solid var(--sys-color-divider);line-height:25px;padding:0 5px}.header::marker{font-size:11px;line-height:1}.header:focus{background-color:var(--sys-color-state-header-hover)}details[open] .header-count{display:none}details .hide-when-closed{display:none}details[open] .hide-when-closed{display:block}details summary input{vertical-align:middle}.row{display:flex;line-height:18px;padding-left:8px;gap:var(--sys-size-6);user-select:text;margin:var(--sys-size-3) 0}div.raw-headers-row{display:block}.row:first-of-type{margin-top:var(--sys-size-5)}.row:last-child{margin-bottom:var(--sys-size-5)}.header-name{color:var(--sys-color-on-surface-subtle);font:var(--sys-typescale-body5-medium);width:30%;min-width:160px;max-width:240px;flex-shrink:0;text-transform:capitalize}.header-value{word-break:break-all;display:flex;align-items:center;gap:2px;font:var(--sys-typescale-body4-regular)}.header-name,\n.header-value{&::selection{color:var(--sys-color-on-tonal-container);background-color:var(--sys-color-tonal-container)}}.green-circle::before,\n.red-circle::before,\n.yellow-circle::before{content:"";display:inline-block;width:12px;height:12px;border-radius:6px;vertical-align:text-top;margin-right:2px}.green-circle::before{background-color:var(--sys-color-green-bright)}.red-circle::before{background-color:var(--sys-color-error-bright)}.yellow-circle::before{background-color:var(--issue-color-yellow)}.status-with-comment{color:var(--sys-color-token-subtle)}.raw-headers{font-family:var(--source-code-font-family);font-size:var(--source-code-font-size);white-space:pre-wrap;word-break:break-all}.link,\n.devtools-link{color:var(--sys-color-primary);text-decoration:underline;cursor:pointer;outline-offset:2px}.inline-icon{vertical-align:middle}.header-grid-container{display:inline-grid;grid-template-columns:156px 50px 1fr;grid-gap:4px;width:calc(100% - 15px)}.header-grid-container div:last-child{text-align:right}.header .devtools-link{color:var(--sys-color-on-surface)}x-link{position:relative}x-link .inline-icon{padding-right:3px}.purple.dot::before{background-color:var(--sys-color-purple-bright);content:var(--image-file-empty);width:6px;height:6px;border-radius:50%;outline:1px solid var(--icon-gap-toolbar);left:9px;position:absolute;top:11px;z-index:1}summary label{display:inline-flex;align-items:center;vertical-align:middle;gap:var(--sys-size-3)}summary label input[type="checkbox"]{margin-top:1px}\n/*# sourceURL=${import.meta.resolve("./RequestHeadersView.css")} */\n`},Y={cssText:`:host{display:block}devtools-header-section-row:last-of-type{margin-bottom:var(--sys-size-5)}devtools-header-section-row:first-of-type{margin-top:var(--sys-size-5)}.add-header-button{margin:-4px 0 10px 5px}\n/*# sourceURL=${import.meta.resolve("./ResponseHeaderSection.css")} */\n`};const J=new CSSStyleSheet;J.replaceSync(Y.cssText);const Q={addHeader:"Add header",chooseThisOptionIfTheResourceAnd:"Choose this option if the resource and the document are served from the same site.",onlyChooseThisOptionIfAn:"Only choose this option if an arbitrary website including this resource does not impose a security risk.",thisDocumentWasBlockedFrom:"The document was blocked from loading in a popup opened by a sandboxed iframe because this document specified a cross-origin opener policy.",toEmbedThisFrameInYourDocument:"To embed this frame in your document, the response needs to enable the cross-origin embedder policy by specifying the following response header:",toUseThisResourceFromADifferent:"To use this resource from a different origin, the server needs to specify a cross-origin resource policy in the response headers:",toUseThisResourceFromADifferentOrigin:"To use this resource from a different origin, the server may relax the cross-origin resource policy response header:",toUseThisResourceFromADifferentSite:"To use this resource from a different site, the server may relax the cross-origin resource policy response header:"},X=d.i18n.registerUIStrings("panels/network/components/ResponseHeaderSection.ts",Q),Z=d.i18n.getLocalizedString.bind(void 0,X),ee=d.i18n.getLazilyComputedLocalizedString.bind(void 0,X),te="ResponseHeaderSection";class re extends HTMLElement{shadow=this.attachShadow({mode:"open"});headerDetails=[];connectedCallback(){this.shadow.adoptedStyleSheets=[J]}setHeaders(e){e.sort(function(e,t){return l.StringUtilities.compare(e.name.toLowerCase(),t.name.toLowerCase())}),this.headerDetails=e.map(e=>({name:l.StringUtilities.toLowerCaseString(e.name),value:e.value.replace(/\s/g," ")}))}highlightHeaders(e){"Response"===e.toReveal?.section&&this.headerDetails.filter(t=>A(t.name,e.toReveal?.header?.toLowerCase())).forEach(e=>{e.highlight=!0})}}class se extends re{#b;set data(e){this.#b=e.request,this.setHeaders(this.#b.earlyHintsHeaders),this.highlightHeaders(e),this.#s()}#s(){this.#b&&r(s`
      ${this.headerDetails.map(e=>s`
        <devtools-header-section-row .data=${{header:e}}></devtools-header-section-row>
      `)}
    `,this.shadow,{host:this})}}customElements.define("devtools-early-hints-header-section",se);class oe extends re{#b;#$=[];#R=null;#E=[];#C=0;set data(e){this.#b=e.request,this.#C=p.NetworkPersistenceManager.NetworkPersistenceManager.isForbiddenNetworkUrl(this.#b.url())?2:0;const t=this.#b.sortedResponseHeaders.concat(this.#b.setCookieHeaders);this.setHeaders(t);const s=[];if(this.#b.wasBlocked()){const e=ie.get(this.#b.blockedReason());if(e){if(y.RelatedIssue.hasIssueOfCategory(this.#b,"CrossOriginEmbedderPolicy")){const t=()=>{n.userMetrics.issuesPanelOpenedFrom(1),this.#b&&y.RelatedIssue.reveal(this.#b,"CrossOriginEmbedderPolicy")};e.blockedDetails&&(e.blockedDetails.reveal=t)}s.push(e)}}this.headerDetails=function(e,t){let s=0,i=0;const r=[];for(;s<e.length&&i<t.length;)e[s].name<t[i].name?r.push({...e[s++],headerNotSet:!1}):e[s].name>t[i].name?r.push({...t[i++],headerNotSet:!0}):r.push({...t[i++],...e[s++],headerNotSet:!1});for(;s<e.length;)r.push({...e[s++],headerNotSet:!1});for(;i<t.length;)r.push({...t[i++],headerNotSet:!0});return r}(this.headerDetails,s);const i=this.#b.blockedResponseCookies(),r=new Map(i?.map(e=>[e.cookieLine.replace(/\s/g," "),e.blockedReasons]));for(const e of this.headerDetails)if("set-cookie"===e.name&&e.value){const t=r.get(e.value);t&&(e.setCookieBlockedReasons=t)}this.highlightHeaders(e);const o=this.#b.getAssociatedData(te);o?this.#$=o:(this.#$=this.headerDetails.map(e=>({name:e.name,value:e.value,originalValue:e.value,valueEditable:this.#C})),this.#H()),this.#T(),this.#b.setAssociatedData(te,this.#$),this.#s()}#N(){this.#b&&(this.#C=p.NetworkPersistenceManager.NetworkPersistenceManager.isForbiddenNetworkUrl(this.#b.url())?2:0,this.#$=this.headerDetails.map(e=>({name:e.name,value:e.value,originalValue:e.value,valueEditable:this.#C})),this.#H(),this.#b.setAssociatedData(te,this.#$))}async#T(){if(this.#b){if(this.#R=p.NetworkPersistenceManager.NetworkPersistenceManager.instance().getHeadersUISourceCodeFromUrl(this.#b.url()),!this.#R)return this.#N(),void this.#s();try{const e=await this.#R.requestContent();if(this.#E=JSON.parse(e.content||"[]"),!this.#E.every(p.NetworkPersistenceManager.isHeaderOverride))throw new Error("Type mismatch after parsing");u.Settings.Settings.instance().moduleSetting("persistence-network-overrides-enabled").get()&&0===this.#C&&(this.#C=1);for(const e of this.#$)e.valueEditable=this.#C}catch{console.error("Failed to parse",this.#R?.url()||"source code file","for locally overriding headers."),this.#N()}finally{this.#s()}}}#H(){if(!this.#b||0===this.#b.originalResponseHeaders.length)return;const e=this.#b.originalResponseHeaders.map(e=>({name:l.StringUtilities.toLowerCaseString(e.name),value:e.value.replace(/\s/g," ")}));e.sort(function(e,t){return l.StringUtilities.compare(e.name,t.name)});let t=0,s=0;for(;t<this.headerDetails.length;){const i=this.headerDetails[t].name;let r=this.headerDetails[t].value||"";const o=this.headerDetails[t].headerNotSet;for(;t<this.headerDetails.length-1&&this.headerDetails[t+1].name===i;)t++,r+=`, ${this.headerDetails[t].value}`;for(;s<e.length&&e[s].name<i;)s++;if(s<e.length&&e[s].name===i){let t=e[s].value;for(;s<e.length-1&&e[s+1].name===i;)s++,t+=`, ${e[s].value}`;s++,"set-cookie"===i||o||A(r,t)||this.#$.filter(e=>A(e.name,i)).forEach(e=>{e.isOverride=!0})}else"set-cookie"===i||o||this.#$.filter(e=>A(e.name,i)).forEach(e=>{e.isOverride=!0});t++}this.#$.filter(e=>"set-cookie"===e.name).forEach(e=>{void 0===this.#b?.originalResponseHeaders.find(t=>"set-cookie"===l.StringUtilities.toLowerCaseString(t.name)&&A(t.value,e.value))&&(e.isOverride=!0)})}#A(e){const t=e.target;if(void 0===t.dataset.index)return;const s=Number(t.dataset.index);N(e.headerName)&&(this.#D(e.headerName,e.headerValue,s),n.userMetrics.actionTaken(n.UserMetrics.Action.HeaderOverrideHeaderEdited))}#L(e){const t=p.NetworkPersistenceManager.NetworkPersistenceManager.instance().rawPathFromUrl(e,!0),s=t.lastIndexOf("/");return u.ParsedURL.ParsedURL.substring(t,s+1)}#O(){this.#R?.setWorkingCopy(JSON.stringify(this.#E,null,2)),this.#R?.commitWorkingCopy()}#q(e,t,s){for(let i=this.#E.length-1;i>=0;i--){const r=this.#E[i];if(r.applyTo!==e)continue;const o=r.headers.findIndex(e=>A(e.name,t)&&A(e.value,s));if(!(o<0))return r.headers.splice(o,1),void(0===r.headers.length&&this.#E.splice(i,1))}}#I(e){const t=e.target;if(void 0===t.dataset.index||!this.#b)return;const s=Number(t.dataset.index),i=this.#L(this.#b.url());this.#q(i,e.headerName,e.headerValue),this.#O(),this.#$[s].isDeleted=!0,this.#s(),n.userMetrics.actionTaken(n.UserMetrics.Action.HeaderOverrideHeaderRemoved)}#D(e,t,s){if(!this.#b)return;0===this.#b.originalResponseHeaders.length&&(this.#b.originalResponseHeaders=this.#b.sortedResponseHeaders.map(e=>({...e})));const i=this.#$[s].name,r=this.#$[s].value;this.#$[s].name=e,this.#$[s].value=t;let o=[];"set-cookie"===e?o.push({name:e,value:t,valueEditable:this.#C}):o=this.#$.filter(t=>A(t.name,e)&&(!A(t.value,t.originalValue)||t.isOverride));const n=this.#L(this.#b.url());let a=null;const[l]=this.#E.slice(-1);if(l?.applyTo===n?a=l:(a={applyTo:n,headers:[]},this.#E.push(a)),"set-cookie"===e){const e=a.headers.findIndex(e=>A(e.name,i)&&A(e.value,r));e>=0&&a.headers.splice(e,1)}else a.headers=a.headers.filter(t=>!A(t.name,e));if(!A(this.#$[s].name,i))for(let e=0;e<a.headers.length;++e)if(A(a.headers[e].name,i)&&A(a.headers[e].value,r)){a.headers.splice(e,1);break}for(const e of o)a.headers.push({name:e.name,value:e.value||""});0===a.headers.length&&this.#E.pop(),this.#O()}#U(){this.#$.push({name:l.StringUtilities.toLowerCaseString(d.i18n.lockedString("header-name")),value:d.i18n.lockedString("header value"),isOverride:!0,nameEditable:!0,valueEditable:1});const e=this.#$.length-1;this.#D(this.#$[e].name,this.#$[e].value||"",e),this.#s();const t=this.shadow.querySelectorAll("devtools-header-section-row"),[s]=Array.from(t).slice(-1);s?.focus(),n.userMetrics.actionTaken(n.UserMetrics.Action.HeaderOverrideHeaderAdded)}#s(){if(!this.#b)return;const e=this.#$.map((e,t)=>({...this.headerDetails[t],...e,isResponseHeader:!0}));r(s`
      ${e.map((e,t)=>s`
        <devtools-header-section-row
            .data=${{header:e}}
            @headeredited=${this.#A}
            @headerremoved=${this.#I}
            @enableheaderediting=${this.#M}
            data-index=${t}
            jslog=${i.item("response-header")}
        ></devtools-header-section-row>
      `)}
      ${1===this.#C?s`
        <devtools-button
          class="add-header-button"
          .variant=${"outlined"}
          .iconName=${"plus"}
          @click=${this.#U}
          jslog=${i.action("add-header").track({click:!0})}>
          ${Z(Q.addHeader)}
        </devtools-button>
      `:o}
    `,this.shadow,{host:this})}async#M(){if(!this.#b)return;n.userMetrics.actionTaken(n.UserMetrics.Action.HeaderOverrideEnableEditingClicked);const e=this.#b.url(),t=p.NetworkPersistenceManager.NetworkPersistenceManager.instance();t.project()?(u.Settings.Settings.instance().moduleSetting("persistence-network-overrides-enabled").set(!0),await t.getOrCreateHeadersUISourceCodeFromUrl(e)):a.InspectorView.InspectorView.instance().displaySelectOverrideFolderInfobar(async()=>{await w.SourcesNavigator.OverridesNavigatorView.instance().setupNewWorkspace(),await t.getOrCreateHeadersUISourceCodeFromUrl(e)})}}customElements.define("devtools-response-header-section",oe);const ie=new Map([["coep-frame-resource-needs-coep-header",{name:l.StringUtilities.toLowerCaseString("cross-origin-embedder-policy"),value:null,blockedDetails:{explanation:ee(Q.toEmbedThisFrameInYourDocument),examples:[{codeSnippet:"Cross-Origin-Embedder-Policy: require-corp",comment:void 0}],link:{url:"https://web.dev/coop-coep/"}}}],["corp-not-same-origin-after-defaulted-to-same-origin-by-coep",{name:l.StringUtilities.toLowerCaseString("cross-origin-resource-policy"),value:null,blockedDetails:{explanation:ee(Q.toUseThisResourceFromADifferent),examples:[{codeSnippet:"Cross-Origin-Resource-Policy: same-site",comment:ee(Q.chooseThisOptionIfTheResourceAnd)},{codeSnippet:"Cross-Origin-Resource-Policy: cross-origin",comment:ee(Q.onlyChooseThisOptionIfAn)}],link:{url:"https://web.dev/coop-coep/"}}}],["coop-sandboxed-iframe-cannot-navigate-to-coop-page",{name:l.StringUtilities.toLowerCaseString("cross-origin-opener-policy"),value:null,headerValueIncorrect:!1,blockedDetails:{explanation:ee(Q.thisDocumentWasBlockedFrom),examples:[],link:{url:"https://web.dev/coop-coep/"}}}],["corp-not-same-site",{name:l.StringUtilities.toLowerCaseString("cross-origin-resource-policy"),value:null,headerValueIncorrect:!0,blockedDetails:{explanation:ee(Q.toUseThisResourceFromADifferentSite),examples:[{codeSnippet:"Cross-Origin-Resource-Policy: cross-origin",comment:ee(Q.onlyChooseThisOptionIfAn)}],link:null}}],["corp-not-same-origin",{name:l.StringUtilities.toLowerCaseString("cross-origin-resource-policy"),value:null,headerValueIncorrect:!0,blockedDetails:{explanation:ee(Q.toUseThisResourceFromADifferentOrigin),examples:[{codeSnippet:"Cross-Origin-Resource-Policy: same-site",comment:ee(Q.chooseThisOptionIfTheResourceAnd)},{codeSnippet:"Cross-Origin-Resource-Policy: cross-origin",comment:ee(Q.onlyChooseThisOptionIfAn)}],link:null}}]]);var ae=Object.freeze({__proto__:null,EarlyHintsHeaderSection:se,RESPONSE_HEADER_SECTION_DATA_KEY:te,ResponseHeaderSection:oe});const ne=new CSSStyleSheet;ne.replaceSync(K.cssText);const{render:de,html:le}=t,he={fromDiskCache:"(from disk cache)",fromMemoryCache:"(from memory cache)",fromEarlyHints:"(from early hints)",fromPrefetchCache:"(from prefetch cache)",fromServiceWorker:"(from `service worker`)",fromSignedexchange:"(from signed-exchange)",fromWebBundle:"(from Web Bundle)",general:"General",raw:"Raw",referrerPolicy:"Referrer Policy",remoteAddress:"Remote Address",requestHeaders:"Request Headers",requestMethod:"Request Method",requestUrl:"Request URL",responseHeaders:"Response Headers",earlyHintsHeaders:"Early Hints Headers",revealHeaderOverrides:"Reveal header override definitions",showMore:"Show more",statusCode:"Status Code"},ce=d.i18n.registerUIStrings("panels/network/components/RequestHeadersView.ts",he),ue=d.i18n.getLocalizedString.bind(void 0,ce);class pe extends g.LegacyWrapper.WrappableComponent{#b;#e=this.attachShadow({mode:"open"});#_=!1;#P=!1;#j=!1;#F=!1;#z=void 0;#V=v.Workspace.WorkspaceImpl.instance();constructor(e){super(),this.#b=e,this.setAttribute("jslog",`${i.pane("headers").track({resize:!0})}`)}wasShown(){this.#b.addEventListener(h.NetworkRequest.Events.REMOTE_ADDRESS_CHANGED,this.#W,this),this.#b.addEventListener(h.NetworkRequest.Events.FINISHED_LOADING,this.#W,this),this.#b.addEventListener(h.NetworkRequest.Events.REQUEST_HEADERS_CHANGED,this.#W,this),this.#b.addEventListener(h.NetworkRequest.Events.RESPONSE_HEADERS_CHANGED,this.#B,this),this.#z=void 0,this.#W()}willHide(){this.#b.removeEventListener(h.NetworkRequest.Events.REMOTE_ADDRESS_CHANGED,this.#W,this),this.#b.removeEventListener(h.NetworkRequest.Events.FINISHED_LOADING,this.#W,this),this.#b.removeEventListener(h.NetworkRequest.Events.REQUEST_HEADERS_CHANGED,this.#W,this),this.#b.removeEventListener(h.NetworkRequest.Events.RESPONSE_HEADERS_CHANGED,this.#B,this)}#B(){this.#b.deleteAssociatedData(te),this.render()}#W(){this.render()}revealHeader(e,t){this.#z={section:e,header:t},this.render()}connectedCallback(){this.#e.adoptedStyleSheets=[ne],this.#V.addEventListener(v.Workspace.Events.UISourceCodeAdded,this.#G,this),this.#V.addEventListener(v.Workspace.Events.UISourceCodeRemoved,this.#G,this),u.Settings.Settings.instance().moduleSetting("persistence-network-overrides-enabled").addChangeListener(this.render,this)}disconnectedCallback(){this.#V.removeEventListener(v.Workspace.Events.UISourceCodeAdded,this.#G,this),this.#V.removeEventListener(v.Workspace.Events.UISourceCodeRemoved,this.#G,this),u.Settings.Settings.instance().moduleSetting("persistence-network-overrides-enabled").removeChangeListener(this.render,this)}#G(e){this.#Q()===e.data.url()&&this.render()}async render(){if(this.#b)return await f.write(()=>{de(le`
        ${this.#K()}
        ${this.#J()}
        ${this.#Y()}
        ${this.#Z()}
      `,this.#e,{host:this})})}#J(){return this.#b&&this.#b.earlyHintsHeaders&&0!==this.#b.earlyHintsHeaders.length?le`
      <devtools-request-headers-category
        @togglerawevent=${()=>{this.#_=!this.#_,this.render()}}
        .data=${{name:"early-hints-headers",title:ue(he.earlyHintsHeaders),headerCount:this.#b.earlyHintsHeaders.length,checked:void 0,additionalContent:void 0,forceOpen:"EarlyHints"===this.#z?.section,loggingContext:"early-hints-headers"}}
        aria-label=${ue(he.earlyHintsHeaders)}
      >
        ${this.#_?this.#X(this.#b.responseHeadersText,!0):le`
          <devtools-early-hints-header-section .data=${{request:this.#b,toReveal:this.#z}}></devtools-early-hints-header-section>
        `}
      </devtools-request-headers-category>
    `:t.nothing}#Y(){return this.#b?le`
      <devtools-request-headers-category
        @togglerawevent=${()=>{this.#_=!this.#_,this.render()}}
        .data=${{name:"response-headers",title:ue(he.responseHeaders),headerCount:this.#b.sortedResponseHeaders.length,checked:this.#b.responseHeadersText?this.#_:void 0,additionalContent:this.#ee(),forceOpen:"Response"===this.#z?.section,loggingContext:"response-headers"}}
        aria-label=${ue(he.responseHeaders)}
      >
        ${this.#_?this.#X(this.#b.responseHeadersText,!0):le`
          <devtools-response-header-section .data=${{request:this.#b,toReveal:this.#z}} jslog=${i.section("response-headers")}></devtools-response-header-section>
        `}
      </devtools-request-headers-category>
    `:t.nothing}#ee(){if(!this.#V.uiSourceCodeForURL(this.#Q()))return t.nothing;const e=u.Settings.Settings.instance().moduleSetting("persistence-network-overrides-enabled"),s=le`
      <devtools-icon class=${e.get()?"inline-icon dot purple":"inline-icon"} .data=${{iconName:"document",width:"16px",height:"16px"}}>
      </devtools-icon>`;return le`
      <x-link
          href="https://goo.gle/devtools-override"
          class="link devtools-link"
          jslog=${i.link("devtools-override").track({click:!0})}
      >
        <devtools-icon class="inline-icon" .data=${{iconName:"help",width:"16px",height:"16px"}}>
        </devtools-icon
      ></x-link>
      <x-link
          @click=${e=>{e.preventDefault();const t=this.#V.uiSourceCodeForURL(this.#Q());t&&(w.SourcesPanel.SourcesPanel.instance().showUISourceCode(t),w.SourcesPanel.SourcesPanel.instance().revealInNavigator(t))}}
          class="link devtools-link"
          title=${he.revealHeaderOverrides}
          jslog=${i.link("reveal-header-overrides").track({click:!0})}
      >
        ${s}${p.NetworkPersistenceManager.HEADERS_FILENAME}
      </x-link>
    `}#Q(){if(!this.#b)return l.DevToolsPath.EmptyUrlString;const e=p.NetworkPersistenceManager.NetworkPersistenceManager.instance().fileUrlFromNetworkUrl(this.#b.url(),!0);return e.substring(0,e.lastIndexOf("/"))+"/"+p.NetworkPersistenceManager.HEADERS_FILENAME}#Z(){if(!this.#b)return t.nothing;const e=this.#b.requestHeadersText();return le`
      <devtools-request-headers-category
        @togglerawevent=${()=>{this.#P=!this.#P,this.render()}}
        .data=${{name:"request-headers",title:ue(he.requestHeaders),headerCount:this.#b.requestHeaders().length,checked:e?this.#P:void 0,forceOpen:"Request"===this.#z?.section,loggingContext:"request-headers"}}
        aria-label=${ue(he.requestHeaders)}
      >
        ${this.#P&&e?this.#X(e,!1):le`
          <devtools-request-header-section .data=${{request:this.#b,toReveal:this.#z}} jslog=${i.section("request-headers")}></devtools-request-header-section>
        `}
      </devtools-request-headers-category>
    `}#X(s,r){const o=s.trim(),n=!(r?this.#j:this.#F)&&o.length>3e3,l=()=>{r?this.#j=!0:this.#F=!0,this.render()},d=e=>{if(!(r?this.#j:this.#F)){const t=new a.ContextMenu.ContextMenu(e);t.newSection().appendItem(ue(he.showMore),l,{jslogContext:"show-more"}),t.show()}};return le`
      <div class="row raw-headers-row" on-render=${e.Directives.nodeRenderedCallback(e=>{n&&e.addEventListener("contextmenu",d)})}>
        <div class="raw-headers">${n?o.substring(0,3e3):o}</div>
        ${n?le`
          <devtools-button
            .size=${"SMALL"}
            .variant=${"outlined"}
            @click=${l}
            jslog=${i.action("raw-headers-show-more").track({click:!0})}
          >${ue(he.showMore)}</devtools-button>
        `:t.nothing}
      </div>
    `}#K(){if(!this.#b)return t.nothing;const e=["status"];this.#b.statusCode<300||304===this.#b.statusCode?e.push("green-circle"):this.#b.statusCode<400?e.push("yellow-circle"):e.push("red-circle");let s="";this.#b.cachedInMemory()?s=ue(he.fromMemoryCache):this.#b.fromEarlyHints()?s=ue(he.fromEarlyHints):this.#b.fetchedViaServiceWorker?s=ue(he.fromServiceWorker):this.#b.redirectSourceSignedExchangeInfoHasNoErrors()?s=ue(he.fromSignedexchange):this.#b.webBundleInnerRequestInfo()?s=ue(he.fromWebBundle):this.#b.fromPrefetchCache()?s=ue(he.fromPrefetchCache):this.#b.cached()&&(s=ue(he.fromDiskCache)),s&&e.push("status-with-comment");const r=[this.#b.statusCode,this.#b.getInferredStatusText(),s].join(" ");return le`
      <devtools-request-headers-category
        .data=${{name:"general",title:ue(he.general),forceOpen:"General"===this.#z?.section,loggingContext:"general"}}
        aria-label=${ue(he.general)}
      >
      <div jslog=${i.section("general")}>
        ${this.#te(ue(he.requestUrl),this.#b.url())}
        ${this.#b.statusCode?this.#te(ue(he.requestMethod),this.#b.requestMethod):t.nothing}
        ${this.#b.statusCode?this.#te(ue(he.statusCode),r,e):t.nothing}
        ${this.#b.remoteAddress()?this.#te(ue(he.remoteAddress),this.#b.remoteAddress()):t.nothing}
        ${this.#b.referrerPolicy()?this.#te(ue(he.referrerPolicy),String(this.#b.referrerPolicy())):t.nothing}
      </div>
      </devtools-request-headers-category>
    `}#te(e,t,s){const i="General"===this.#z?.section&&e.toLowerCase()===this.#z?.header?.toLowerCase();return le`
      <div class="row ${i?"header-highlight":""}">
        <div class="header-name">${e}</div>
        <div
          class="header-value ${s?.join(" ")}"
          @copy=${()=>n.userMetrics.actionTaken(n.UserMetrics.Action.NetworkPanelCopyValue)}
        >${t}</div>
      </div>
    `}}class ve extends Event{static eventName="togglerawevent";constructor(){super(ve.eventName,{})}}class me extends HTMLElement{#e=this.attachShadow({mode:"open"});#se;#ie=u.UIString.LocalizedEmptyString;#re=void 0;#oe=void 0;#ne=void 0;#ae=void 0;#le="";connectedCallback(){this.#e.adoptedStyleSheets=[ne,m.checkboxStyles]}set data(e){this.#ie=e.title,this.#se=u.Settings.Settings.instance().createSetting("request-info-"+e.name+"-category-expanded",!0),this.#re=e.headerCount,this.#oe=e.checked,this.#ne=e.additionalContent,this.#ae=e.forceOpen,this.#le=e.loggingContext,this.#s()}#de(){this.dispatchEvent(new ve)}#s(){const e=!this.#se||this.#se.get()||this.#ae;de(le`
      <details ?open=${e} @toggle=${this.#ce}>
        <summary
          class="header"
          @keydown=${this.#he}
          jslog=${i.sectionHeader().track({click:!0}).context(this.#le)}
        >
          <div class="header-grid-container">
            <div>
              ${this.#ie}${void 0!==this.#re?le`<span class="header-count"> (${this.#re})</span>`:t.nothing}
            </div>
            <div class="hide-when-closed">
              ${void 0!==this.#oe?le`
                <label><input
                    type="checkbox"
                    .checked=${this.#oe}
                    @change=${this.#de}
                    jslog=${i.toggle("raw-headers").track({change:!0})}
                />${ue(he.raw)}</label>
              `:t.nothing}
            </div>
            <div class="hide-when-closed">${this.#ne}</div>
          </div>
        </summary>
        <slot></slot>
      </details>
    `,this.#e,{host:this})}#he(e){if(!e.target)return;const t=e.target.parentElement;if(!t)throw new Error("<details> element is not found for a <summary> element");switch(e.key){case"ArrowLeft":t.open=!1;break;case"ArrowRight":t.open=!0}}#ce(e){this.#se?.set(e.target.open)}}customElements.define("devtools-request-headers",pe),customElements.define("devtools-request-headers-category",me);var ge=Object.freeze({__proto__:null,Category:me,RequestHeadersView:pe,ToggleRawHeadersEvent:ve}),fe={cssText:`.code{font-family:var(--monospace-font-family);font-size:var(--monospace-font-size)}.issuers-list{display:flex;flex-direction:column;list-style-type:none;padding:0;margin:0}.status-icon{margin:0 0.3em 2px 0;vertical-align:middle}\n/*# sourceURL=${import.meta.resolve("./RequestTrustTokensView.css")} */\n`};const we=new CSSStyleSheet;we.replaceSync(fe.cssText);const{html:ye}=t,be={parameters:"Parameters",type:"Type",refreshPolicy:"Refresh policy",issuers:"Issuers",topLevelOrigin:"Top level origin",issuer:"Issuer",result:"Result",status:"Status",numberOfIssuedTokens:"Number of issued tokens",success:"Success",failure:"Failure",theOperationsResultWasServedFrom:"The operations result was served from cache.",theOperationWasFulfilledLocally:"The operation was fulfilled locally, no request was sent.",theKeysForThisPSTIssuerAreUnavailable:"The keys for this PST issuer are unavailable. The issuer may need to be registered via the Chrome registration process.",aClientprovidedArgumentWas:"A client-provided argument was malformed or otherwise invalid.",eitherNoInputsForThisOperation:"Either no inputs for this operation are available or the output exceeds the operations quota.",theServersResponseWasMalformedOr:"The servers response was malformed or otherwise invalid.",theOperationFailedForAnUnknown:"The operation failed for an unknown reason.",perSiteLimit:"Per-site issuer limit reached."},ke=d.i18n.registerUIStrings("panels/network/components/RequestTrustTokensView.ts",be),xe=d.i18n.getLocalizedString.bind(void 0,ke);class Se extends g.LegacyWrapper.WrappableComponent{#e=this.attachShadow({mode:"open"});#b;constructor(e){super(),this.#b=e}wasShown(){this.#b.addEventListener(h.NetworkRequest.Events.TRUST_TOKEN_RESULT_ADDED,this.render,this),this.render()}willHide(){this.#b.removeEventListener(h.NetworkRequest.Events.TRUST_TOKEN_RESULT_ADDED,this.render,this)}connectedCallback(){this.#e.adoptedStyleSheets=[we]}async render(){if(!this.#b)throw new Error("Trying to render a Trust Token report without providing data");t.render(ye`<devtools-report>
        ${this.#ue()}
        ${this.#pe()}
      </devtools-report>
    `,this.#e,{host:this})}#ue(){const e=this.#b.trustTokenParams();return e?ye`
      <devtools-report-section-header jslog=${i.pane("trust-tokens").track({resize:!0})}>${xe(be.parameters)}</devtools-report-section-header>
      ${$e(xe(be.type),e.operation.toString())}
      ${this.#ve(e)}
      ${this.#me(e)}
      ${this.#ge()}
      <devtools-report-divider></devtools-report-divider>
    `:t.nothing}#ve(e){return"Redemption"!==e.operation?t.nothing:$e(xe(be.refreshPolicy),e.refreshPolicy.toString())}#me(e){return e.issuers&&0!==e.issuers.length?ye`
      <devtools-report-key>${xe(be.issuers)}</devtools-report-key>
      <devtools-report-value>
        <ul class="issuers-list">
          ${e.issuers.map(e=>ye`<li>${e}</li>`)}
        </ul>
      </devtools-report-value>
    `:t.nothing}#ge(){const e=this.#b.trustTokenOperationDoneEvent();return e?ye`
      ${qe(xe(be.topLevelOrigin),e.topLevelOrigin)}
      ${qe(xe(be.issuer),e.issuerOrigin)}`:t.nothing}#pe(){const e=this.#b.trustTokenOperationDoneEvent();return e?ye`
      <devtools-report-section-header>${xe(be.result)}</devtools-report-section-header>
      <devtools-report-key>${xe(be.status)}</devtools-report-key>
      <devtools-report-value>
        <span>
          <devtools-icon class="status-icon"
            .data=${s=e.status,He(s)?Re:Ee}>
          </devtools-icon>
          <strong>${function(e){return He(e)?xe(be.success):xe(be.failure)}(e.status)}</strong>
          ${function(e){switch(e){case"Ok":return null;case"AlreadyExists":return xe(be.theOperationsResultWasServedFrom);case"FulfilledLocally":return xe(be.theOperationWasFulfilledLocally);case"InvalidArgument":return xe(be.aClientprovidedArgumentWas);case"ResourceExhausted":return xe(be.eitherNoInputsForThisOperation);case"BadResponse":return xe(be.theServersResponseWasMalformedOr);case"MissingIssuerKeys":return xe(be.theKeysForThisPSTIssuerAreUnavailable);case"FailedPrecondition":case"ResourceLimited":case"InternalError":case"Unauthorized":case"UnknownError":return xe(be.theOperationFailedForAnUnknown);case"SiteIssuerLimit":return xe(be.perSiteLimit)}}(e.status)}
        </span>
      </devtools-report-value>
      ${this.#fe(e)}
      <devtools-report-divider></devtools-report-divider>
      `:t.nothing;var s}#fe(e){return"Issuance"!==e.type?t.nothing:qe(xe(be.numberOfIssuedTokens),e.issuedTokenCount)}}const Re={color:"var(--icon-checkmark-green)",iconName:"check-circle",width:"16px",height:"16px"},Ee={color:"var(--icon-error)",iconName:"cross-circle-filled",width:"16px",height:"16px"};function He(e){return"Ok"===e||"AlreadyExists"===e||"FulfilledLocally"===e}function qe(e,s){return void 0===s?t.nothing:ye`
    <devtools-report-key>${e}</devtools-report-key>
    <devtools-report-value>${s}</devtools-report-value>
  `}function $e(e,t){return ye`
    <devtools-report-key>${e}</devtools-report-key>
    <devtools-report-value class="code">${t}</devtools-report-value>
  `}customElements.define("devtools-trust-token-report",Se);var Ce=Object.freeze({__proto__:null,RequestTrustTokensView:Se,statusConsideredSuccess:He}),Te={cssText:`:host{--icon-padding:4px;display:flex;flex-direction:column;height:100%}.header{display:flex;font-weight:bold;padding:calc(2 * var(--icon-padding)) var(--icon-padding);line-height:20px}.icon{margin:0 var(--icon-padding)}devtools-data-grid{height:100%}\n/*# sourceURL=${import.meta.resolve("./WebBundleInfoView.css")} */\n`};const Oe=new CSSStyleSheet;Oe.replaceSync(Te.cssText);const{mimeFromURL:Ne,fromMimeTypeOverride:Ae,fromMimeType:De}=u.ResourceType.ResourceType,{iconDataForResourceType:Le}=b,Ie={bundledResource:"Bundled resource"},Ue=d.i18n.registerUIStrings("panels/network/components/WebBundleInfoView.ts",Ie),Ve=d.i18n.getLocalizedString.bind(void 0,Ue);class Fe extends g.LegacyWrapper.WrappableComponent{#e=this.attachShadow({mode:"open"});#ke;#ye;constructor(e){super();const t=e.webBundleInfo();if(!t)throw new Error("Trying to render a Web Bundle info without providing data");this.#ke=t,this.#ye=e.parsedURL.lastPathComponent,this.setAttribute("jslog",`${i.pane("webbundle").track({resize:!0})}`)}connectedCallback(){this.#e.adoptedStyleSheets=[Oe]}async render(){r(s`
      <div class="header">
        <devtools-icon class="icon"
          .data=${{color:"var(--icon-default)",iconName:"bundle",width:"20px"}}>
        </devtools-icon>
        <span>${this.#ye}</span>
        <x-link href="https://web.dev/web-bundles/#explaining-web-bundles"
          jslog=${i.link("webbundle-explainer").track({click:!0})}>
          <devtools-icon class="icon"
            .data=${{color:"var(--icon-default)",iconName:"help",width:"16px"}}>
          </devtools-icon>
        </x-link>
      </div>
      <devtools-data-grid striped>
        <table>
          <tr><th id="url">${Ve(Ie.bundledResource)}</th></tr>
          ${this.#ke.resourceUrls?.map(e=>{const t=Ne(e)||null,i=Ae(t)||De(t),r=Le(i);return s`<tr><td>
                <div style="display: flex;">
                  <devtools-icon class="icon" .data=${{...r,width:"20px"}}>
                  </devtools-icon>
                  <span>${e}</span>
                </div></td></tr>`})}
        </table>
      </devtools-data-grid>`,this.#e,{host:this})}}customElements.define("devtools-web-bundle-info",Fe);var Pe=Object.freeze({__proto__:null,WebBundleInfoView:Fe});export{R as EditableSpan,V as HeaderSectionRow,G as RequestHeaderSection,ge as RequestHeadersView,Ce as RequestTrustTokensView,ae as ResponseHeaderSection,Pe as WebBundleInfoView};