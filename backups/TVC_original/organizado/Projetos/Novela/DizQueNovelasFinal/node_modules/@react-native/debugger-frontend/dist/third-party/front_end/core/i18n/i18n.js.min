import*as t from"../../third_party/i18n/i18n.js";import*as i from"../root/root.js";import*as e from"../platform/platform.js";let n=null;class o{locale;lookupClosestDevToolsLocale;constructor(t){this.lookupClosestDevToolsLocale=t.lookupClosestDevToolsLocale,"browserLanguage"===t.settingLanguage?this.locale=t.navigatorLanguage||"en-US":this.locale=t.settingLanguage,this.locale=this.lookupClosestDevToolsLocale(this.locale)}static instance(t={create:!1}){if(!n&&!t.create)throw new Error("No LanguageSelector instance exists yet.");return t.create&&(n=new o(t.data)),n}static removeInstance(){n=null}forceFallbackLocale(){this.locale="en-US"}languageIsSupportedByDevTools(t){return r(t,this.lookupClosestDevToolsLocale(t))}}function r(t,e){const i=new Intl.Locale(t),n=new Intl.Locale(e);return i.language===n.language}var a=Object.freeze({__proto__:null,DevToolsLocale:o,localeLanguagesMatch:r});function s(t){let e;return{format:i=>(e||(e=new Intl.NumberFormat(o.instance().locale,t)),function(t,e){const i=t.formatToParts(e);let n=!1;for(const t of i)"literal"===t.type&&(" "===t.value?(n=!0,t.value=" "):" "===t.value&&(n=!0));if(n)return i.map(t=>t.value).join("");const o=i.findIndex(t=>"unit"===t.type);return-1===o?i.map(t=>t.value).join(""):0===o?i[0].value+" "+i.slice(1).map(t=>t.value).join(""):i.slice(0,o).map(t=>t.value).join("")+" "+i.slice(o).map(t=>t.value).join("")}(e,i)),formatToParts:i=>(e||(e=new Intl.NumberFormat(o.instance().locale,t)),e.formatToParts(i))}}var l=Object.freeze({__proto__:null,defineFormatter:s});const c=s({style:"unit",unit:"byte",unitDisplay:"narrow",minimumFractionDigits:0,maximumFractionDigits:0}),u=s({style:"unit",unit:"kilobyte",unitDisplay:"narrow",minimumFractionDigits:1,maximumFractionDigits:1}),m=s({style:"unit",unit:"kilobyte",unitDisplay:"narrow",minimumFractionDigits:0,maximumFractionDigits:0}),g=s({style:"unit",unit:"megabyte",unitDisplay:"narrow",minimumFractionDigits:1,maximumFractionDigits:1}),f=s({style:"unit",unit:"megabyte",unitDisplay:"narrow",minimumFractionDigits:0,maximumFractionDigits:0});var p=Object.freeze({__proto__:null,bytesToString:t=>{if(t<1e3)return c.format(t);const e=t/1e3;if(e<100)return u.format(e);if(e<1e3)return m.format(e);const i=e/1e3;return i<100?g.format(i):f.format(i)},formatBytesToKb:t=>{const e=t/1e3;return e<100?u.format(e):m.format(e)}});const d=new t.I18n.I18n(["af","am","ar","as","az","be","bg","bn","bs","ca","cs","cy","da","de","el","en-GB","es-419","es","et","eu","fa","fi","fil","fr-CA","fr","gl","gu","he","hi","hr","hu","hy","id","is","it","ja","ka","kk","km","kn","ko","ky","lo","lt","lv","mk","ml","mn","mr","ms","my","ne","nl","no","or","pa","pl","pt-PT","pt","ro","ru","si","sk","sl","sq","sr-Latn","sr","sv","sw","ta","te","th","tr","uk","ur","uz","vi","zh-HK","zh-TW","zu","en-US","zh"],"en-US"),D=new Set(["en-US","zh"]);function S(t,e,i={}){return t.getLocalizedStringSetFor(o.instance().locale).getLocalizedString(e,i)}var y=Object.freeze({__proto__:null,deserializeUIString:function(t){return t?JSON.parse(t):{string:"",values:{}}},fetchAndRegisterLocaleData:async function(t,e=self.location.toString()){const n=fetch(function(t,e){const n=i.Runtime.getRemoteBase(e);if(n?.version&&!D.has(t))return"@HOST@/remote/serve_file/@VERSION@/core/i18n/locales/@LOCALE@.json".replace("@HOST@","devtools://devtools").replace("@VERSION@",n.version).replace("@LOCALE@",t);const o="./locales/@LOCALE@.json".replace("@LOCALE@",t);return new URL(o,import.meta.url).toString()}(t,e)).then(t=>t.json()),o=new Promise((t,e)=>window.setTimeout(()=>e(new Error("timed out fetching locale")),5e3)),r=await Promise.race([o,n]);d.registerLocaleData(t,r)},getAllSupportedDevToolsLocales:function(){return[...d.supportedLocales]},getFormatLocalizedString:function(t,e,i){const n=t.getLocalizedStringSetFor(o.instance().locale).getMessageFormatterFor(e),r=document.createElement("span");for(const t of n.getAst())if(1===t.type){const e=i[t.value];e&&r.append(e)}else"value"in t&&r.append(String(t.value));return r},getLazilyComputedLocalizedString:function(t,e,i={}){return()=>S(t,e,i)},getLocalizedLanguageRegion:function(t,e){const i=new Intl.Locale(t),{language:n,baseName:o}=i,r=n===new Intl.Locale(e.locale).language?"en":o,a=new Intl.DisplayNames([e.locale],{type:"language"}).of(n),s=new Intl.DisplayNames([r],{type:"language"}).of(n);let l="",c="";return i.region&&(l=` (${new Intl.DisplayNames([e.locale],{type:"region",style:"short"}).of(i.region)})`,c=` (${new Intl.DisplayNames([r],{type:"region",style:"short"}).of(i.region)})`),`${a}${l} - ${s}${c}`},getLocalizedString:S,hasLocaleDataForTest:function(t){return d.hasLocaleDataForTest(t)},lockedLazyString:function(t){return()=>t},lockedString:function(t){return t},lookupClosestSupportedDevToolsLocale:function(t){return d.lookupClosestSupportedLocale(t)},registerUIStrings:function(t,e){return d.registerFileStrings(t,e)},resetLocaleDataForTest:function(){d.resetLocaleDataForTest()},serializeUIString:function(t,e={}){const i={string:t,values:e};return JSON.stringify(i)}});const F=s({style:"unit",unit:"millisecond",unitDisplay:"narrow",minimumFractionDigits:0,maximumFractionDigits:0}),L=s({style:"unit",unit:"millisecond",unitDisplay:"long",minimumFractionDigits:0,maximumFractionDigits:0}),T=s({style:"unit",unit:"microsecond",unitDisplay:"narrow",minimumFractionDigits:0,maximumFractionDigits:0}),v=s({style:"unit",unit:"millisecond",unitDisplay:"narrow",minimumFractionDigits:2,maximumFractionDigits:2}),w=s({style:"unit",unit:"second",unitDisplay:"narrow",minimumFractionDigits:2,maximumFractionDigits:2}),h=s({style:"unit",unit:"minute",unitDisplay:"short",minimumFractionDigits:0,maximumFractionDigits:1}),z=s({style:"unit",unit:"hour",unitDisplay:"short",minimumFractionDigits:0,maximumFractionDigits:1}),k=s({style:"unit",unit:"day",unitDisplay:"long",minimumFractionDigits:0,maximumFractionDigits:1});function x(t,e){if(!isFinite(t))return"-";if(e&&t<.1)return T.format(1e3*t);if(e&&t<1e3)return v.format(t);if(t<1e3)return F.format(t);const i=t/1e3;if(i<60)return w.format(i);const n=i/60;if(n<60)return h.format(n);const o=n/60;if(o<24)return z.format(o);const r=o/24;return k.format(r)}const _=new Map,b=new Map;var I=Object.freeze({__proto__:null,formatMicroSecondsAsMillisFixed:function(t){const i=e.Timing.microSecondsToMilliSeconds(t);return F.format(i)},formatMicroSecondsAsMillisFixedExpanded:function(t){const i=e.Timing.microSecondsToMilliSeconds(t);return L.format(i)},formatMicroSecondsAsSeconds:function(t){const i=e.Timing.microSecondsToMilliSeconds(t),n=e.Timing.milliSecondsToSeconds(i);return w.format(n)},formatMicroSecondsTime:function(t){return x(e.Timing.microSecondsToMilliSeconds(t),!0)},formatPartsMicroSecondsAsMillisFixed:function(t){const i=e.Timing.microSecondsToMilliSeconds(t);return F.formatToParts(i)},formatPartsMicroSecondsAsSeconds:function(t){const i=e.Timing.microSecondsToMilliSeconds(t),n=e.Timing.milliSecondsToSeconds(i);return w.formatToParts(n)},millisToString:x,preciseMillisToString:function(t,e=0){let i=_.get(e);return i||(i=s({style:"unit",unit:"millisecond",unitDisplay:"narrow",minimumFractionDigits:e,maximumFractionDigits:e}),_.set(e,i)),i.format(t)},preciseSecondsToString:function(t,e=0){let i=b.get(e);return i||(i=s({style:"unit",unit:"second",unitDisplay:"narrow",minimumFractionDigits:e,maximumFractionDigits:e}),b.set(e,i)),i.format(t)},secondsToString:function(t,e){return isFinite(t)?x(1e3*t,e):"-"}});export{p as ByteUtilities,a as DevToolsLocale,l as NumberFormatter,I as TimeUtilities,y as i18n};