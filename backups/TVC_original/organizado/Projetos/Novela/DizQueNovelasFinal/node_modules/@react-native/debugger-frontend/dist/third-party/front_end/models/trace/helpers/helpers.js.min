import*as e from"../../../core/platform/platform.js";import*as t from"../../../core/common/common.js";import*as n from"../types/types.js";let r=null;class i{#e=[];#t=[];static activate(e){r=e}static createAndActivate(e){const t=new i(e);return i.activate(t),t}static getActiveManager(){if(!r)throw new Error("Attempted to get a SyntheticEventsManager without initializing");return r}static reset(){r=null}static registerSyntheticEvent(e){try{return i.getActiveManager().registerSyntheticEvent(e)}catch{return e}}constructor(e){this.#t=e}registerSyntheticEvent(e){const t=this.#t.indexOf(e.rawSourceEvent);if(t<0)throw new Error("Attempted to register a synthetic event paired to an unknown raw event.");const n=e;return this.#e[t]=n,n}syntheticEventForRawEventIndex(e){const t=this.#e.at(e);if(!t)throw new Error(`Attempted to get a synthetic event from an unknown raw event index: ${e}`);return t}getSyntheticTraces(){return this.#e}getRawTraceEvents(){return this.#t}}var a=Object.freeze({__proto__:null,SyntheticEventsManager:i});const o=e=>n.Timing.Micro(1e3*e),s=e=>n.Timing.Milli(1e3*e),c=e=>n.Timing.Milli(e/1e3);function l(e){return{startTime:e.ts,endTime:e.ts+(e.dur??0),duration:e.dur||0}}function u(e,t){const n=e.ts;return n<=t.max&&t.min<=n+(e.dur??0)}var d=Object.freeze({__proto__:null,boundsIncludeTimeRange:function(e){const{min:t,max:n}=e.bounds,{min:r,max:i}=e.timeRange;return t<=i&&n>=r},eventIsInBounds:u,eventTimingsMicroSeconds:l,eventTimingsMilliSeconds:function(e){return{startTime:e.ts/1e3,endTime:(e.ts+(e.dur??0))/1e3,duration:(e.dur||0)/1e3}},expandWindowByPercentOrToOneMillisecond:function(e,t,r){let i=e.min-e.range*(r/100)/2,a=e.max+e.range*(r/100)/2;if(a-i<1e3){const t=(e.min+e.max)/2;i=t-500,a=t+500}return i=Math.max(i,t.min),a=Math.min(a,t.max),{min:n.Timing.Micro(i),max:n.Timing.Micro(a),range:n.Timing.Micro(a-i)}},microToMilli:c,microToSeconds:e=>n.Timing.Seconds(e/1e3/1e3),milliToMicro:o,secondsToMicro:e=>o(s(e)),secondsToMilli:s,timeStampForEventAdjustedByClosestNavigation:function(e,t,r,i){let a=e.ts-t.min;if(e.args?.data?.navigationId){const t=r.get(e.args.data.navigationId);t&&(a=e.ts-t.ts)}else if(e.args?.data?.frame){const t=g(e,e.args.data.frame,i);t&&(a=e.ts-t.ts)}return n.Timing.Micro(a)},timestampIsInBounds:function(e,t){return t>=e.min&&t<=e.max},traceWindowFromEvent:function(e){return{min:e.ts,max:n.Timing.Micro(e.ts+(e.dur??0)),range:e.dur??n.Timing.Micro(0)}},traceWindowFromMicroSeconds:function(e,t){return{min:e,max:t,range:n.Timing.Micro(t-e)}},traceWindowFromMilliSeconds:function(e,t){return{min:o(e),max:o(t),range:n.Timing.Micro(o(t)-o(e))}},traceWindowMicroSecondsToMilliSeconds:function(e){return{min:c(e.min),max:c(e.max),range:c(e.range)}},traceWindowMilliSeconds:function(e){return{min:c(e.min),max:c(e.max),range:c(e.range)}},windowFitsInsideBounds:function(e){return e.window.min>=e.bounds.min&&e.window.max<=e.bounds.max},windowsEqual:function(e,t){return e.min===t.min&&e.max===t.max}});function m(e){if(e.args?.data?.stackTrace)return e.args.data.stackTrace;if(e.args?.stackTrace)return e.args.stackTrace;if(n.Events.isUpdateLayoutTree(e))return e.args.beginData?.stackTrace||null;if(n.Events.isLayout(e))return e.args.beginData.stackTrace??null;if(n.Events.isFunctionCall(e)){const t=e.args.data;if(!t)return null;const{columnNumber:n,lineNumber:r,url:i,scriptId:a,functionName:s}=t;return void 0===r||void 0===s||void 0===n||void 0===a||void 0===i?null:[{columnNumber:n,lineNumber:r,url:i,scriptId:a,functionName:s}]}if(n.Events.isProfileCall(e)){const t=e.callFrame;if(!t)return null;const{columnNumber:n,lineNumber:r,url:i,scriptId:a,functionName:s}=t;return void 0===r||void 0===s||void 0===n||void 0===a||void 0===i?null:[{columnNumber:n,lineNumber:r,url:i,scriptId:a,functionName:s}]}return null}function h(e,t){const r=e.ts,i=t.ts;if(r<i)return-1;if(r>i)return 1;const a=r+(e.dur??0),s=i+(t.dur??0);return a>s?-1:a<s?1:n.Events.isProfileCall(e)&&!n.Events.isProfileCall(t)?-1:n.Events.isProfileCall(t)&&!n.Events.isProfileCall(e)?1:0}function f(e){e.sort(h)}function p(e,t){const n=[];let r=0,i=0;for(;r<e.length&&i<t.length;){const a=e[r],s=t[i],o=h(a,s);o<=0&&(n.push(a),r++),1===o&&(n.push(s),i++)}for(;r<e.length;)n.push(e[r++]);for(;i<t.length;)n.push(t[i++]);return n}function g(t,n,r){const i=r.get(n);if(!i||""===n)return null;const a=e.ArrayUtilities.nearestIndexFromEnd(i,e=>e.ts<=t.ts);return null===a?null:i[a]}function v(e){return e.id??e.id2?.global??e.id2?.local}function S(e,t,r,i,a,s){return{cat:"",name:"ProfileCall",nodeId:e.id,args:{},ph:"X",pid:a,tid:s,ts:i,dur:n.Timing.Micro(0),callFrame:e.callFrame,sampleIndex:r,profileId:t}}function T(t){const n=new Map;for(const r of t){const t=k(r);if(void 0===t)continue;const i=e.MapUtilities.getWithDefault(n,t,()=>({begin:null,end:null,instant:[]})),a="b"===r.ph,s="e"===r.ph,o="n"===r.ph;a?i.begin=r:s?i.end=r:o&&(i.instant||(i.instant=[]),i.instant.push(r))}return n}function k(e){const t=v(e);return t&&`${e.cat}:${t}:${e.name}`}function E(e,t){const r=[];for(const[s,o]of e.entries()){const c=o.begin,l=o.end,u=o.instant;if(!c||!l&&!u)continue;const m={beginEvent:c,endEvent:l,instantEvents:u};function a(e){const t=!!e.instantEvents&&e.instantEvents.some(e=>s===k(e)),n=!!e.endEvent&&s===k(e.endEvent);return Boolean(s)&&(t||n)}if(!a(m))continue;const d=l||c,h=i.registerSyntheticEvent({rawSourceEvent:m.beginEvent,cat:d.cat,ph:d.ph,pid:d.pid,tid:d.tid,id:s,name:c.name,dur:n.Timing.Micro(d.ts-c.ts),ts:c.ts,args:{data:m}});h.dur<0||(t?.(h),r.push(h))}return r.sort((e,t)=>e.ts-t.ts)}function y(e){const t={...e};return t.lineNumber=e.lineNumber&&e.lineNumber-1,t.columnNumber=e.columnNumber&&e.columnNumber-1,t}function b(e){return"JSRoot"===e.name&&"toplevel"===e.cat||e.cat.includes("disabled-by-default-devtools.timeline")&&"RunTask"===e.name}function I(t,n){let r=e.ArrayUtilities.upperBound(t,n,(e,t)=>e-t.ts)-1;for(;r>0&&!b(t[r]);)r--;return Math.max(r,0)}const M=new Map;function C(e){return e.args?"beginData"in e.args?e.args.beginData.sampleTraceId??null:e.args?.sampleTraceId??e.args?.data?.sampleTraceId??null:null}const w=new Set(["AbortPostTaskCallback","Animation","AsyncTask","v8.deserializeOnBackground","BeginFrame","BeginMainThreadFrame","v8.produceModuleCache","v8.produceCache","CancelAnimationFrame","CancelIdleCallback","v8.compile","V8.CompileCode","V8.CompileModule","Commit","CompositeLayers","ComputeIntersections","ConsoleTime","TimeStamp","CppGC.IncrementalSweep","DoDecrypt","DoDecryptReply","DoDigest","DoDigestReply","DoEncrypt","DoEncryptReply","DoSign","DoSignReply","DoVerify","DoVerifyReply","Decode Image","DrawFrame","EmbedderCallback","v8.evaluateModule","EvaluateScript","EventDispatch","EventTiming","V8.FinalizeDeserialization","FireAnimationFrame","FireIdleCallback","FrameStartedLoading","FunctionCall","GCEvent","BlinkGC.AtomicPhase","GPUTask","HandlePostMessage","HitTest","InvalidateLayout","JSSample","Layerize","Layout","LayoutShift","MajorGC","MarkDOMContent","firstPaint","firstContentfulPaint","largestContentfulPaint::Candidate","MarkLoad","MinorGC","V8.OptimizeCode","Paint","PaintImage","PaintSetup","ParseAuthorStyleSheet","ParseHTML","PrePaint","ProfileCall","Program","RasterTask","RequestAnimationFrame","RequestIdleCallback","RequestMainThreadFrame","ResourceFinish","ResourceReceivedData","ResourceReceiveResponse","ResourceSendRequest","ResourceWillSendRequest","RunMicrotasks","RunPostTaskCallback","RunTask","SchedulePostMessage","SchedulePostTaskCallback","ScheduleStyleRecalculation","ScrollLayer","CpuProfiler::StartProfiling","v8.parseOnBackground","v8.parseOnBackgroundParsing","v8.parseOnBackgroundWaiting","SyntheticLayoutShift","SyntheticLayoutShiftCluster","TimerFire","TimerInstall","TimerRemove","UpdateLayer","UpdateLayerTree","UpdateLayoutTree","UserTiming","V8Console::runTask","v8.wasm.cachedModule","v8.wasm.compiledModule","v8.wasm.moduleCacheHit","v8.wasm.moduleCacheInvalid","v8.wasm.streamFromResponseCallback","WebSocketCreate","WebSocketDestroy","WebSocketReceive","WebSocketReceiveHandshakeResponse","WebSocketSend","WebSocketSendHandshakeRequest","XHRLoad","XHRReadyStateChange"]);var N=Object.freeze({__proto__:null,VISIBLE_TRACE_EVENT_TYPES:w,activeURLForFrameAtTime:function(e,t,n){const r=n.get(e);if(!r)return null;for(const e of r.values())for(const n of e)if(!(n.window.min>t||n.window.max<t))return n.frame.url;return null},addEventToProcessThread:function(e,t){const{tid:n,pid:r}=e;let i=t.get(r);i||(i=new Map);let a=i.get(n);a||(a=[]),a.push(e),i.set(e.tid,a),t.set(e.pid,i)},createMatchedSortedSyntheticEvents:function(e,t){return E(T(e),t)},createSortedSyntheticEvents:E,eventContainsTimestamp:function(e,t){return e.ts<=t&&e.ts+(e.dur||0)>=t},eventHasCategory:function(e,t){let n=M.get(e.cat);return n||(n=new Set(e.cat.split(",")||[])),n.has(t)},eventTimeComparator:h,extractId:v,extractOriginFromTrace:function(e){const n=t.ParsedURL.ParsedURL.fromString(e);return n?n.host.startsWith("www.")?n.host.slice(4):n.host:null},extractSampleTraceId:C,findNextEventAfterTimestamp:function(t,n){const r=e.ArrayUtilities.nearestIndexFromBeginning(t,e=>n<e.ts);return null===r?null:t[r]},findPreviousEventBeforeTimestamp:function(t,n){const r=e.ArrayUtilities.nearestIndexFromEnd(t,e=>e.ts<n);return null===r?null:t[r]},findUpdateLayoutTreeEvents:function(e,t,r){const i=[];for(let a=I(e,t);a<e.length;a++){const t=e[a];n.Events.isUpdateLayoutTree(t)&&(t.ts>=(r||1/0)||i.push(t))}return i},forEachEvent:function(e,t){const r=t.startTime??n.Timing.Micro(0),i=t.endTime||n.Timing.Micro(1/0),a=!1!==t.ignoreAsyncEvents,s=[];for(let o=I(e,r);o<e.length;o++){const c=e[o],u=l(c);if(u.endTime<r)continue;if(u.startTime>i)break;if(a&&n.Events.isPhaseAsync(c.ph)||n.Events.isFlowPhase(c.ph))continue;let m=s.at(-1),d=m?l(m).endTime:null;for(;m&&d&&d<=u.startTime;)s.pop(),t.onEndEvent(m),m=s.at(-1),d=m?l(m).endTime:null;t.eventFilter&&!t.eventFilter(c)||(u.duration?(t.onStartEvent(c),s.push(c)):t.onInstantEvent&&t.onInstantEvent(c))}for(;s.length;){const e=s.pop();e&&t.onEndEvent(e)}},frameIDForEvent:function(e){return e.args&&"beginData"in e.args&&"object"==typeof e.args.beginData&&null!==e.args.beginData&&"frame"in e.args.beginData&&"string"==typeof e.args.beginData.frame?e.args.beginData.frame:e.args?.data?.frame?e.args.data.frame:null},getNavigationForTraceEvent:g,getZeroIndexedLineAndColumnForEvent:function(e){const t=function(e){if(!e.args?.data)return{lineNumber:void 0,columnNumber:void 0};let t,n;return"lineNumber"in e.args.data&&"number"==typeof e.args.data.lineNumber&&(t=e.args.data.lineNumber),"columnNumber"in e.args.data&&"number"==typeof e.args.data.columnNumber&&(n=e.args.data.columnNumber),{lineNumber:t,columnNumber:n}}(e),{lineNumber:n,columnNumber:r}=t;switch(e.name){case"FunctionCall":case"EvaluateScript":case"v8.compile":case"v8.produceCache":return{lineNumber:"number"==typeof n?n-1:void 0,columnNumber:"number"==typeof r?r-1:void 0};case"ProfileCall":{const t=e.callFrame;return{lineNumber:"number"==typeof n?t.lineNumber-1:void 0,columnNumber:"number"==typeof r?t.columnNumber-1:void 0}}default:return t}},getZeroIndexedStackTraceForEvent:function(e){const t=m(e);return t?t.map(t=>{switch(e.name){case"ScheduleStyleRecalculation":case"InvalidateLayout":case"FunctionCall":case"Layout":case"UpdateLayoutTree":return y(t);default:if(n.Events.isUserTiming(e)||n.Extensions.isSyntheticExtensionEntry(e))return y(t)}return t}):null},isMatchingCallFrame:function(e,t){return e.columnNumber===t.columnNumber&&e.lineNumber===t.lineNumber&&String(e.scriptId)===t.scriptId&&e.url===t.url&&e.functionName===t.functionName},isTopLevelEvent:b,makeProfileCall:S,makeZeroBasedCallFrame:y,matchEvents:T,mergeEventsInOrder:p,sortTraceEventsInPlace:f,stackTraceInEvent:m});let F=0;const P=()=>++F,x=()=>({roots:new Set,maxDepth:0}),R=(e,t)=>({entry:e,id:t,parent:null,children:[],depth:0});function D(e,t){const r=new Map,i=[];F=-1;const a=x();for(let s=0;s<e.length;s++){const o=e[s];if(t&&!t.filter.has(o.name))continue;const c=o.dur||0,l=P(),u=R(o,l);if(0===i.length){a.roots.add(u),u.selfTime=n.Timing.Micro(c),i.push(u),a.maxDepth=Math.max(a.maxDepth,i.length),r.set(o,u);continue}const m=i.at(-1);if(void 0===m)throw new Error("Impossible: no parent node found in the stack");const d=m.entry,h=o.ts,f=d.ts,g=h+c,p=f+(d.dur||0);if(h<f)throw new Error("Impossible: current event starts before the parent event");h>=p?(i.pop(),s--,F--):g>p||(u.depth=i.length,u.parent=m,m.children.push(u),u.selfTime=n.Timing.Micro(c),void 0!==m.selfTime&&(m.selfTime=n.Timing.Micro(m.selfTime-(o.dur||0))),i.push(u),a.maxDepth=Math.max(a.maxDepth,i.length),r.set(o,u))}return{tree:a,entryToNode:r}}function J(e,t,r,i,a,s){if(!a||(o=a,u(t.entry,o))){var o;if(void 0!==s&&n.Timing.Micro(t.entry.ts+n.Timing.Micro(t.entry.dur??0))<s)return;r(t.entry);for(const n of t.children)J(e,n,r,i,a,s);i(t.entry)}}function _(e){const t=[];for(const n of e){const e=n.ts,r=n.ts+(n.dur??0);let i=t.at(-1);if(void 0===i){t.push(n);continue}let a=i.ts+(i.dur??0);for(;t.length&&e>=a&&(t.pop(),i=t.at(-1),void 0!==i);)a=i.ts+(i.dur??0);if(t.length&&r>a)return!1;t.push(n)}return!0}var A=Object.freeze({__proto__:null,canBuildTreesFromEvents:_,makeEmptyTraceEntryNode:R,makeEmptyTraceEntryTree:x,makeTraceEntryNodeId:P,treify:D,walkEntireTree:function(e,t,n,r,i,a){for(const s of t.roots)J(e,s,n,r,i,a)},walkTreeFromEntry:function(e,t,n,r){const i=e.get(t);i&&J(e,i,n,r)}}),B=Object.freeze({__proto__:null,buildTrackDataFromExtensionEntries:function(t,n,r){const i=new Map;for(const n of t){const t=n.args.trackGroup||`track-name-${n.args.track}`,r=e.MapUtilities.getWithDefault(i,t,()=>({name:n.args.trackGroup||n.args.track,isTrackGroup:Boolean(n.args.trackGroup),entriesByTrack:{[n.args.track]:[]}}));r.entriesByTrack[n.args.track]||(r.entriesByTrack[n.args.track]=[]),r.entriesByTrack[n.args.track].push(n)}for(const e of i.values()){for(const t of Object.values(e.entriesByTrack))if(f(t),_(t))for(const[e,n]of D(t).entryToNode)r.set(e,n);n.push(e)}return{extensionTrackData:n,entryToNode:r}}});const L=new Set(["non_blocking","dynamically_injected_non_blocking","potentially_blocking"]),O=new Set(["VeryHigh","High","Medium"]),U=new Set([200,203,206]),W=new Set(["Font","Image","Media","Script","Stylesheet"]),j=["localhost","127.0.0.1"];var G=Object.freeze({__proto__:null,CACHEABLE_STATUS_CODES:U,NON_NETWORK_SCHEMES:["blob","data","intent","file","filesystem","chrome-extension"],STATIC_RESOURCE_TYPES:W,isSyntheticNetworkRequestEventRenderBlocking:function(e){return!L.has(e.args.data.renderBlocking)},isSyntheticNetworkRequestHighPriority:function(e){return O.has(e.args.data.priority)},isSyntheticNetworkRequestLocalhost:function(e){try{const t=new URL(e.args.data.url).hostname;return j.includes(t)||t.endsWith(".localhost")}catch{return!1}},parseCacheControl:function(e){if(!e)return null;const t=e.split(",").map(e=>e.trim()),n={};for(const e of t){const[t,r]=e.split("=").map(e=>e.trim());switch(t){case"max-age":{const e=parseInt(r,10);isNaN(e)||(n["max-age"]=e);break}case"no-cache":n["no-cache"]=!0;break;case"no-store":n["no-store"]=!0;break;case"must-revalidate":n["must-revalidate"]=!0;break;case"private":n.private=!0}}return n}}),H=Object.freeze({__proto__:null,SamplesIntegrator:class e{#n=[];#r=[];#i;#a;#s=[];#o=!1;#c;#l=new Map;#u;#m;jsSampleEvents=[];constructor(e,t,r,i,a){this.#c=e,this.#a=i,this.#i=r,this.#u=a||n.Configuration.defaults(),this.#m=t}buildProfileCalls(e){const t=p(e,this.callsFromProfileSamples()),r=[];for(let e=0;e<t.length;e++){const i=t[e];if("I"===i.ph&&!C(i))continue;if(0===r.length){if(n.Events.isProfileCall(i)){this.#d(i);continue}r.push(i),this.#h(i);continue}const a=r.at(-1);void 0!==a&&(i.ts>=a.ts+(a.dur||0)?(this.#f(a),r.pop(),e--):n.Events.isProfileCall(i)?this.#d(i,a):(this.#h(i),r.push(i)))}for(;r.length;){const e=r.pop();e&&this.#f(e)}return f(this.jsSampleEvents),this.#n}#h(e){"RunMicrotasks"!==e.name&&"RunTask"!==e.name||(this.#s=[],this.#g(0,e.ts),this.#o=!1),this.#o&&(this.#g(this.#s.pop()||0,e.ts),this.#o=!1),this.#p(e),this.#s.push(this.#r.length)}#d(e,t){if(t&&n.Events.isJSInvocationEvent(t)||this.#o)this.#p(e);else if(n.Events.isProfileCall(e)&&0===this.#r.length){this.#o=!0;const t=this.#r.length;this.#p(e),this.#s.push(t)}}#f(e){const t=n.Timing.Micro(e.ts+(e.dur??0));this.#g(this.#s.pop()||0,t)}callsFromProfileSamples(){const e=this.#c.samples,t=this.#c.timestamps;if(!e)return[];const r=[];let i;for(let a=0;a<e.length;a++){const e=this.#c.nodeByIndex(a),s=o(n.Timing.Milli(t[a]));if(!e)continue;const c=S(e,this.#m,a,s,this.#i,this.#a);if(r.push(c),this.#u.debugMode){const e=this.#c.traceIds?.[a];this.jsSampleEvents.push(this.#v(c,s,e))}e.id===this.#c.gcNode?.id&&i?this.#l.set(c,i):i=e}return r}#T(e,t){let n=this.#c.nodeById(e.nodeId);const r=n?.id===this.#c.gcNode?.id;if(r&&(n=this.#l.get(e)||null),!n)return[];const i=new Array(n.depth+1+Number(r));let a=i.length-1;for(r&&(i[a--]=e);n;)i[a--]=S(n,e.profileId,e.sampleIndex,t??e.ts,this.#i,this.#a),n=n.parent;return i}#E(e,t){const n=this.#c.traceIds?.[e],r=n&&this.#c.nodeById(n),i=r&&S(r,this.#m,-1,t,this.#i,this.#a);return i?(this.#u.debugMode&&this.jsSampleEvents.push(this.#v(i,t,e)),this.#T(i)):null}#p(t){let r=this.#r;n.Events.isProfileCall(t)&&(r=this.#T(t));const i=C(t),a=i&&this.#E(i,t.ts);a&&(r=a),e.filterStackFrames(r,this.#u);const s=t.ts+(t.dur||0),o=Math.min(r.length,this.#r.length);let c;for(c=this.#s.at(-1)||0;c<o;++c){const t=r[c].callFrame,i=this.#r[c].callFrame;if(!e.framesAreEqual(t,i))break;this.#r[c].dur=n.Timing.Micro(Math.max(this.#r[c].dur||0,s-this.#r[c].ts))}for(this.#g(c,t.ts);c<r.length;++c){const e=r[c];e.nodeId!==this.#c.programNode?.id&&e.nodeId!==this.#c.root?.id&&e.nodeId!==this.#c.idleNode?.id&&e.nodeId!==this.#c.gcNode?.id&&(this.#r.push(e),this.#n.push(e))}}#g(e,t){if(this.#s.length){const n=this.#s.at(-1);n&&e<n&&(console.error(`Child stack is shallower (${e}) than the parent stack (${n}) at ${t}`),e=n)}this.#r.length<e&&(console.error(`Trying to truncate higher than the current stack size at ${t}`),e=this.#r.length);for(let e=0;e<this.#r.length;++e)this.#r[e].dur=n.Timing.Micro(Math.max(t-this.#r[e].ts,0));this.#r.length=e}#v(e,t,r){return{name:"JSSample",cat:"devtools.timeline",args:{data:{traceId:r,stackTrace:this.#T(e).map(e=>e.callFrame)}},ph:"I",ts:t,dur:n.Timing.Micro(0),pid:this.#i,tid:this.#a}}static framesAreEqual(e,t){return e.scriptId===t.scriptId&&e.functionName===t.functionName&&e.lineNumber===t.lineNumber}static showNativeName(t,n){return n&&Boolean(e.nativeGroup(t))}static nativeGroup(e){return e.startsWith("Parse")?"Parse":e.startsWith("Compile")||e.startsWith("Recompile")?"Compile":null}static isNativeRuntimeFrame(e){return"native V8Runtime"===e.url}static filterStackFrames(t,n){if(n.showAllEvents)return;let r=null,i=0;for(let a=0;a<t.length;++a){const s=t[a].callFrame,o=e.isNativeRuntimeFrame(s);if(o&&!e.showNativeName(s.functionName,n.includeRuntimeCallStats))continue;const c=o?e.nativeGroup(s.functionName):null;r&&r===c||(r=c,t[i++]=t[a])}t.length=i}static createFakeTraceFromCpuProfile(e,t){const r=[],i=`Thread ${t}`;return a("TracingStartedInPage",{data:{sessionId:"1"}},0,0,"M"),a("thread_name",{name:i},0,0,"M","__metadata"),e?(a("JSRoot",{},e.startTime,e.endTime-e.startTime,"X","toplevel"),a("CpuProfile",{data:{cpuProfile:e}},e.endTime,0,"X"),{traceEvents:r,metadata:{dataOrigin:"CPUProfile"}}):{traceEvents:r,metadata:{}};function a(e,i,a,s,o,c){const l={cat:c||"disabled-by-default-devtools.timeline",name:e,ph:o||"X",pid:n.Events.ProcessID(1),tid:t,ts:n.Timing.Micro(a),args:i};return s&&(l.dur=n.Timing.Micro(s)),r.push(l),l}}}});export{B as Extensions,G as Network,H as SamplesIntegrator,a as SyntheticEvents,d as Timing,N as Trace,A as TreeHelpers};