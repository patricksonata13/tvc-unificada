"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=createDevMiddleware;var _InspectorProxy=_interopRequireDefault(require("./inspector-proxy/InspectorProxy")),_openDebuggerMiddleware=_interopRequireDefault(require("./middleware/openDebuggerMiddleware")),_DefaultBrowserLauncher=_interopRequireDefault(require("./utils/DefaultBrowserLauncher")),_debuggerFrontend=_interopRequireDefault(require("@react-native/debugger-frontend")),_connect=_interopRequireDefault(require("connect")),_path=_interopRequireDefault(require("path")),_serveStatic=_interopRequireDefault(require("serve-static"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function createDevMiddleware({projectRoot:e,serverBaseUrl:r,logger:t,unstable_browserLauncher:n=_DefaultBrowserLauncher.default,unstable_eventReporter:o,unstable_experiments:a={},unstable_customInspectorMessageHandler:u,unstable_trackInspectorProxyEventLoopPerf:i=!1}){const s=getExperiments(a),l=createWrappedEventReporter(o,t),d=new _InspectorProxy.default(e,r,l,s,t,u,i);return{middleware:(0,_connect.default)().use("/open-debugger",(0,_openDebuggerMiddleware.default)({serverBaseUrl:r,inspectorProxy:d,browserLauncher:n,eventReporter:l,experiments:s,logger:t})).use("/debugger-frontend/embedder-static/embedderScript.js",(e,r)=>{r.setHeader("Content-Type","application/javascript"),r.end("")}).use("/debugger-frontend",(0,_serveStatic.default)(_path.default.join(_debuggerFrontend.default),{fallthrough:!1})).use((...e)=>d.processRequest(...e)),websocketEndpoints:d.createWebSocketListeners()}}function getExperiments(e){return{enableOpenDebuggerRedirect:e.enableOpenDebuggerRedirect??!1,enableNetworkInspector:e.enableNetworkInspector??!1,enableStandaloneFuseboxShell:e.enableStandaloneFuseboxShell??!1}}function createWrappedEventReporter(e,r){return{logEvent(t){switch(t.type){case"profiling_target_registered":r?.info("Profiling build target '%s' registered for debugging",t.appId??"unknown");break;case"fusebox_console_notice":r?.info("[1m[7mðŸ’¡ JavaScript logs have moved![22m They can now be viewed in React Native DevTools. Tip: Type [1mj[22m in the terminal to open (requires Google Chrome or Microsoft Edge).[27m")}e?.logEvent(t)}}}