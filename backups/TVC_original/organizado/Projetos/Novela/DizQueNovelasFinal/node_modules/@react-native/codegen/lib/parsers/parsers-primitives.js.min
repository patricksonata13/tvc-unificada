"use strict";const{throwIfArrayElementTypeAnnotationIsUnsupported:throwIfArrayElementTypeAnnotationIsUnsupported,throwIfPartialNotAnnotatingTypeParameter:throwIfPartialNotAnnotatingTypeParameter,throwIfPartialWithMoreParameter:throwIfPartialWithMoreParameter}=require("./error-utils"),{ParserError:ParserError,UnsupportedTypeAnnotationParserError:UnsupportedTypeAnnotationParserError,UnsupportedUnionTypeAnnotationParserError:UnsupportedUnionTypeAnnotationParserError}=require("./errors"),{assertGenericTypeAnnotationHasExactlyOneTypeParameter:assertGenericTypeAnnotationHasExactlyOneTypeParameter,translateFunctionTypeAnnotation:translateFunctionTypeAnnotation,unwrapNullable:unwrapNullable,wrapNullable:wrapNullable}=require("./parsers-commons"),{nullGuard:nullGuard}=require("./parsers-utils"),{isModuleRegistryCall:isModuleRegistryCall}=require("./utils");function emitBoolean(e){return wrapNullable(e,{type:"BooleanTypeAnnotation"})}function emitInt32(e){return wrapNullable(e,{type:"Int32TypeAnnotation"})}function emitInt32Prop(e,t){return{name:e,optional:t,typeAnnotation:{type:"Int32TypeAnnotation"}}}function emitNumber(e){return wrapNullable(e,{type:"NumberTypeAnnotation"})}function emitRootTag(e){return wrapNullable(e,{type:"ReservedTypeAnnotation",name:"RootTag"})}function emitDouble(e){return wrapNullable(e,{type:"DoubleTypeAnnotation"})}function emitDoubleProp(e,t){return{name:e,optional:t,typeAnnotation:{type:"DoubleTypeAnnotation"}}}function emitVoid(e){return wrapNullable(e,{type:"VoidTypeAnnotation"})}function emitStringish(e){return wrapNullable(e,{type:"StringTypeAnnotation"})}function emitFunction(e,t,n,r,o,i,a,p,l,m){const u=translateFunctionTypeAnnotation(t,n,r,o,i,a,p,l,m);return wrapNullable(e,u)}function emitMixed(e){return wrapNullable(e,{type:"MixedTypeAnnotation"})}function emitNumberLiteral(e,t){return wrapNullable(e,{type:"NumberLiteralTypeAnnotation",value:t})}function emitString(e){return wrapNullable(e,{type:"StringTypeAnnotation"})}function emitStringLiteral(e,t){return wrapNullable(e,{type:"StringLiteralTypeAnnotation",value:t})}function emitStringProp(e,t){return{name:e,optional:t,typeAnnotation:{type:"StringTypeAnnotation"}}}function typeAliasResolution(e,t,n,r){return e.successful?(n[e.name]=t,wrapNullable(r,{type:"TypeAliasTypeAnnotation",name:e.name})):wrapNullable(r,t)}function typeEnumResolution(e,t,n,r,o,i){if(!t.successful||"enum"!==t.type)throw new UnsupportedTypeAnnotationParserError(r,e,i.language());const a=t.name,p=i.parseEnumMembersType(e);try{i.validateEnumMembersSupported(e,p)}catch(t){throw t instanceof Error?new ParserError(r,e,`Failed parsing the enum ${a} in ${r} with the error: ${t.message}`):t}const l=i.parseEnumMembers(e);return o[a]={name:a,type:"EnumDeclarationWithMembers",memberType:p,members:l},wrapNullable(n,{name:a,type:"EnumDeclaration",memberType:p})}function emitPromise(e,t,n,r,o,i,a,p,l,m){assertGenericTypeAnnotationHasExactlyOneTypeParameter(e,t,n);const u=t.typeParameters.params[0];if("ExistsTypeAnnotation"===u.type||"EmptyTypeAnnotation"===u.type)return wrapNullable(r,{type:"PromiseTypeAnnotation",elementType:{type:"VoidTypeAnnotation"}});try{return wrapNullable(r,{type:"PromiseTypeAnnotation",elementType:m(e,t.typeParameters.params[0],o,i,a,p,l,n)})}catch{return wrapNullable(r,{type:"PromiseTypeAnnotation",elementType:{type:"VoidTypeAnnotation"}})}}function emitGenericObject(e){return wrapNullable(e,{type:"GenericObjectTypeAnnotation"})}function emitDictionary(e,t){return wrapNullable(e,{type:"GenericObjectTypeAnnotation",dictionaryValueType:t})}function emitObject(e,t){return wrapNullable(e,{type:"ObjectTypeAnnotation",properties:t})}function emitFloat(e){return wrapNullable(e,{type:"FloatTypeAnnotation"})}function emitFloatProp(e,t){return{name:e,optional:t,typeAnnotation:{type:"FloatTypeAnnotation"}}}function emitUnion(e,t,n,r){const o=r.remapUnionTypeAnnotationMemberNames(n.types);if(o.length>1)throw new UnsupportedUnionTypeAnnotationParserError(t,n,o);return"StringTypeAnnotation"===o[0]?emitStringLiteralUnion(e,t,n,r):wrapNullable(e,{type:"UnionTypeAnnotation",memberType:o[0]})}function emitStringLiteralUnion(e,t,n,r){const o=r.getStringLiteralUnionTypeAnnotationStringLiterals(n.types);return wrapNullable(e,{type:"StringLiteralUnionTypeAnnotation",types:o.map(e=>({type:"StringLiteralTypeAnnotation",value:e}))})}function translateArrayTypeAnnotation(e,t,n,r,o,i,a,p,l,m){try{const[u,y]=unwrapNullable(l(e,a,t,n,r,nullGuard,o,m));return throwIfArrayElementTypeAnnotationIsUnsupported(e,a,i,u.type),wrapNullable(p,{type:"ArrayTypeAnnotation",elementType:wrapNullable(y,u)})}catch(e){return wrapNullable(p,{type:"ArrayTypeAnnotation",elementType:{type:"AnyTypeAnnotation"}})}}function emitArrayType(e,t,n,r,o,i,a,p,l){return assertGenericTypeAnnotationHasExactlyOneTypeParameter(e,t,n),translateArrayTypeAnnotation(e,r,o,i,a,t.type,t.typeParameters.params[0],p,l,n)}function Visitor(e){return{CallExpression(t){"Identifier"===t.callee.type&&"codegenNativeComponent"===t.callee.name&&(e.isComponent=!0),isModuleRegistryCall(t)&&(e.isModule=!0)},InterfaceExtends(t){"TurboModule"===t.id.name&&(e.isModule=!0)},TSInterfaceDeclaration(t){Array.isArray(t.extends)&&t.extends.some(e=>"TurboModule"===e.expression.name)&&(e.isModule=!0)}}}function emitPartial(e,t,n,r,o,i,a,p,l){throwIfPartialWithMoreParameter(n),throwIfPartialNotAnnotatingTypeParameter(n,r,l);const m=l.extractAnnotatedElement(n,r),u=l.getAnnotatedElementProperties(m);return emitObject(e,l.computePartialProperties(u,t,r,o,i,a,p))}function emitCommonTypes(e,t,n,r,o,i,a,p,l){const m={Stringish:emitStringish,Int32:emitInt32,Double:emitDouble,Float:emitFloat,UnsafeObject:emitGenericObject,Object:emitGenericObject,$Partial:emitPartial,Partial:emitPartial,BooleanTypeAnnotation:emitBoolean,NumberTypeAnnotation:emitNumber,VoidTypeAnnotation:emitVoid,StringTypeAnnotation:emitString,MixedTypeAnnotation:a?emitMixed:emitGenericObject},u=m[l.convertKeywordToTypeAnnotation(n.type)];if(u)return u(p);const y=m[l.getTypeAnnotationName(n)];return y?y(p,e,n,t,r,o,i,a,l):null}function emitBoolProp(e,t){return{name:e,optional:t,typeAnnotation:{type:"BooleanTypeAnnotation"}}}function emitMixedProp(e,t){return{name:e,optional:t,typeAnnotation:{type:"MixedTypeAnnotation"}}}function emitObjectProp(e,t,n,r,o){return{name:e,optional:t,typeAnnotation:o(r,e,n)}}function emitUnionProp(e,t,n,r){return{name:e,optional:t,typeAnnotation:{type:"StringLiteralUnionTypeAnnotation",types:r.types.map(e=>({type:"StringLiteralTypeAnnotation",value:n.getLiteralValue(e)}))}}}module.exports={emitArrayType:emitArrayType,emitBoolean:emitBoolean,emitBoolProp:emitBoolProp,emitDouble:emitDouble,emitDoubleProp:emitDoubleProp,emitFloat:emitFloat,emitFloatProp:emitFloatProp,emitFunction:emitFunction,emitInt32:emitInt32,emitInt32Prop:emitInt32Prop,emitMixedProp:emitMixedProp,emitNumber:emitNumber,emitNumberLiteral:emitNumberLiteral,emitGenericObject:emitGenericObject,emitDictionary:emitDictionary,emitObject:emitObject,emitPromise:emitPromise,emitRootTag:emitRootTag,emitVoid:emitVoid,emitString:emitString,emitStringish:emitStringish,emitStringProp:emitStringProp,emitStringLiteral:emitStringLiteral,emitMixed:emitMixed,emitUnion:emitUnion,emitPartial:emitPartial,emitCommonTypes:emitCommonTypes,typeAliasResolution:typeAliasResolution,typeEnumResolution:typeEnumResolution,translateArrayTypeAnnotation:translateArrayTypeAnnotation,Visitor:Visitor,emitObjectProp:emitObjectProp,emitUnionProp:emitUnionProp};