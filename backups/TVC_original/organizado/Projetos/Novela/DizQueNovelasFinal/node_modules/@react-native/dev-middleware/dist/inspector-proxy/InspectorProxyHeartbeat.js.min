"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _timers=require("timers"),_ws=_interopRequireDefault(require("ws"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}class InspectorProxyHeartbeat{#e;#t;#i;#s;#o;#r;constructor(e){this.#e=e.socket,this.#t=e.timeBetweenPings,this.#i=e.minHighPingToReport,this.#s=e.timeoutMs,this.#o=e.onTimeout,this.#r=e.onHighPing}start(){let e,t=Date.now();const i=(0,_timers.setTimeout)(()=>{this.#e.readyState===_ws.default.OPEN?(e||(e=(0,_timers.setTimeout)(()=>{this.#e.readyState===_ws.default.OPEN?this.#o(this.#s):e?.refresh()},this.#s).unref()),t=Date.now(),this.#e.ping()):i.refresh()},this.#t).unref();this.#e.on("pong",()=>{const s=Date.now()-t;s>=this.#i&&this.#r(s),e?.refresh(),i.refresh()}),this.#e.on("message",()=>{e?.refresh()}),this.#e.on("close",(t,s)=>{e&&(0,_timers.clearTimeout)(e),(0,_timers.clearTimeout)(i)})}}exports.default=InspectorProxyHeartbeat;