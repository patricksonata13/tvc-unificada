"use strict";const{getValueFromTypes:getValueFromTypes}=require("../utils.js");function buildCommandSchema(e,t,n){const o=e.key.name,a=e.optional,r=getValueFromTypes(e.value,t),p=r.params[0].typeAnnotation;if(null==p.id||"QualifiedTypeIdentifier"!==p.id.type||"React"!==p.id.qualification.name||"ElementRef"!==p.id.id.name)throw new Error(`The first argument of method ${o} must be of type React.ElementRef<>`);const y=r.params.slice(1).map(e=>{const a=e.name.name,r=getValueFromTypes(e.typeAnnotation,t),p="GenericTypeAnnotation"===r.type?n.getTypeAnnotationName(r):r.type;let y;switch(p){case"RootTag":y={type:"ReservedTypeAnnotation",name:"RootTag"};break;case"BooleanTypeAnnotation":y={type:"BooleanTypeAnnotation"};break;case"Int32":y={type:"Int32TypeAnnotation"};break;case"Double":y={type:"DoubleTypeAnnotation"};break;case"Float":y={type:"FloatTypeAnnotation"};break;case"StringTypeAnnotation":y={type:"StringTypeAnnotation"};break;case"Array":case"$ReadOnlyArray":if("GenericTypeAnnotation"===!r.type)throw new Error("Array and $ReadOnlyArray are GenericTypeAnnotation for array");y={type:"ArrayTypeAnnotation",elementType:getCommandArrayElementTypeType(r.typeParameters.params[0],n)};break;case"ArrayTypeAnnotation":y={type:"ArrayTypeAnnotation",elementType:getCommandArrayElementTypeType(r.elementType,n)};break;default:throw new Error(`Unsupported param type for method "${o}", param "${a}". Found ${p}`)}return{name:a,optional:!1,typeAnnotation:y}});return{name:o,optional:a,typeAnnotation:{type:"FunctionTypeAnnotation",params:y,returnTypeAnnotation:{type:"VoidTypeAnnotation"}}}}function getCommandArrayElementTypeType(e,t){if("object"!=typeof e)throw new Error("Expected an object");const n=null==e?void 0:e.type;if(null==e||"string"!=typeof n)throw new Error("Command array element type must be a string");switch(n){case"BooleanTypeAnnotation":return{type:"BooleanTypeAnnotation"};case"StringTypeAnnotation":return{type:"StringTypeAnnotation"};case"GenericTypeAnnotation":const o="object"==typeof e.id?t.getTypeAnnotationName(e):null;if("string"!=typeof o)throw new Error("Expected GenericTypeAnnotation AST name to be a string");switch(o){case"Int32":return{type:"Int32TypeAnnotation"};case"Float":return{type:"FloatTypeAnnotation"};case"Double":return{type:"DoubleTypeAnnotation"};default:return{type:"MixedTypeAnnotation"}}default:throw new Error(`Unsupported array element type ${n}`)}}function getCommands(e,t,n){return e.filter(e=>"ObjectTypeProperty"===e.type).map(e=>buildCommandSchema(e,t,n)).filter(Boolean)}module.exports={getCommands:getCommands};