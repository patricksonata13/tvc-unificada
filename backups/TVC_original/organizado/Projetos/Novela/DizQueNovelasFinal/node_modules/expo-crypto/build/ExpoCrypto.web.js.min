import{CodedError}from"expo-modules-core";import{CryptoEncoding}from"./Crypto.types";const getCrypto=()=>window.crypto??window.msCrypto;export default{async digestStringAsync(t,r,e){if(!crypto.subtle)throw new CodedError("ERR_CRYPTO_UNAVAILABLE","Access to the WebCrypto API is restricted to secure origins (localhost/https).");const o=(new TextEncoder).encode(r),n=await crypto.subtle.digest(t,o);if(e.encoding===CryptoEncoding.HEX)return hexString(n);if(e.encoding===CryptoEncoding.BASE64)return btoa(String.fromCharCode(...new Uint8Array(n)));throw new CodedError("ERR_CRYPTO_DIGEST","Invalid encoding type provided.")},getRandomBytes(t){const r=new Uint8Array(t);return getCrypto().getRandomValues(r)},async getRandomBytesAsync(t){const r=new Uint8Array(t);return getCrypto().getRandomValues(r)},getRandomValues:t=>getCrypto().getRandomValues(t),randomUUID:()=>getCrypto().randomUUID(),digestAsync:(t,r)=>getCrypto().subtle.digest(t,r)};function hexString(t){return[...new Uint8Array(t)].map(t=>t.toString(16).padStart(2,"0")).join("")}