#!/usr/bin/env node
const rimraf=require("./"),path=require("path"),isRoot=e=>/^(\/|[a-zA-Z]:\\)$/.test(path.resolve(e)),filterOutRoot=e=>{const o=!1===preserveRoot||!isRoot(e);return o||(console.error(`refusing to remove ${e}`),console.error("Set --no-preserve-root to allow this")),o};let help=!1,dashdash=!1,noglob=!1,preserveRoot=!0;const args=process.argv.slice(2).filter(e=>{if(dashdash)return!!e;if("--"===e)dashdash=!0;else if("--no-glob"===e||"-G"===e)noglob=!0;else if("--glob"===e||"-g"===e)noglob=!1;else if(e.match(/^(-+|\/)(h(elp)?|\?)$/))help=!0;else if("--preserve-root"===e)preserveRoot=!0;else{if("--no-preserve-root"!==e)return!!e;preserveRoot=!1}}).filter(e=>!preserveRoot||filterOutRoot(e)),go=e=>{if(e>=args.length)return;const o=noglob?{glob:!1}:{};rimraf(args[e],o,o=>{if(o)throw o;go(e+1)})};if(help||0===args.length){const e=help?console.log:console.error;e("Usage: rimraf <path> [<path> ...]"),e(""),e('  Deletes all files and folders at "path" recursively.'),e(""),e("Options:"),e(""),e("  -h, --help          Display this usage info"),e("  -G, --no-glob       Do not expand glob patterns in arguments"),e("  -g, --glob          Expand glob patterns in arguments (default)"),e("  --preserve-root     Do not remove '/' (default)"),e("  --no-preserve-root  Do not treat '/' specially"),e("  --                  Stop parsing flags"),process.exit(help?0:1)}else go(0);