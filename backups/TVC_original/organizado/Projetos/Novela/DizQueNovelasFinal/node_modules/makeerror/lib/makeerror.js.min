var tmpl=require("tmpl");function BaseError(){}function makeError(t,e,r){if(e=tmpl(e||""),(r=r||{}).proto&&!(r.proto instanceof BaseError))throw new Error('The custom "proto" must be an Error created via makeError');var s=function(i,n){if(!(this instanceof s))return new s(i,n);"string"==typeof i||n||(n=i,i=null),this.name=t,this.data=n||r,this.message="string"==typeof i?tmpl(i,this.data):e(this.data);var o=new Error;this.stack=o.stack,this.stack&&("undefined"!=typeof Components?this.stack=this.stack.substring(this.stack.indexOf("\n")+2):"undefined"==typeof chrome&&"undefined"==typeof process||(this.stack=this.stack.replace(/\n[^\n]*/,""),this.stack=this.stack.replace(/\n[^\n]*/,""),this.stack=this.name+(this.message?": "+this.message:"")+this.stack.substring(5))),"fileName"in o&&(this.fileName=o.fileName),"lineNumber"in o&&(this.lineNumber=o.lineNumber)};return s.prototype=r.proto||new BaseError,delete r.proto,s}module.exports=makeError,BaseError.prototype=new Error,BaseError.prototype.toString=function(){return this.message};