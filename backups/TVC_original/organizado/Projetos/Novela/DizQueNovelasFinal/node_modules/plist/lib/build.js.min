var base64=require("base64-js"),xmlbuilder=require("xmlbuilder");function ISODateString(e){function t(e){return e<10?"0"+e:e}return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"Z"}exports.build=build;var toString=Object.prototype.toString;function type(e){var t=toString.call(e).match(/\[object (.*)\]/);return t?t[1]:t}function build(e,t){var r={version:"1.0",encoding:"UTF-8"},a="-//Apple//DTD PLIST 1.0//EN",n="http://www.apple.com/DTDs/PropertyList-1.0.dtd",l=xmlbuilder.create("plist");return l.dec(r.version,r.encoding,r.standalone),l.dtd(a,n),l.att("version","1.0"),walk_obj(e,l),t||(t={}),t.pretty=!1!==t.pretty,l.end(t)}function walk_obj(e,t){var r,a,n,l=type(e);if("Undefined"!=l)if(Array.isArray(e))for(t=t.ele("array"),a=0;a<e.length;a++)walk_obj(e[a],t);else if(Buffer.isBuffer(e))t.ele("data").raw(e.toString("base64"));else if("Object"==l)for(n in t=t.ele("dict"),e)e.hasOwnProperty(n)&&(t.ele("key").txt(n),walk_obj(e[n],t));else"Number"==l?(r=e%1==0?"integer":"real",t.ele(r).txt(e.toString())):"BigInt"==l?t.ele("integer").txt(e):"Date"==l?t.ele("date").txt(ISODateString(new Date(e))):"Boolean"==l?t.ele(e?"true":"false"):"String"==l?t.ele("string").txt(e):"ArrayBuffer"==l?t.ele("data").raw(base64.fromByteArray(e)):e&&e.buffer&&"ArrayBuffer"==type(e.buffer)?t.ele("data").raw(base64.fromByteArray(new Uint8Array(e.buffer),t)):"Null"===l&&t.ele("null").txt("")}