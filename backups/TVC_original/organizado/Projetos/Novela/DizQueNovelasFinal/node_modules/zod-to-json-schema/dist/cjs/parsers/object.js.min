"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.parseObjectDef=void 0;const parseDef_js_1=require("../parseDef.js");function parseObjectDef(e,t){const r="openAi"===t.target,i={type:"object",properties:{}},o=[],s=e.shape();for(const e in s){let a=s[e];if(void 0===a||void 0===a._def)continue;let n=safeIsOptional(a);n&&r&&("ZodOptional"===a._def.typeName&&(a=a._def.innerType),a.isNullable()||(a=a.nullable()),n=!1);const p=(0,parseDef_js_1.parseDef)(a._def,{...t,currentPath:[...t.currentPath,"properties",e],propertyPath:[...t.currentPath,"properties",e]});void 0!==p&&(i.properties[e]=p,n||o.push(e))}o.length&&(i.required=o);const a=decideAdditionalProperties(e,t);return void 0!==a&&(i.additionalProperties=a),i}function decideAdditionalProperties(e,t){if("ZodNever"!==e.catchall._def.typeName)return(0,parseDef_js_1.parseDef)(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]});switch(e.unknownKeys){case"passthrough":return t.allowedAdditionalProperties;case"strict":return t.rejectedAdditionalProperties;case"strip":return"strict"===t.removeAdditionalStrategy?t.allowedAdditionalProperties:t.rejectedAdditionalProperties}}function safeIsOptional(e){try{return e.isOptional()}catch{return!0}}exports.parseObjectDef=parseObjectDef;