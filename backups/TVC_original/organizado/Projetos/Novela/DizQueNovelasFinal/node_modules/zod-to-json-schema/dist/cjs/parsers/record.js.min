"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.parseRecordDef=void 0;const zod_1=require("zod"),parseDef_js_1=require("../parseDef.js"),string_js_1=require("./string.js"),branded_js_1=require("./branded.js"),any_js_1=require("./any.js");function parseRecordDef(e,r){if("openAi"===r.target&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),"openApi3"===r.target&&e.keyType?._def.typeName===zod_1.ZodFirstPartyTypeKind.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((t,d)=>({...t,[d]:(0,parseDef_js_1.parseDef)(e.valueType._def,{...r,currentPath:[...r.currentPath,"properties",d]})??(0,any_js_1.parseAnyDef)(r)}),{}),additionalProperties:r.rejectedAdditionalProperties};const t={type:"object",additionalProperties:(0,parseDef_js_1.parseDef)(e.valueType._def,{...r,currentPath:[...r.currentPath,"additionalProperties"]})??r.allowedAdditionalProperties};if("openApi3"===r.target)return t;if(e.keyType?._def.typeName===zod_1.ZodFirstPartyTypeKind.ZodString&&e.keyType._def.checks?.length){const{type:d,...p}=(0,string_js_1.parseStringDef)(e.keyType._def,r);return{...t,propertyNames:p}}if(e.keyType?._def.typeName===zod_1.ZodFirstPartyTypeKind.ZodEnum)return{...t,propertyNames:{enum:e.keyType._def.values}};if(e.keyType?._def.typeName===zod_1.ZodFirstPartyTypeKind.ZodBranded&&e.keyType._def.type._def.typeName===zod_1.ZodFirstPartyTypeKind.ZodString&&e.keyType._def.type._def.checks?.length){const{type:d,...p}=(0,branded_js_1.parseBrandedDef)(e.keyType._def,r);return{...t,propertyNames:p}}return t}exports.parseRecordDef=parseRecordDef;