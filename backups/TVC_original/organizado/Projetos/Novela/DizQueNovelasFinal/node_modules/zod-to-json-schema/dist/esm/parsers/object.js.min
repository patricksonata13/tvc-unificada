import{parseDef}from"../parseDef.js";export function parseObjectDef(e,t){const r="openAi"===t.target,i={type:"object",properties:{}},o=[],a=e.shape();for(const e in a){let n=a[e];if(void 0===n||void 0===n._def)continue;let s=safeIsOptional(n);s&&r&&("ZodOptional"===n._def.typeName&&(n=n._def.innerType),n.isNullable()||(n=n.nullable()),s=!1);const d=parseDef(n._def,{...t,currentPath:[...t.currentPath,"properties",e],propertyPath:[...t.currentPath,"properties",e]});void 0!==d&&(i.properties[e]=d,s||o.push(e))}o.length&&(i.required=o);const n=decideAdditionalProperties(e,t);return void 0!==n&&(i.additionalProperties=n),i}function decideAdditionalProperties(e,t){if("ZodNever"!==e.catchall._def.typeName)return parseDef(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]});switch(e.unknownKeys){case"passthrough":return t.allowedAdditionalProperties;case"strict":return t.rejectedAdditionalProperties;case"strip":return"strict"===t.removeAdditionalStrategy?t.allowedAdditionalProperties:t.rejectedAdditionalProperties}}function safeIsOptional(e){try{return e.isOptional()}catch{return!0}}