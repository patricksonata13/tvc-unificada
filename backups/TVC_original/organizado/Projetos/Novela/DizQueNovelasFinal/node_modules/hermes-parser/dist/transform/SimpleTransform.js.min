"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SimpleTransform=void 0;var _SimpleTraverser=require("../traverse/SimpleTraverser"),_astNodeMutationHelpers=require("./astNodeMutationHelpers");function setParentPointer(r,e){null!=e&&(r.parent=e)}class SimpleTransform{transform(r,e){let t=r;return _SimpleTraverser.SimpleTraverser.traverse(r,{enter:(o,s)=>{setParentPointer(o,s);const n=e.transform(o);if(n!==o){let a=null;if(null!=n&&(setParentPointer(n,s),a=this.transform(n,e)),null==s){if(o!==r)throw new Error("SimpleTransform infra error: Parent not set on non root node, this should not be possible");t=a}else null==a?(0,_astNodeMutationHelpers.removeNodeOnParent)(o,s,e.visitorKeys):((0,_astNodeMutationHelpers.replaceNodeOnParent)(o,s,a,e.visitorKeys),setParentPointer(a,s));throw _SimpleTraverser.SimpleTraverser.Skip}},leave(r){},visitorKeys:e.visitorKeys}),t}static transform(r,e){return(new SimpleTransform).transform(r,e)}static transformProgram(r,e){const t=SimpleTransform.transform(r,e);if("Program"===(null==t?void 0:t.type))return t;throw new Error("SimpleTransform.transformProgram: Expected program node.")}static nodeWith(r,e,t){return(0,_astNodeMutationHelpers.nodeWith)(r,e,t)}}exports.SimpleTransform=SimpleTransform;