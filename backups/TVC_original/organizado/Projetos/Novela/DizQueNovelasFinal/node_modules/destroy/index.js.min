/*!
 * destroy
 * Copyright(c) 2014 Jonathan Ong
 * Copyright(c) 2015-2022 Douglas Christopher Wilson
 * MIT Licensed
 */
"use strict";var EventEmitter=require("events").EventEmitter,ReadStream=require("fs").ReadStream,Stream=require("stream"),Zlib=require("zlib");function destroy(e,n){return isFsReadStream(e)?destroyReadStream(e):isZlibStream(e)?destroyZlibStream(e):hasDestroy(e)&&e.destroy(),isEventEmitter(e)&&n&&(e.removeAllListeners("error"),e.addListener("error",noop)),e}function destroyReadStream(e){e.destroy(),"function"==typeof e.close&&e.on("open",onOpenClose)}function closeZlibStream(e){if(!0===e._hadError){var n=null===e._binding?"_binding":"_handle";e[n]={close:function(){this[n]=null}}}e.close()}function destroyZlibStream(e){"function"==typeof e.destroy?e._binding?(e.destroy(),e._processing?(e._needDrain=!0,e.once("drain",onDrainClearBinding)):e._binding.clear()):e._destroy&&e._destroy!==Stream.Transform.prototype._destroy?e.destroy():e._destroy&&"function"==typeof e.close?(e.destroyed=!0,e.close()):e.destroy():"function"==typeof e.close&&closeZlibStream(e)}function hasDestroy(e){return e instanceof Stream&&"function"==typeof e.destroy}function isEventEmitter(e){return e instanceof EventEmitter}function isFsReadStream(e){return e instanceof ReadStream}function isZlibStream(e){return e instanceof Zlib.Gzip||e instanceof Zlib.Gunzip||e instanceof Zlib.Deflate||e instanceof Zlib.DeflateRaw||e instanceof Zlib.Inflate||e instanceof Zlib.InflateRaw||e instanceof Zlib.Unzip}function noop(){}function onDrainClearBinding(){this._binding.clear()}function onOpenClose(){"number"==typeof this.fd&&this.close()}module.exports=destroy;