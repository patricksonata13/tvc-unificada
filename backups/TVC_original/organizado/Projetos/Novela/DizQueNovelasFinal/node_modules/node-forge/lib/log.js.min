var forge=require("./forge");require("./util"),module.exports=forge.log=forge.log||{},forge.log.levels=["none","error","warning","info","debug","verbose","max"];var sLevelInfo={},sLoggers=[],sConsoleLogger=null;forge.log.LEVEL_LOCKED=2,forge.log.NO_LEVEL_CHECK=4,forge.log.INTERPOLATE=8;for(var i=0;i<forge.log.levels.length;++i){var level=forge.log.levels[i];sLevelInfo[level]={index:i,name:level.toUpperCase()}}forge.log.logMessage=function(e){for(var o=sLevelInfo[e.level].index,l=0;l<sLoggers.length;++l){var r=sLoggers[l];if(r.flags&forge.log.NO_LEVEL_CHECK)r.f(e);else o<=sLevelInfo[r.level].index&&r.f(r,e)}},forge.log.prepareStandard=function(e){"standard"in e||(e.standard=sLevelInfo[e.level].name+" ["+e.category+"] "+e.message)},forge.log.prepareFull=function(e){if(!("full"in e)){var o=[e.message];o=o.concat([]||e.arguments),e.full=forge.util.format.apply(this,o)}},forge.log.prepareStandardFull=function(e){"standardFull"in e||(forge.log.prepareStandard(e),e.standardFull=e.standard)};var levels=["error","warning","info","debug","verbose"];for(i=0;i<levels.length;++i)(function(e){forge.log[e]=function(o,l){var r=Array.prototype.slice.call(arguments).slice(2),g={timestamp:new Date,level:e,category:o,message:l,arguments:r};forge.log.logMessage(g)}})(levels[i]);if(forge.log.makeLogger=function(e){var o={flags:0,f:e};return forge.log.setLevel(o,"none"),o},forge.log.setLevel=function(e,o){var l=!1;if(e&&!(e.flags&forge.log.LEVEL_LOCKED))for(var r=0;r<forge.log.levels.length;++r){if(o==forge.log.levels[r]){e.level=o,l=!0;break}}return l},forge.log.lock=function(e,o){void 0===o||o?e.flags|=forge.log.LEVEL_LOCKED:e.flags&=~forge.log.LEVEL_LOCKED},forge.log.addLogger=function(e){sLoggers.push(e)},"undefined"!=typeof console&&"log"in console){var logger;if(console.error&&console.warn&&console.info&&console.debug){var levelHandlers={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},f=function(e,o){forge.log.prepareStandard(o);var l=levelHandlers[o.level],r=[o.standard];r=r.concat(o.arguments.slice()),l.apply(console,r)};logger=forge.log.makeLogger(f)}else{f=function(e,o){forge.log.prepareStandardFull(o),console.log(o.standardFull)};logger=forge.log.makeLogger(f)}forge.log.setLevel(logger,"debug"),forge.log.addLogger(logger),sConsoleLogger=logger}else console={log:function(){}};if(null!==sConsoleLogger&&"undefined"!=typeof window&&window.location){var query=new URL(window.location.href).searchParams;if(query.has("console.level")&&forge.log.setLevel(sConsoleLogger,query.get("console.level").slice(-1)[0]),query.has("console.lock")){var lock=query.get("console.lock").slice(-1)[0];"true"==lock&&forge.log.lock(sConsoleLogger)}}forge.log.consoleLogger=sConsoleLogger;