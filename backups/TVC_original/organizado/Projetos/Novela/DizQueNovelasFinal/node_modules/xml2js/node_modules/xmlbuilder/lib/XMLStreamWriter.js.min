(function(){var t,e,r,s={}.hasOwnProperty;t=require("./NodeType"),r=require("./XMLWriterBase"),e=require("./WriterState"),module.exports=function(r){function i(t,e){this.stream=t,i.__super__.constructor.call(this,e)}return function(t,e){for(var r in e)s.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(i,r),i.prototype.endline=function(t,r,s){return t.isLastRootNode&&r.state===e.CloseTag?"":i.__super__.endline.call(this,t,r,s)},i.prototype.document=function(t,e){var r,s,i,n,o,a,h,l,p;for(s=i=0,o=(h=t.children).length;i<o;s=++i)(r=h[s]).isLastRootNode=s===t.children.length-1;for(e=this.filterOptions(e),p=[],n=0,a=(l=t.children).length;n<a;n++)r=l[n],p.push(this.writeChildNode(r,e,0));return p},i.prototype.attribute=function(t,e,r){return this.stream.write(i.__super__.attribute.call(this,t,e,r))},i.prototype.cdata=function(t,e,r){return this.stream.write(i.__super__.cdata.call(this,t,e,r))},i.prototype.comment=function(t,e,r){return this.stream.write(i.__super__.comment.call(this,t,e,r))},i.prototype.declaration=function(t,e,r){return this.stream.write(i.__super__.declaration.call(this,t,e,r))},i.prototype.docType=function(t,r,s){var i,n,o,a;if(s||(s=0),this.openNode(t,r,s),r.state=e.OpenTag,this.stream.write(this.indent(t,r,s)),this.stream.write("<!DOCTYPE "+t.root().name),t.pubID&&t.sysID?this.stream.write(' PUBLIC "'+t.pubID+'" "'+t.sysID+'"'):t.sysID&&this.stream.write(' SYSTEM "'+t.sysID+'"'),t.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(t,r,s)),r.state=e.InsideTag,n=0,o=(a=t.children).length;n<o;n++)i=a[n],this.writeChildNode(i,r,s+1);r.state=e.CloseTag,this.stream.write("]")}return r.state=e.CloseTag,this.stream.write(r.spaceBeforeSlash+">"),this.stream.write(this.endline(t,r,s)),r.state=e.None,this.closeNode(t,r,s)},i.prototype.element=function(r,i,n){var o,a,h,l,p,u,c,d,_;for(c in n||(n=0),this.openNode(r,i,n),i.state=e.OpenTag,this.stream.write(this.indent(r,i,n)+"<"+r.name),d=r.attribs)s.call(d,c)&&(o=d[c],this.attribute(o,i,n));if(l=0===(h=r.children.length)?null:r.children[0],0===h||r.children.every(function(e){return(e.type===t.Text||e.type===t.Raw)&&""===e.value}))i.allowEmpty?(this.stream.write(">"),i.state=e.CloseTag,this.stream.write("</"+r.name+">")):(i.state=e.CloseTag,this.stream.write(i.spaceBeforeSlash+"/>"));else if(!i.pretty||1!==h||l.type!==t.Text&&l.type!==t.Raw||null==l.value){for(this.stream.write(">"+this.endline(r,i,n)),i.state=e.InsideTag,p=0,u=(_=r.children).length;p<u;p++)a=_[p],this.writeChildNode(a,i,n+1);i.state=e.CloseTag,this.stream.write(this.indent(r,i,n)+"</"+r.name+">")}else this.stream.write(">"),i.state=e.InsideTag,i.suppressPrettyCount++,this.writeChildNode(l,i,n+1),i.suppressPrettyCount--,i.state=e.CloseTag,this.stream.write("</"+r.name+">");return this.stream.write(this.endline(r,i,n)),i.state=e.None,this.closeNode(r,i,n)},i.prototype.processingInstruction=function(t,e,r){return this.stream.write(i.__super__.processingInstruction.call(this,t,e,r))},i.prototype.raw=function(t,e,r){return this.stream.write(i.__super__.raw.call(this,t,e,r))},i.prototype.text=function(t,e,r){return this.stream.write(i.__super__.text.call(this,t,e,r))},i.prototype.dtdAttList=function(t,e,r){return this.stream.write(i.__super__.dtdAttList.call(this,t,e,r))},i.prototype.dtdElement=function(t,e,r){return this.stream.write(i.__super__.dtdElement.call(this,t,e,r))},i.prototype.dtdEntity=function(t,e,r){return this.stream.write(i.__super__.dtdEntity.call(this,t,e,r))},i.prototype.dtdNotation=function(t,e,r){return this.stream.write(i.__super__.dtdNotation.call(this,t,e,r))},i}(r)}).call(this);