(function(){var e,t,s,n={}.hasOwnProperty;({assign:s}=require("./Utility")),e=require("./NodeType"),require("./XMLDeclaration"),require("./XMLDocType"),require("./XMLCData"),require("./XMLComment"),require("./XMLElement"),require("./XMLRaw"),require("./XMLText"),require("./XMLProcessingInstruction"),require("./XMLDummy"),require("./XMLDTDAttList"),require("./XMLDTDElement"),require("./XMLDTDEntity"),require("./XMLDTDNotation"),t=require("./WriterState"),module.exports=class{constructor(e){var t,s,a;for(t in e||(e={}),this.options=e,s=e.writer||{})n.call(s,t)&&(a=s[t],this["_"+t]=this[t],this[t]=a)}filterOptions(e){var n,a,i,r,o,l,d,u,h;return e||(e={}),e=s({},this.options,e),(n={writer:this}).pretty=e.pretty||!1,n.allowEmpty=e.allowEmpty||!1,n.indent=null!=(a=e.indent)?a:"  ",n.newline=null!=(i=e.newline)?i:"\n",n.offset=null!=(r=e.offset)?r:0,n.width=null!=(o=e.width)?o:0,n.dontPrettyTextNodes=null!=(l=null!=(d=e.dontPrettyTextNodes)?d:e.dontprettytextnodes)?l:0,n.spaceBeforeSlash=null!=(u=null!=(h=e.spaceBeforeSlash)?h:e.spacebeforeslash)?u:"",!0===n.spaceBeforeSlash&&(n.spaceBeforeSlash=" "),n.suppressPrettyCount=0,n.user={},n.state=t.None,n}indent(e,t,s){var n;return!t.pretty||t.suppressPrettyCount?"":t.pretty&&(n=(s||0)+t.offset+1)>0?new Array(n).join(t.indent):""}endline(e,t,s){return!t.pretty||t.suppressPrettyCount?"":t.newline}attribute(e,t,s){var n;return this.openAttribute(e,t,s),n=t.pretty&&t.width>0?e.name+'="'+e.value+'"':" "+e.name+'="'+e.value+'"',this.closeAttribute(e,t,s),n}cdata(e,s,n){var a;return this.openNode(e,s,n),s.state=t.OpenTag,a=this.indent(e,s,n)+"<![CDATA[",s.state=t.InsideTag,a+=e.value,s.state=t.CloseTag,a+="]]>"+this.endline(e,s,n),s.state=t.None,this.closeNode(e,s,n),a}comment(e,s,n){var a;return this.openNode(e,s,n),s.state=t.OpenTag,a=this.indent(e,s,n)+"\x3c!-- ",s.state=t.InsideTag,a+=e.value,s.state=t.CloseTag,a+=" --\x3e"+this.endline(e,s,n),s.state=t.None,this.closeNode(e,s,n),a}declaration(e,s,n){var a;return this.openNode(e,s,n),s.state=t.OpenTag,a=this.indent(e,s,n)+"<?xml",s.state=t.InsideTag,a+=' version="'+e.version+'"',null!=e.encoding&&(a+=' encoding="'+e.encoding+'"'),null!=e.standalone&&(a+=' standalone="'+e.standalone+'"'),s.state=t.CloseTag,a+=s.spaceBeforeSlash+"?>",a+=this.endline(e,s,n),s.state=t.None,this.closeNode(e,s,n),a}docType(e,s,n){var a,i,r,o,l;if(n||(n=0),this.openNode(e,s,n),s.state=t.OpenTag,o=this.indent(e,s,n),o+="<!DOCTYPE "+e.root().name,e.pubID&&e.sysID?o+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.sysID&&(o+=' SYSTEM "'+e.sysID+'"'),e.children.length>0){for(o+=" [",o+=this.endline(e,s,n),s.state=t.InsideTag,i=0,r=(l=e.children).length;i<r;i++)a=l[i],o+=this.writeChildNode(a,s,n+1);s.state=t.CloseTag,o+="]"}return s.state=t.CloseTag,o+=s.spaceBeforeSlash+">",o+=this.endline(e,s,n),s.state=t.None,this.closeNode(e,s,n),o}element(s,a,i){var r,o,l,d,u,h,p,c,T,y,g,N,D,I,C,f,m,v;if(i||(i=0),g=!1,this.openNode(s,a,i),a.state=t.OpenTag,N=this.indent(s,a,i)+"<"+s.name,a.pretty&&a.width>0)for(y in p=N.length,I=s.attribs)n.call(I,y)&&(r=I[y],p+(D=this.attribute(r,a,i)).length>a.width?(v=this.indent(s,a,i+1)+D,N+=this.endline(s,a,i)+v,p=v.length):(N+=v=" "+D,p+=v.length));else for(y in C=s.attribs)n.call(C,y)&&(r=C[y],N+=this.attribute(r,a,i));if(d=0===(l=s.children.length)?null:s.children[0],0===l||s.children.every(function(t){return(t.type===e.Text||t.type===e.Raw||t.type===e.CData)&&""===t.value}))a.allowEmpty?(N+=">",a.state=t.CloseTag,N+="</"+s.name+">"+this.endline(s,a,i)):(a.state=t.CloseTag,N+=a.spaceBeforeSlash+"/>"+this.endline(s,a,i));else if(!a.pretty||1!==l||d.type!==e.Text&&d.type!==e.Raw&&d.type!==e.CData||null==d.value){if(a.dontPrettyTextNodes)for(u=0,c=(f=s.children).length;u<c;u++)if(((o=f[u]).type===e.Text||o.type===e.Raw||o.type===e.CData)&&null!=o.value){a.suppressPrettyCount++,g=!0;break}for(N+=">"+this.endline(s,a,i),a.state=t.InsideTag,h=0,T=(m=s.children).length;h<T;h++)o=m[h],N+=this.writeChildNode(o,a,i+1);a.state=t.CloseTag,N+=this.indent(s,a,i)+"</"+s.name+">",g&&a.suppressPrettyCount--,N+=this.endline(s,a,i),a.state=t.None}else N+=">",a.state=t.InsideTag,a.suppressPrettyCount++,g=!0,N+=this.writeChildNode(d,a,i+1),a.suppressPrettyCount--,g=!1,a.state=t.CloseTag,N+="</"+s.name+">"+this.endline(s,a,i);return this.closeNode(s,a,i),N}writeChildNode(t,s,n){switch(t.type){case e.CData:return this.cdata(t,s,n);case e.Comment:return this.comment(t,s,n);case e.Element:return this.element(t,s,n);case e.Raw:return this.raw(t,s,n);case e.Text:return this.text(t,s,n);case e.ProcessingInstruction:return this.processingInstruction(t,s,n);case e.Dummy:return"";case e.Declaration:return this.declaration(t,s,n);case e.DocType:return this.docType(t,s,n);case e.AttributeDeclaration:return this.dtdAttList(t,s,n);case e.ElementDeclaration:return this.dtdElement(t,s,n);case e.EntityDeclaration:return this.dtdEntity(t,s,n);case e.NotationDeclaration:return this.dtdNotation(t,s,n);default:throw new Error("Unknown XML node type: "+t.constructor.name)}}processingInstruction(e,s,n){var a;return this.openNode(e,s,n),s.state=t.OpenTag,a=this.indent(e,s,n)+"<?",s.state=t.InsideTag,a+=e.target,e.value&&(a+=" "+e.value),s.state=t.CloseTag,a+=s.spaceBeforeSlash+"?>",a+=this.endline(e,s,n),s.state=t.None,this.closeNode(e,s,n),a}raw(e,s,n){var a;return this.openNode(e,s,n),s.state=t.OpenTag,a=this.indent(e,s,n),s.state=t.InsideTag,a+=e.value,s.state=t.CloseTag,a+=this.endline(e,s,n),s.state=t.None,this.closeNode(e,s,n),a}text(e,s,n){var a;return this.openNode(e,s,n),s.state=t.OpenTag,a=this.indent(e,s,n),s.state=t.InsideTag,a+=e.value,s.state=t.CloseTag,a+=this.endline(e,s,n),s.state=t.None,this.closeNode(e,s,n),a}dtdAttList(e,s,n){var a;return this.openNode(e,s,n),s.state=t.OpenTag,a=this.indent(e,s,n)+"<!ATTLIST",s.state=t.InsideTag,a+=" "+e.elementName+" "+e.attributeName+" "+e.attributeType,"#DEFAULT"!==e.defaultValueType&&(a+=" "+e.defaultValueType),e.defaultValue&&(a+=' "'+e.defaultValue+'"'),s.state=t.CloseTag,a+=s.spaceBeforeSlash+">"+this.endline(e,s,n),s.state=t.None,this.closeNode(e,s,n),a}dtdElement(e,s,n){var a;return this.openNode(e,s,n),s.state=t.OpenTag,a=this.indent(e,s,n)+"<!ELEMENT",s.state=t.InsideTag,a+=" "+e.name+" "+e.value,s.state=t.CloseTag,a+=s.spaceBeforeSlash+">"+this.endline(e,s,n),s.state=t.None,this.closeNode(e,s,n),a}dtdEntity(e,s,n){var a;return this.openNode(e,s,n),s.state=t.OpenTag,a=this.indent(e,s,n)+"<!ENTITY",s.state=t.InsideTag,e.pe&&(a+=" %"),a+=" "+e.name,e.value?a+=' "'+e.value+'"':(e.pubID&&e.sysID?a+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.sysID&&(a+=' SYSTEM "'+e.sysID+'"'),e.nData&&(a+=" NDATA "+e.nData)),s.state=t.CloseTag,a+=s.spaceBeforeSlash+">"+this.endline(e,s,n),s.state=t.None,this.closeNode(e,s,n),a}dtdNotation(e,s,n){var a;return this.openNode(e,s,n),s.state=t.OpenTag,a=this.indent(e,s,n)+"<!NOTATION",s.state=t.InsideTag,a+=" "+e.name,e.pubID&&e.sysID?a+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.pubID?a+=' PUBLIC "'+e.pubID+'"':e.sysID&&(a+=' SYSTEM "'+e.sysID+'"'),s.state=t.CloseTag,a+=s.spaceBeforeSlash+">"+this.endline(e,s,n),s.state=t.None,this.closeNode(e,s,n),a}openNode(e,t,s){}closeNode(e,t,s){}openAttribute(e,t,s){}closeAttribute(e,t,s){}}}).call(this);