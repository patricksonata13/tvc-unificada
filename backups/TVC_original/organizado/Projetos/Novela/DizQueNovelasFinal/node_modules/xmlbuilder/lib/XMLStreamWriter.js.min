(function(){var t,e,s,r={}.hasOwnProperty;t=require("./NodeType"),s=require("./XMLWriterBase"),e=require("./WriterState"),module.exports=class extends s{constructor(t,e){super(e),this.stream=t}endline(t,s,r){return t.isLastRootNode&&s.state===e.CloseTag?"":super.endline(t,s,r)}document(t,e){var s,r,i,n,a,h,l,d,o;for(r=i=0,a=(l=t.children).length;i<a;r=++i)(s=l[r]).isLastRootNode=r===t.children.length-1;for(e=this.filterOptions(e),o=[],n=0,h=(d=t.children).length;n<h;n++)s=d[n],o.push(this.writeChildNode(s,e,0));return o}cdata(t,e,s){return this.stream.write(super.cdata(t,e,s))}comment(t,e,s){return this.stream.write(super.comment(t,e,s))}declaration(t,e,s){return this.stream.write(super.declaration(t,e,s))}docType(t,s,r){var i,n,a,h;if(r||(r=0),this.openNode(t,s,r),s.state=e.OpenTag,this.stream.write(this.indent(t,s,r)),this.stream.write("<!DOCTYPE "+t.root().name),t.pubID&&t.sysID?this.stream.write(' PUBLIC "'+t.pubID+'" "'+t.sysID+'"'):t.sysID&&this.stream.write(' SYSTEM "'+t.sysID+'"'),t.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(t,s,r)),s.state=e.InsideTag,n=0,a=(h=t.children).length;n<a;n++)i=h[n],this.writeChildNode(i,s,r+1);s.state=e.CloseTag,this.stream.write("]")}return s.state=e.CloseTag,this.stream.write(s.spaceBeforeSlash+">"),this.stream.write(this.endline(t,s,r)),s.state=e.None,this.closeNode(t,s,r)}element(s,i,n){var a,h,l,d,o,u,m,p,w,c,g,y,T,C;if(n||(n=0),this.openNode(s,i,n),i.state=e.OpenTag,w=this.indent(s,i,n)+"<"+s.name,i.pretty&&i.width>0)for(p in u=w.length,g=s.attribs)r.call(g,p)&&(a=g[p],u+(c=this.attribute(a,i,n)).length>i.width?(C=this.indent(s,i,n+1)+c,w+=this.endline(s,i,n)+C,u=C.length):(w+=C=" "+c,u+=C.length));else for(p in y=s.attribs)r.call(y,p)&&(a=y[p],w+=this.attribute(a,i,n));if(this.stream.write(w),d=0===(l=s.children.length)?null:s.children[0],0===l||s.children.every(function(e){return(e.type===t.Text||e.type===t.Raw||e.type===t.CData)&&""===e.value}))i.allowEmpty?(this.stream.write(">"),i.state=e.CloseTag,this.stream.write("</"+s.name+">")):(i.state=e.CloseTag,this.stream.write(i.spaceBeforeSlash+"/>"));else if(!i.pretty||1!==l||d.type!==t.Text&&d.type!==t.Raw&&d.type!==t.CData||null==d.value){for(this.stream.write(">"+this.endline(s,i,n)),i.state=e.InsideTag,o=0,m=(T=s.children).length;o<m;o++)h=T[o],this.writeChildNode(h,i,n+1);i.state=e.CloseTag,this.stream.write(this.indent(s,i,n)+"</"+s.name+">")}else this.stream.write(">"),i.state=e.InsideTag,i.suppressPrettyCount++,this.writeChildNode(d,i,n+1),i.suppressPrettyCount--,i.state=e.CloseTag,this.stream.write("</"+s.name+">");return this.stream.write(this.endline(s,i,n)),i.state=e.None,this.closeNode(s,i,n)}processingInstruction(t,e,s){return this.stream.write(super.processingInstruction(t,e,s))}raw(t,e,s){return this.stream.write(super.raw(t,e,s))}text(t,e,s){return this.stream.write(super.text(t,e,s))}dtdAttList(t,e,s){return this.stream.write(super.dtdAttList(t,e,s))}dtdElement(t,e,s){return this.stream.write(super.dtdElement(t,e,s))}dtdEntity(t,e,s){return this.stream.write(super.dtdEntity(t,e,s))}dtdNotation(t,e,s){return this.stream.write(super.dtdNotation(t,e,s))}}}).call(this);