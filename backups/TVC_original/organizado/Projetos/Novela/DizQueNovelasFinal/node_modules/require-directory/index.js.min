"use strict";var fs=require("fs"),join=require("path").join,resolve=require("path").resolve,dirname=require("path").dirname,defaultOptions={extensions:["js","json","coffee"],recurse:!0,rename:function(e){return e},visit:function(e){return e}};function checkFileInclusion(e,n,i){return new RegExp("\\.("+i.extensions.join("|")+")$","i").test(n)&&!(i.include&&i.include instanceof RegExp&&!i.include.test(e))&&!(i.include&&"function"==typeof i.include&&!i.include(e,n))&&!(i.exclude&&i.exclude instanceof RegExp&&i.exclude.test(e))&&!(i.exclude&&"function"==typeof i.exclude&&i.exclude(e,n))}function requireDirectory(e,n,i){var r={};for(var t in n&&!i&&"string"!=typeof n&&(i=n,n=null),i=i||{},defaultOptions)void 0===i[t]&&(i[t]=defaultOptions[t]);return n=n?resolve(dirname(e.filename),n):dirname(e.filename),fs.readdirSync(n).forEach(function(t){var u,o,s,c=join(n,t);fs.statSync(c).isDirectory()&&i.recurse?(u=requireDirectory(e,c,i),Object.keys(u).length&&(r[i.rename(t,c,t)]=u)):c!==e.filename&&checkFileInclusion(c,t,i)&&(o=t.substring(0,t.lastIndexOf(".")),s=e.require(c),r[i.rename(o,c,t)]=i.visit(s,c,t)||s)}),r}module.exports=requireDirectory,module.exports.defaults=defaultOptions;